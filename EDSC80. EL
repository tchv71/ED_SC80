	MACRO-80 3.44	09-Dec-81	PAGE	1


                         C       
                         C      ;$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$ 
                         C       
                                 	.PHASE 0 
  0000                          	CSEG 
  0001                          noend	equ	1 
                         C      include RkConfig.mac 
                         C      ; Platform selection 
  0001                   C      RK60k	EQU	1 
                         C      ;PALMIRA EQU	1 
                         C      ;RK32k	EQU	1 
                         C      include	RK86.MAC 
                         C      IFNDEF	?Ctrl 
                         C      ;** RK86.MAC - Radio-86 computer specific constants & macro *** 
                         C      ; 
                         C      ;	09-Oct-1992  - first version 
                         C      ;	15-Nov-1992  - Add 82XX.MAC 
                         C      ;	02-Apr-2021  - Special version for original RK 
                         C       
                         C      ?Ctrl	equ	40h 
                         C      ?Shift	equ	20h 
                         C       
                         C      ; IN and OUT MACRO comands 
                         C      @in	MACRO	addr 
                         C      	lda	addr 
                         C      	ENDM 
                         C       
                         C      @out	MACRO	addr 
                         C      	sta	addr 
                         C      	ENDM 
                         C       
                         C      GETMAXMEM	EQU 0F830h 
                         C      ENDIF 
                         C      include	E0DISP.MAC 
                         C      IFNDEF	TabStep 
                         C      ;**************************************************** 
                         C      ;    SC80 text screen editor    (C) TCHV,1989-93    * 
                         C      ;                                                   * 
                         C      ;  E0DISP.MAC - Display dependent macro definitions * 
                         C      ;                                                   * 
                         C      ;          This file is for Original 32k version    * 
                         C      ;**************************************************** 
                         C      TabStep		equ	8 
                         C      ;LimitedCharSet	equ	1 
                         C       
                         C      ScrXOffset	equ	8 
                         C      ScrYOffset	equ	3 
                         C      ScrWidth	equ	78 
                         C      ScrHeight	equ	25 
                         C       
                         C      LogicWidth	equ	64 ; 78 - 8 trailing blank symbols - 5 end blank symbols 
                         C      LogicHeight	equ	ScrHeight-2 
                         C       
                         C      ScrSize		equ	(ScrHeight+ScrYOffset+2)*ScrWidth 
                         C      ;ScrStart	equ	76D0h ; Display buffer start 
                         C       
	MACRO-80 3.44	09-Dec-81	PAGE	1-1


                         C      ; Start address of physical screen - visible characters 
                         C      ScrOffset	equ	ScrYOffset*ScrWidth+ScrXOffset 
                         C      ;VRAM		equ	ScrStart+ScrOffset 
                         C       
                         C      SetScrAddr	macro 
                         C      		endm 
                         C       
                         C      WriteNextSym	macro 
                         C      		mov	m,a 
                         C      		inx	h 
                         C      		endm 
                         C       
                         C      space		equ	20h 
                         C      IFDEF	PALMIRA 
                         C      CURSOR_BLOCK	equ	0E8h 
                         C      CURSOR_LINE	equ	0D8h 
                         C      ELSE 
                         C      CURSOR_BLOCK	equ	0EDh 
                         C      CURSOR_LINE	equ	0DDh 
                         C      ENDIF 
                         C       
                         C      ;$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$ 
                         C      ENDIF 
                         C      include	E0BREAK.MAC 
                         C       
                         C      ; 
                         C      ;	E0break.mac - time safe break check 
                         C      ; 
                         C       
                         C      ;PPI	equ	0F780h 
                         C       
                         C      ; Initialize break checking 
                         C      init_brk_check	macro 
                         C      		PUSH	H 
                         C      		;MVI	A,0FEH 
                         C      		;STA	PPI 
                         C      		LHLD	PPI_ADR 
                         C      		MVI	M,0FEH 
                         C      		POP	H 
                         C      		endm 
                         C       
                         C      ; Check for break key pressed (Z=1) 
                         C      check_break	macro 
                         C      		;LDA	PPI+1 
                         C      		PUSH	H 
                         C      		LHLD	PPI_ADR 
                         C      		INR	L 
                         C      		MOV	A,M 
                         C      		POP	H 
                         C      		ANI	40h 
                         C      		endm 
                         C      include	E0MAIN.ASM 
                         C      	;********************************************** 
                         C      ;*        TCHV text full-screen editor        * 
                         C      ;*               (c) 1989-92                  * 
                         C      ;* Text processing and general control module * 
	MACRO-80 3.44	09-Dec-81	PAGE	1-2


                         C      ;********************************************** 
                         C       
                         C      ;	 6-Dec-1991 
                         C      ;	 8-Dec-1991 -   80 - symbol mode for CP/M, 
                         C      ;		macros SetScrAddr and WriteNextSym 
                         C      ;	14-Jan-1992 -  Use some CP/M features 
                         C      ;	28-Jan-1992 -  Change command table presentation 
                         C      ;	01-Mar-1992 -  Delete some bugs 
                         C      ;	15-Mar-1992 -  Add case insensitive search 
                         C       
                         C      ;	02-Apr-2021 -  Original RK back-adaptation 
                         C      ;	25-Apr-2021 -  Controller addresses table 
                         C       
                         C       
                         C      PUBLIC	INFADR 
                         C      ;PUBLIC	INFSTR 
                         C       
                         C      .8080 
  0000                   C      	CSEG 
                         C      	;ORG 104H 
                         C       
  0030                   C      StkSize	EQU	30h 
                         C       
  2000                   C      TXTBUFF	EQU	2000H 
  1E00                   C      WRK	EQU	1E00H 
                         C       
                         C       
                         C      IFNDEF	noend 
                         C      extrn	SETCURSOR,SETSCR ; From E0DISP.ASM 
                         C      extrn	GETCHC,GETCHR	; From E0GETC.ASM 
                         C       
                         C      extrn   FNDCMD		; From E0CMDT.ASM 
                         C      ENDIF 
                         C       
  001C                   C      LineSym		equ	1ch 
  001B                   C      DelimSym	equ	1bh 
                         C       
  0750                   C      INFSTR_OFFS	EQU	ScrWidth*(ScrHeight-1) 
                         C      ;INFSTR	EQU	VRAM+INFSTR_OFFS 
  007F                   C      MAXLEN	EQU	127 
                         C       
                         C      PUBLIC	VRAM_ADR,PPI_ADR,DISP_ADR,DMA_ADR 
                         C       
  0000    C3 0015        C      	JMP	START 
                         C      ; Controller addresses table 
                         C      IFDEF	PALMIRA 
                         C      	VRAM_ADR:	DW 0B7C2h	; VRAM buffer visible start address - 0B7C2h 
                         C      	PPI_ADR:	DW 0C200h 	; VV55 keyboard Controller - 0C200h 
                         C      	PPI2_ADR:	DW 0C400h	; VV55 additional PPI  - 0C400h 
                         C      	DISP_ADR:	DW 0C000h	; VG75 Display Controller - 0C000h 
                         C      	DMA_ADR:	DW 0E000h	; VT57 DMA Controller - 0E000h 
                         C      ELSE 
                         C      IFDEF	RK60k 
  0003    E7C2           C      	VRAM_ADR:	DW 0E7C2h	; VRAM buffer visible start address - 0E7C2h 
  0005    F780           C      	PPI_ADR:	DW 0F780h 	; VV55 keyboard Controller - 0F780h 
  0007    F7A0           C      	PPI2_ADR:	DW 0F7A0h	; VV55 additional PPI  - 0F7A0h 
	MACRO-80 3.44	09-Dec-81	PAGE	1-3


  0009    F7C0           C      	DISP_ADR:	DW 0F7C0h	; VG75 Display Controller - 0F7C0h 
  000B    F7E0           C      	DMA_ADR:	DW 0F7E0h	; VT57 DMA Controller - 0F7E0h 
                         C      ELSE 
                         C      	VRAM_ADR:	DW 77C2h	; VRAM buffer visible start address - 77c2h 
                         C      	PPI_ADR:	DW 08000h 	; VV55 keyboard Controller - 8000h 
                         C      	PPI2_ADR:	DW 0A000h	; VV55 additional PPI  - 0A000h	 
                         C      	DISP_ADR:	DW 0C000h	; VG75 Display Controller - 0C000h 
                         C      	DMA_ADR:	DW 0E000h	; VT57 DMA Controller - 0E000h 
                         C      ENDIF 
                         C      ENDIF 
  000D    0000 0000      C      		DW 0,0,0,0 ; Reserved for future use 
  0011    0000 0000      C      
                         C       
  0015                   C      START:: 
  0015    CD F830        C      	CALL	GETMAXMEM;lhld	6 
  0018    F9             C      	sphl 
  0019    36 FF          C      	MVI	M,0FFH 
  001B    3E 01          C      	MVI	A,1 
  001D    32 1E2C        C      	STA	DISPOS 
  0020    32 1E3A        C      	STA	DISPS0 
  0023    21 0000        C      	LXI	H,0 
  0026    22 1E32        C      	SHLD	SCRBG0 
  0029    CD 015C        C      	CALL	INIT 
  002C    3E FF          C      	MVI	A,0FFH 
  002E    32 1E3C        C      	STA	?WIN1 
  0031    21 0101        C      	LXI	H,101H 
  0034    22 1E2A        C      	SHLD	CURX 
  0037    22 1E38        C      	SHLD	CURX0 
  003A    21 0001        C      	LXI	H,1 
  003D    22 1E0A        C       	SHLD	CURSTR 
  0040    CD 0147        C      	CALL	CLS 
  0043    CD 0F30        C      	CALL	OVRW 
  0046    21 2000        C      	LXI	H,TXTBUFF 
  0049    22 1E00        C      	SHLD	nivgr 
  004C    22 1E0C        C      	SHLD	BLBEG 
  004F    22 1E0E        C      	SHLD	BLEND 
  0052    EB             C      	XCHG 
  0053    CD 013D        C      	CALL	MAXRAM 
  0056    22 1E02        C      	SHLD	werhgr 
  0059    EB             C      	XCHG 
  005A    CD 0196        C      	CALL	CHECKMEM 
  005D    FE FF          C      	CPI	0FFH 
  005F    CA 006A        C      	JZ	M01 
  0062    2A 1E00        C      	LHLD	nivgr 
  0065    36 0D          C      	MVI	M,0DH 
  0067    23             C      	INX	H 
  0068    36 FF          C      	MVI	M,0FFH 
  006A    22 1E02        C      M01:	SHLD	werhgr 
  006D    2A 1E00        C      M00:	LHLD	nivgr 
  0070    22 1E20        C      	SHLD	SCRADR 
  0073    22 1E22        C      	SHLD	STRADR 
  0076    22 1E3D        C      	SHLD	TABSRH 
  0079    CD 01DF        C      	CALL	COMPST 
  007C    2A 1E20        C      	LHLD	SCRADR 
  007F    22 1E2E        C      	SHLD	SCRAD0 
  0082    2A 1E22        C      	LHLD	STRADR 
	MACRO-80 3.44	09-Dec-81	PAGE	1-4


  0085    22 1E30        C      	SHLD	STRAD0 
  0088    CD 0364        C      	CALL	CURSM 
  008B    AF             C      	xra	a 
  008C    32 1E3B        C      	sta	?StringBufActive 
  008F    CD 0221        C      	CALL	DISPLY 
  0092    C3 0712        C      	JMP	M03 
                         C       
  0095    CD 0176        C      SETINF:	CALL	DRLIN 
  0098    2A 1E22        C      	LHLD	STRADR 
  009B    22 1E3D        C      	SHLD	TABSRH 
  009E    CD 0364        C      	CALL	CURSM 
  00A1    CD 0B92        C      	CALL	LINE 
                         C       
  00A4    CD 122B        C      	CALL	GETINFADR 
                         C      	SetScrAddr 
  00A7    0E 08          C      	mvi	c,8 
  00A9    3E 20          C      @@000:	mvi	a,space 
                         C      	WriteNextSym 
  00AB    77             C+     		mov	m,a 
  00AC    23             C+     		inx	h 
  00AD    0D             C      	dcr	c 
  00AE    C2 00A9        C      	JNZ	@@000 
                         C       
  00B1    CD 1235        C      	CALL	INFPR 
  00B4    0008           C      	DW	8 
  00B6    4C 49 4E 45    C      	DC	'LINE: ' 
  00BA    3A A0          C      
                         C       
  00BC    2A 1E08        C      	LHLD	NUMSTR 
  00BF    CD 131C        C      	CALL	?FBBCD 
  00C2    EB             C      	XCHG 
  00C3    CD 122B        C      	CALL	GETINFADR 
  00C6    D5             C      	PUSH	D 
  00C7    11 0016        C      	LXI	D,22 
  00CA    19             C      	DAD	D 
  00CB    D1             C      	POP	D 
  00CC    CD 120A        C      	CALL	BPR 
  00CF    3E 2F          C      	mvi	a,'/' 
                         C      	SetScrAddr 
                         C      	WriteNextSym 
  00D1    77             C+     		mov	m,a 
  00D2    23             C+     		inx	h 
  00D3    2B             C      	DCX	H 
  00D4    2B             C      	DCX	H 
  00D5    E5             C      	PUSH	H 
  00D6    2A 1E0A        C      	LHLD	CURSTR 
  00D9    CD 131C        C      	CALL	?FBBCD 
  00DC    EB             C      	XCHG 
  00DD    E1             C      	POP	H 
  00DE    CD 120A        C      	CALL	BPR 
  00E1    CD 1235        C      	CALL	INFPR 
  00E4    0024           C      	DW	36 
  00E6    20 20 20 20    C      	DC	'     TEXT:' 
  00EA    20 54 45 58    C      
  00EE    54 BA          C      
  00F0    2A 1E02        C      	LHLD	werhgr 
	MACRO-80 3.44	09-Dec-81	PAGE	1-5


  00F3    EB             C      	XCHG 
  00F4    CD 122B        C      	CALL	GETINFADR 
  00F7    D5             C      	PUSH	D 
  00F8    11 0039        C      	LXI	D,57 
  00FB    19             C      	DAD	D 
  00FC    D1             C      	POP	D 
                         C      	SetScrAddr 
  00FD    3E 48          C      	mvi	a,'H' 
                         C      	WriteNextSym 
  00FF    77             C+     		mov	m,a 
  0100    23             C+     		inx	h 
  0101    2B             C      	dcx	h 
  0102    2B             C      	DCX	H 
  0103    CD 120A        C      	CALL	BPR 
  0106    CD 1235        C      	call	INFPR 
  0109    0033           C      	dw	51 
  010B    48 AD          C      	dc	'H-' 
  010D    CD 122B        C      	CALL	GETINFADR 
  0110    D5             C      	PUSH	D 
  0111    11 0032        C      	LXI	D,50 
  0114    19             C      	DAD	D 
  0115    D1             C      	POP	D 
  0116    EB             C      	XCHG 
  0117    2A 1E00        C      	LHLD	nivgr 
  011A    EB             C      	XCHG 
  011B    CD 120A        C      	CALL	BPR 
  011E    CD 1235        C      	CALL	INFPR 
  0121    0017           C      	DW	23 
  0123    20 20 20 20    C      	DC	'      COL:' 
  0127    20 20 43 4F    C      
  012B    4C BA          C      
  012D    C3 01B4        C      	JMP	DISCUR 
                         C       
  0130    CD 0F3D        C      WRMSRT:	CALL	SAVMOD 
  0133    CD 0221        C      OUT1:	CALL	DISPLY 
  0136    CD F830        C      OUT3:	CALL	GETMAXMEM;lhld	6 
  0139    F9             C      	sphl 
  013A    C3 0712        C      	JMP	M03 
                         C       
  013D    CD F830        C      MAXRAM:	CALL	GETMAXMEM;LHLD	6 
  0140    C5             C      	push	b 
  0141    01 FFD0        C      	lxi	b,-StkSize 
  0144    09             C      	dad	b 
  0145    C1             C      	pop	b 
  0146    C9             C      	RET 
                         C       
  0147                   C      CLS:	;lxi	h,ScrStart 
  0147    2A 0003        C      	lhld	VRAM_ADR 
  014A    01 0923        C      	lxi	b,ScrSize-1 
                         C       
                         C      	SetScrAddr 
  014D    3E 20          C      	mvi	a,20h ; 84H 
                         C      	WriteNextSym 
  014F    77             C+     		mov	m,a 
  0150    23             C+     		inx	h 
  0151                   C      ClsLoop: 
	MACRO-80 3.44	09-Dec-81	PAGE	1-6


  0151    3E 20          C      	mvi	a,space 
                         C      	WriteNextSym 
  0153    77             C+     		mov	m,a 
  0154    23             C+     		inx	h 
  0155    0B             C      	DCX	B 
  0156    78             C      	MOV	A,B 
  0157    B1             C      	ORA	C 
  0158    C2 0151        C      	jnz	ClsLoop 
  015B    C9             C      	RET 
                         C       
  015C                   C      INIT: 
  015C    2A 0003        C      	LHLD	VRAM_ADR 
  015F    22 1E24        C      	SHLD	SCRBEG 
  0162    3E 17          C      	MVI	A,LogicHeight 
  0164    32 1E28        C      	STA	YSIZE 
  0167    AF             C      	XRA	A 
  0168    32 1E29        C      	STA	YBEG 
  016B    2A 0003        C      	LHLD	VRAM_ADR 
  016E    11 0750        C      	LXI	D,INFSTR_OFFS 
  0171    19             C      	DAD	D 
  0172    22 1E26        C      	SHLD	INFADR 
  0175    C9             C      	RET 
                         C       
  0176    3A 1E33        C      DRLIN:	LDA	SCRBG0+1 
  0179    B7             C      	ORA	A 
  017A    C8             C      	RZ 
  017B    2A 1E26        C      	LHLD	INFADR 
  017E    3A 1E3C        C      	LDA	?WIN1 
  0181    B7             C      	ORA	A 
  0182    C2 0188        C      	JNZ	$+6 
  0185    2A 1E34        C      	LHLD	INFAD0 
  0188    01 FFB2        C      	LXI	B,-ScrWidth 
  018B    09             C      	DAD	B 
  018C    3E 3F          C      	MVI	A,LogicWidth-1 
  018E    36 5E          C      	MVI	M,'^' 
  0190    23             C      	INX	H 
  0191    3D             C      	DCR	A 
  0192    C2 018E        C      	JNZ	$-4 
  0195    C9             C      	RET 
                         C       
  0196    7E             C      CHECKMEM:	MOV	A,M 
  0197    FE FF          C      	CPI	0FFH 
  0199    C2 01A4        C      	JNZ	CHKM0 
  019C    2B             C      	DCX	H 
  019D    7E             C      	MOV	A,M 
  019E    23             C      	INX	H 
  019F    FE 0D          C      	CPI	0DH 
  01A1    3E FF          C      	MVI	A,0FFH 
  01A3    C8             C      	RZ 
  01A4    23             C      CHKM0:	INX	H 
  01A5    7C             C      	MOV	A,H 
  01A6    3C             C      	INR	A 
  01A7    BA             C      	CMP	D 
  01A8    DA 0196        C      	JC	CHECKMEM 
  01AB    7D             C      	MOV	A,L 
  01AC    3C             C      	INR	A 
	MACRO-80 3.44	09-Dec-81	PAGE	1-7


  01AD    BB             C      	CMP	E 
  01AE    DA 0196        C      	JC	CHECKMEM 
  01B1    3E 00          C      	MVI	A,0 
  01B3    C9             C      	RET 
                         C       
  01B4    3A 1E2A        C      DISCUR:	LDA	CURX 
  01B7    6F             C      	MOV	L,A 
  01B8    26 00          C      	MVI	H,0 
  01BA    CD 131C        C      	CALL	?FBBCD 
  01BD    EB             C      	XCHG 
  01BE    CD 122B        C      	CALL	GETINFADR 
  01C1    D5             C      	PUSH	D 
  01C2    11 0023        C      	LXI	D,35 
  01C5    19             C      	DAD	D 
  01C6    D1             C      	POP	D 
  01C7    7B             C      	MOV	A,E 
  01C8    CD 1212        C      	CALL	BPR1 
  01CB    7A             C      	MOV	A,D 
  01CC    C3 121B        C      	JMP	BPR01 
                         C       
  01CF    2A 1E0A        C      INRCUR:	LHLD	CURSTR 
  01D2    23             C      	INX	H 
  01D3    22 1E0A        C      	SHLD	CURSTR 
  01D6    C9             C      	RET 
                         C       
  01D7    2A 1E0A        C      DCRCUR:	LHLD	CURSTR 
  01DA    2B             C      	DCX	H 
  01DB    22 1E0A        C      	SHLD	CURSTR 
  01DE    C9             C      	RET 
                         C       
  01DF    11 0000        C      COMPST:	LXI	D,0 
  01E2    2A 1E00        C      	LHLD	nivgr 
  01E5    7E             C      COMP1:	MOV	A,M 
  01E6    23             C      	INX	H 
  01E7    FE FF          C      	CPI	0FFH 
  01E9    CA 01F5        C      	JZ	COMP0 
  01EC    FE 0D          C      	CPI	0DH 
  01EE    C2 01E5        C      	JNZ	COMP1 
  01F1    13             C      	INX	D 
  01F2    C3 01E5        C      	JMP	COMP1 
  01F5    EB             C      COMP0:	XCHG 
  01F6    22 1E08        C      	SHLD	NUMSTR 
  01F9    C9             C      	RET 
                         C       
  01FA    2A 1E00        C      COMCUR:	LHLD	nivgr 
  01FD    EB             C      	XCHG 
  01FE    2A 1E22        C      	LHLD	STRADR 
  0201    7D             C      	MOV	A,L 
  0202    93             C      	SUB	E 
  0203    4F             C      	MOV	C,A 
  0204    7C             C      	MOV	A,H 
  0205    9A             C      	SBB	D 
  0206    47             C      	MOV	B,A 
  0207    03             C      	INX	B 
  0208    11 0001        C      	LXI	D,1 
  020B    0B             C      COMP2:	DCX	B 
	MACRO-80 3.44	09-Dec-81	PAGE	1-8


  020C    78             C      	MOV	A,B 
  020D    B1             C      	ORA	C 
  020E    CA 021C        C      	JZ	COMP3 
  0211    7E             C      	MOV	A,M 
  0212    2B             C      	DCX	H 
  0213    FE 0D          C      	CPI	0DH 
  0215    C2 0219        C      	JNZ	$+4 
  0218    13             C      	INX	D 
  0219    C3 020B        C      	JMP	COMP2 
  021C    EB             C      COMP3:	XCHG 
  021D    22 1E0A        C      	SHLD	CURSTR 
  0220    C9             C      	RET 
                         C       
  0221    E5             C      DISPLY:	PUSH	H 
  0222    C5             C      	PUSH	B 
  0223    F5             C      	PUSH	PSW 
  0224    D5             C      	PUSH	D 
  0225    CD 094C        C      	CALL	SWPWN 
  0228    CA 0231        C      	JZ	DSPL0 
  022B    CD 0239        C      	CALL	DSPL1 
  022E    CD 094C        C      	CALL	SWPWN 
  0231    CD 0239        C      DSPL0:	CALL	DSPL1 
  0234    D1             C      	POP	D 
  0235    F1             C      	POP	PSW 
  0236    C1             C      	POP	B 
  0237    E1             C      	POP	H 
  0238    C9             C      	RET 
                         C       
  0239    2A 1E20        C      DSPL1:	LHLD	SCRADR 
  023C    EB             C      	XCHG 
  023D    2A 1E24        C      	LHLD	SCRBEG 
  0240    3A 1E28        C      	LDA	YSIZE 
  0243    47             C      	MOV	B,A 
  0244    CD 024B        C      	CALL	D01 
  0247    22 1E06        C      	SHLD	SCREND 
  024A    C9             C      	RET 
                         C       
                         C       
  024B                   C      D01: 
  024B    AF             C      	XRA	A 
  024C    32 1E2D        C      	STA	?END 
  024F    C5             C      	PUSH	B 
                         C       
  0250    E5             C      	push	h 
  0251    D5             C      	push	d 
  0252    3A 1E3B        C      	lda	?StringBufActive 
  0255    B7             C      	ora	a 
  0256    CA 0279        C      	jz	@220 
  0259    2A 1E22        C      	lhld	STRADR 
  025C    EB             C      	xchg 
  025D    7C             C      	mov	a,h 
  025E    BA             C      	cmp	d 
  025F    C2 0279        C      	jnz	@220 
  0262    7D             C      	mov	a,l 
  0263    BB             C      	cmp	e 
  0264    C2 0279        C      	jnz	@220 
	MACRO-80 3.44	09-Dec-81	PAGE	1-9


  0267    D1             C      	pop	d 
  0268    E1             C      	pop	h 
  0269    D5             C      	push	d 
  026A    11 1E7D        C      	lxi	d,STRRED 
  026D    CD 13B1        C      	call	DISSTR 
  0270    D1             C      	pop	d 
  0271    EB             C      	xchg 
  0272    CD 0489        C      	CALL	NEXTST 
  0275    EB             C      	xchg 
  0276    C3 027E        C      	jmp	@221 
  0279                   C      @220: 
  0279    D1             C      	pop	d 
  027A    E1             C      	pop	h 
                         C      	;lda	DISPOS 
  027B    CD 13B1        C      	CALL	DISSTR 
  027E                   C      @221: 
  027E    C1             C      	POP	B 
  027F    FE FF          C      	CPI	0FFH 
  0281    CA 028C        C      	JZ	@11 
  0284    13             C      	INX	D 
  0285    05             C      	DCR	B 
  0286    C2 024B        C      	JNZ	D01 
  0289    C3 02A9        C      	JMP	@12 
  028C    3A 1E2D        C      @11:	LDA	?END 
  028F    B7             C      	ORA	A 
  0290    C2 0297        C      	JNZ	@110 
  0293    78             C      	MOV	A,B 
  0294    32 1E2D        C      	STA	?END 
  0297    05             C      @110:	DCR	B 
  0298    CA 02A9        C      	JZ	@12 
  029B    0E 4E          C      @9:	MVI	C,ScrWidth 
                         C       
  029D                   C      @10: 
                         C      	SetScrAddr 
                         C       
  029D    3E 20          C      @101:	mvi	a,space 
                         C      	WriteNextSym 
  029F    77             C+     		mov	m,a 
  02A0    23             C+     		inx	h 
  02A1    0D             C      	DCR	C 
  02A2    C2 029D        C      	JNZ	@10 
  02A5    05             C      	DCR	B 
  02A6    C2 029B        C      	JNZ	@9 
  02A9    EB             C      @12:	XCHG 
  02AA    C9             C      	RET 
                         C       
                         C      ;@ 
                         C       
  02AB    0B             C      DELAY0:	DCX	B 
  02AC    78             C      	MOV	A,B 
  02AD    B1             C      	ORA	C 
  02AE    C2 02AB        C      	JNZ	DELAY0 
  02B1    C9             C      	RET 
                         C       
                         C       
  02B2    3A 1E2A        C      wlewo:	LDA	CURX 
	MACRO-80 3.44	09-Dec-81	PAGE	1-10


  02B5    3D             C      	DCR	A 
  02B6    C8             C      	RZ 
  02B7    32 1E2A        C      	STA	CURX 
  02BA    C3 0364        C      	JMP	CURSM 
                         C       
  02BD    3A 1E2A        C      wprawo:	LDA	CURX 
  02C0    FE 7F          C      	CPI	MAXLEN 
  02C2    D0             C      	RNC 
  02C3    3C             C      	INR	A 
  02C4    32 1E2A        C      	STA	CURX 
  02C7    C3 0364        C      	JMP	CURSM 
                         C       
  02CA    3A 1E2C        C      wp1:	LDA	DISPOS 
  02CD    C6 08          C      	ADI	8 
  02CF    32 1E2C        C      	STA	DISPOS 
  02D2    CD 0221        C      	CALL	DISPLY 
  02D5    C3 0364        C      	JMP	CURSM 
                         C       
  02D8    E5             C      GETC:	PUSH	H 
  02D9    D5             C      	PUSH	D 
  02DA    C5             C      	PUSH	B 
  02DB    2A 1E3D        C      	LHLD	TABSRH 
  02DE    3A 1E2A        C      	LDA	CURX 
  02E1    4F             C      	MOV	C,A 
  02E2    06 01          C      	MVI	B,1 
  02E4    58             C      	MOV	E,B 
  02E5    78             C      GTC0:	MOV	A,B 
  02E6    B9             C      	CMP	C 
  02E7    D2 030D        C      	JNC	GTC3 
  02EA    7E             C      	MOV	A,M 
  02EB    23             C      	INX	H 
  02EC    FE 09          C      	CPI	9 
  02EE    CA 02FB        C      	JZ	GTC1 
  02F1    FE 0D          C      	CPI	0DH 
  02F3    CA 0309        C      	JZ	GTC2 
  02F6    04             C      	INR	B 
  02F7    1C             C      	INR	E 
  02F8    C3 02E5        C      	JMP	GTC0 
  02FB    78             C      GTC1:	MOV	A,B 
  02FC    CD 034D        C      	call	CalcNextTabPos 
  02FF    47             C      	MOV	B,A 
  0300    79             C      	MOV	A,C 
  0301    B8             C      	CMP	B 
  0302    DA 030D        C      	JC	GTC3 
  0305    1C             C      	INR	E 
  0306    C3 02E5        C      	JMP	GTC0 
  0309    79             C      GTC2:	MOV	A,C 
  030A    90             C      	SUB	B 
  030B    83             C      	ADD	E 
  030C    5F             C      	MOV	E,A 
  030D    7B             C      GTC3:	MOV	A,E 
  030E    C1             C      	POP	B 
  030F    D1             C      	POP	D 
  0310    E1             C      	POP	H 
  0311    C9             C      	RET 
                         C       
	MACRO-80 3.44	09-Dec-81	PAGE	1-11


  0312    E5             C      CURCM:	PUSH	H 
  0313    C5             C      	PUSH	B 
  0314    2A 1E3D        C      	LHLD	TABSRH 
  0317    3A 1E2A        C      	LDA	CURX 
  031A    4F             C      	MOV	C,A 
  031B    06 01          C      	MVI	B,1 
  031D    0D             C      CC0:	DCR	C 
  031E    CA 0343        C      	JZ	CC2 
  0321    7E             C      	MOV	A,M 
  0322    23             C      	INX	H 
  0323    FE 09          C      	CPI	9 
  0325    CA 0336        C      	JZ	CC1 
  0328    FE 0D          C      	CPI	0DH 
  032A    CA 033E        C      	JZ	CC3 
  032D    FE FF          C      	CPI	0FFH 
  032F    CA 033E        C      	JZ	CC3 
  0332    04             C      	INR	B 
  0333    C3 031D        C      	JMP	CC0 
  0336    78             C      CC1:	MOV	A,B 
  0337    CD 034D        C      	call	CalcNextTabPos 
  033A    47             C      	MOV	B,A 
  033B    C3 031D        C      	JMP	CC0 
  033E    04             C      CC3:	INR	B 
  033F    0D             C      	DCR	C 
  0340    C2 033E        C      	JNZ	CC3 
  0343    78             C      CC2:	MOV	A,B 
  0344    32 1E2A        C      	STA	CURX 
  0347    CD 0364        C      	CALL	CURSM 
  034A    C1             C      	POP	B 
  034B    E1             C      	POP	H 
  034C    C9             C      	RET 
                         C       
  034D                   C      CalcNextTabPos: 
  034D    3D             C      	DCR	A 
  034E    F6 07          C      	ORI	TabStep-1 
  0350    C6 02          C      	ADI	2 
  0352    C9             C      	ret 
                         C       
  0353    3A 1E28        C      INFCRM:	LDA	YSIZE 
  0356    C6 02          C      	ADI	2 
  0358    32 1E2B        C      	STA	CURY 
  035B    E5             C      CURM:	push	h 
  035C    2A 1E2A        C      	lhld	CURX 
  035F    CD 1470        C      	call	SetCursor 
  0362    E1             C      	pop	h 
  0363    C9             C      	ret 
                         C       
  0364    3A 1E2C        C      CURSM::	LDA	DISPOS 
  0367    C5             C      	PUSH	B 
  0368    47             C      	MOV	B,A 
  0369    3A 1E2A        C      	LDA	CURX 
  036C    90             C      	SUB	B 
  036D    C1             C      	POP	B 
  036E    DA 0386        C      	JC	LEFT 
  0371    FE 40          C      	CPI	LogicWidth 
  0373    D2 0391        C      	JNC	RIGHT 
	MACRO-80 3.44	09-Dec-81	PAGE	1-12


  0376    3C             C      MovCur:	INR	A 
  0377    6F             C      	mov	l,a 
  0378    3A 1E2B        C      	lda	CURY 
  037B    67             C      	MOV	h,A 
  037C    3A 1E29        C      	LDA	YBEG 
  037F    84             C      	add	h 
  0380    67             C      	mov	h,a 
  0381    CD 1470        C      	call	SetCursor 
  0384    B7             C      	ora	a 
  0385    C9             C      	ret 
                         C       
                         C       
  0386    3A 1E2C        C      LEFT:	LDA	DISPOS 
  0389    D6 08          C      	SUI	8 
  038B    32 1E2C        C      	STA	DISPOS 
  038E    C3 0399        C      	JMP	CURM1 
                         C       
  0391    3A 1E2C        C      RIGHT:	LDA	DISPOS 
  0394    C6 08          C      	ADI	8 
  0396    32 1E2C        C      	STA	DISPOS 
  0399    3A 1E2C        C      CURM1:	LDA	DISPOS 
  039C    C5             C      	PUSH	B 
  039D    47             C      	MOV	B,A 
  039E    3A 1E2A        C      	LDA	CURX 
  03A1    90             C      	SUB	B 
  03A2    C1             C      	POP	B 
  03A3    DA 0386        C      	JC	LEFT 
  03A6    FE 40          C      	CPI	LogicWidth 
  03A8    D2 0391        C      	JNC	RIGHT 
  03AB    CD 0221        C      	CALL	DISPLY 
  03AE    C3 0376        C      	jmp	MovCur 
                         C       
                         C      ;--------------------------------------------- 
                         C       
  03B1    D5             C      wniz:	PUSH	D 
  03B2    2A 1E22        C      	LHLD	STRADR 
  03B5    CD 0489        C      	CALL	NEXTST 
  03B8    D1             C      	POP	D 
  03B9    C8             C      	RZ 
  03BA    22 1E22        C      	SHLD	STRADR 
  03BD    CD 01CF        C      	CALL	INRCUR 
  03C0    3A 1E28        C      	LDA	YSIZE 
  03C3    3D             C      	DCR	A 
  03C4    47             C      	MOV	B,A 
  03C5    3A 1E2B        C      	LDA	CURY 
  03C8    B8             C      	CMP	B 
  03C9    D2 03E0        C      	JNC	ROLLUP 
  03CC    3C             C      	INR	A 
  03CD    32 1E2B        C      	STA	CURY 
  03D0    C3 0364        C      	JMP	CURSM 
                         C       
  03D3    2A 1E22        C      RLUP:	LHLD	STRADR 
  03D6    CD 0489        C      	CALL	NEXTST 
  03D9    C8             C      	RZ 
  03DA    22 1E22        C      	SHLD	STRADR 
  03DD    CD 01CF        C      	CALL	INRCUR 
	MACRO-80 3.44	09-Dec-81	PAGE	1-13


  03E0    2A 1E20        C      ROLLUP:	LHLD	SCRADR 
  03E3    CD 0489        C      	CALL	NEXTST 
  03E6    22 1E20        C      	SHLD	SCRADR 
  03E9    C8             C      	RZ 
  03EA    CD 044C        C      	CALL	SCRUP 
  03ED    2A 1E06        C      	LHLD	SCREND 
  03F0    EB             C      	XCHG 
  03F1    01 FF64        C      	LXI	B,-2*ScrWidth 
  03F4    2A 1E26        C      	LHLD	INFADR 
  03F7    09             C      	DAD	B 
  03F8    3A 1E2C        C      	lda	DISPOS 
  03FB    CD 13B1        C      	CALL	DISSTR 
  03FE    FE FF          C      	CPI	0FFH 
  0400    CA 0409        C      	JZ	wn20 
                         C       
                         C       
  0403    13             C      	INX	D 
  0404    EB             C      	XCHG 
  0405    22 1E06        C      	SHLD	SCREND 
  0408    C9             C      	RET 
  0409    21 1E2D        C      wn20:	LXI	H,?END 
  040C    34             C      	INR	M 
  040D    C9             C      	RET 
                         C       
  040E    21 0000        C      SCRDN:	LXI	H,0 
  0411    39             C      	DAD	SP 
  0412    22 1430        C      	SHLD	PRSP 
  0415    31 FFF2        C      	LXI	SP,LogicWidth-ScrWidth 
  0418    2A 1E26        C      	LHLD	INFADR 
  041B    11 FF55        C      	LXI	D,LogicWidth-3*ScrWidth-1 
  041E    19             C      	DAD	D 
  041F    EB             C      	XCHG 
  0420    21 004E        C      	LXI	H,ScrWidth 
  0423    19             C      	DAD	D 
  0424    3A 1E28        C      	LDA	YSIZE 
  0427    3D             C      	DCR	A 
  0428    47             C      	MOV	B,A 
  0429    0E 10          C      SCD1:	MVI	C,LogicWidth/4 
  042B    1A             C      SCD0:	LDAX	D 
  042C    77             C      	MOV	M,A 
  042D    2B             C      	DCX	H 
  042E    1B             C      	DCX	D 
  042F    1A             C      	LDAX	D 
  0430    77             C      	MOV	M,A 
  0431    2B             C      	DCX	H 
  0432    1B             C      	DCX	D 
  0433    1A             C      	LDAX	D 
  0434    77             C      	MOV	M,A 
  0435    2B             C      	DCX	H 
  0436    1B             C      	DCX	D 
  0437    1A             C      	LDAX	D 
  0438    77             C      	MOV	M,A 
  0439    2B             C      	DCX	H 
  043A    1B             C      	DCX	D 
  043B    0D             C      	DCR	C 
  043C    C2 042B        C      	JNZ	SCD0 
	MACRO-80 3.44	09-Dec-81	PAGE	1-14


  043F    39             C      	DAD	SP 
  0440    EB             C      	XCHG 
  0441    39             C      	DAD	SP 
  0442    EB             C      	XCHG 
  0443    05             C      	DCR	B 
  0444    C2 0429        C      	JNZ	SCD1 
  0447    2A 1430        C      	LHLD	PRSP 
  044A    F9             C      	SPHL 
  044B    C9             C      	RET 
                         C       
  044C    21 0000        C      SCRUP:	LXI	H,0 
  044F    39             C      	DAD	SP 
  0450    22 1430        C      	SHLD	PRSP 
  0453    31 000E        C      	LXI	SP,ScrWidth-LogicWidth 
  0456    11 004E        C      	LXI	D,ScrWidth 
  0459    2A 1E24        C      	LHLD	SCRBEG 
  045C    19             C      	DAD	D 
  045D    EB             C      	XCHG 
  045E    2A 1E24        C      	LHLD	SCRBEG 
                         C       
  0461    3A 1E28        C      	LDA	YSIZE 
  0464    3D             C      	DCR	A 
  0465    47             C      	MOV	B,A 
                         C       
  0466    0E 10          C      SCU1:	MVI	C,LogicWidth/4 
  0468    1A             C      SCU0:	LDAX	D 
  0469    77             C      	MOV	M,A 
  046A    23             C      	INX	H 
  046B    13             C      	INX	D 
  046C    1A             C      	LDAX	D 
  046D    77             C      	MOV	M,A 
  046E    23             C      	INX	H 
  046F    13             C      	INX	D 
  0470    1A             C      	LDAX	D 
  0471    77             C      	MOV	M,A 
  0472    23             C      	INX	H 
  0473    13             C      	INX	D 
  0474    1A             C      	LDAX	D 
  0475    77             C      	MOV	M,A 
  0476    23             C      	INX	H 
  0477    13             C      	INX	D 
  0478    0D             C      	DCR	C 
  0479    C2 0468        C      	JNZ	SCU0 
  047C    39             C      	DAD	SP 
  047D    EB             C      	XCHG 
  047E    39             C      	DAD	SP 
  047F    EB             C      	XCHG 
  0480    05             C      	DCR	B 
  0481    C2 0466        C      	JNZ	SCU1 
  0484    2A 1430        C      	LHLD	PRSP 
  0487    F9             C      	SPHL 
  0488    C9             C      	RET 
                         C       
  0489    7E             C      NEXTST:	MOV	A,M 
  048A    FE FF          C      	CPI	0FFH 
  048C    C8             C      	RZ 
	MACRO-80 3.44	09-Dec-81	PAGE	1-15


  048D    FE 0D          C      	CPI	0DH 
  048F    CA 0496        C      	JZ	NXTS0 
  0492    23             C      	INX	H 
  0493    C3 0489        C      	JMP	NEXTST 
  0496    23             C      NXTS0:	INX	H 
  0497    7E             C      	MOV	A,M 
  0498    FE FF          C      	CPI	0FFH 
  049A    C9             C      	RET 
                         C       
  049B    D5             C      wwerh:	PUSH	D 
  049C    2A 1E22        C      	LHLD	STRADR 
  049F    CD 04F8        C      	CALL	PREVST 
  04A2    D1             C      	POP	D 
  04A3    22 1E22        C      	SHLD	STRADR 
  04A6    C8             C      	RZ 
  04A7    CD 01D7        C      	CALL	DCRCUR 
  04AA    3A 1E2B        C      	LDA	CURY 
  04AD    3D             C      	DCR	A 
  04AE    CA 04CA        C      	JZ	ROLLDN 
  04B1    32 1E2B        C      	STA	CURY 
  04B4    C3 0364        C      	JMP	CURSM 
                         C       
                         C       
  04B7    2A 1E20        C      RLDN:	LHLD	SCRADR 
  04BA    CD 04F8        C      	CALL	PREVST 
  04BD    C8             C      	RZ 
  04BE    2A 1E22        C      	LHLD	STRADR 
  04C1    CD 04F8        C      	CALL	PREVST 
  04C4    22 1E22        C      	SHLD	STRADR 
  04C7    CD 01D7        C      	CALL	DCRCUR 
  04CA    2A 1E20        C      ROLLDN:	LHLD	SCRADR 
  04CD    CD 04F8        C      	CALL	PREVST 
  04D0    22 1E20        C      	SHLD	SCRADR 
  04D3    C8             C      	RZ 
  04D4    E5             C      	PUSH	H 
  04D5    CD 040E        C      	CALL	SCRDN 
  04D8    2A 1E24        C      	LHLD	SCRBEG 
  04DB    EB             C      	XCHG 
  04DC    E1             C      	POP	H 
  04DD    EB             C      	xCHG 
  04DE    3A 1E2C        C      	lda	DISPOS 
  04E1    CD 13B1        C      	CALL	DISSTR 
                         C       
  04E4    21 1E2D        C      	LXI	H,?END 
  04E7    7E             C      	MOV	A,M 
  04E8    B7             C      	ORA	A 
  04E9    CA 04EE        C      	JZ	RLD0 
  04EC    35             C      	DCR	M 
  04ED    C9             C      	RET 
  04EE    2A 1E06        C      RLD0:	LHLD	SCREND 
  04F1    CD 04F8        C      	CALL	PREVST 
  04F4    22 1E06        C      	SHLD	SCREND 
  04F7    C9             C      	RET 
                         C       
  04F8    2B             C      PREVST:	DCX	H 
  04F9    3A 1E01        C      	LDA	nivgr+1 
	MACRO-80 3.44	09-Dec-81	PAGE	1-16


  04FC    3D             C      	DCR	A 
  04FD    BC             C      	CMP	H 
  04FE    CA 0515        C      	JZ	PREVS0 
  0501    2B             C      PREVS1:	DCX	H 
  0502    3A 1E01        C      	LDA	nivgr+1 
  0505    3D             C      	DCR	A 
  0506    BC             C      	CMP	H 
  0507    CA 0510        C      	JZ	PREVS2 
  050A    7E             C      	MOV	A,M 
  050B    FE 0D          C      	CPI	0DH 
  050D    C2 0501        C      	JNZ	PREVS1 
  0510    3E 01          C      PREVS2:	MVI	A,1 
  0512    B7             C      	ORA	A 
  0513    23             C      	INX	H 
  0514    C9             C      	RET 
                         C       
  0515    2A 1E00        C      PREVS0:	LHLD	nivgr 
  0518    C9             C      	RET 
                         C       
                         C       
  0519                   C      SETRST: 
  0519    3E 01          C      	mvi	a,1 
  051B    32 1E3B        C      	sta	?StringBufActive 
  051E    21 1E7D        C      	LXI	H,STRRED 
  0521    22 1E3D        C      	SHLD	TABSRH 
  0524    2A 1E22        C      	LHLD	STRADR 
  0527    11 1E7D        C      	LXI	D,STRRED 
  052A    06 80          C      	MVI	B,MAXLEN+1 
  052C    0E 00          C      	MVI	C,0 
  052E    7E             C      I00:	MOV	A,M 
  052F    12             C      	STAX	D 
  0530    23             C      	INX	H 
  0531    13             C      	INX	D 
  0532    0C             C      	INR	C 
  0533    FE 0D          C      	CPI	0DH 
  0535    CA 0545        C      	JZ	I01 
  0538    FE FF          C      	CPI	0FFH 
  053A    CA 0545        C      	JZ	I01 
  053D    05             C      	DCR	B 
  053E    C2 052E        C      	JNZ	I00 
  0541    3E 0D          C      	MVI	A,0DH 
  0543    12             C      	STAX	D 
  0544    0C             C      	INR	C 
  0545    79             C      I01:	MOV	A,C 
  0546    32 1E19        C      	STA	OLDMES 
  0549    32 1E1A        C      	STA	NEWMES 
  054C    2A 1E24        C      	LHLD	SCRBEG 
  054F    3A 1E2B        C      	LDA	CURY 
  0552    3D             C      	DCR	A 
  0553    CA 055E        C      	JZ	I02 
  0556    01 004E        C      	LXI	B,ScrWidth 
  0559    09             C      I03:	DAD	B 
  055A    3D             C      	DCR	A 
  055B    C2 0559        C      	JNZ	I03 
  055E    22 1E04        C      I02:	SHLD	VDADR 
  0561    2A 1E0C        C      	LHLD	BLBEG 
	MACRO-80 3.44	09-Dec-81	PAGE	1-17


  0564    22 1E10        C      	SHLD	OLDBLB 
  0567    CD 0917        C      	CALL	CHKPNT 
  056A    3E 00          C      	MVI	A,0 
  056C    DA 0570        C      	JC	$+4 
  056F    2F             C      	CMA 
  0570    32 1E14        C      	STA	BEGCOR 
  0573    2A 1E0E        C      	LHLD	BLEND 
  0576    22 1E12        C      	SHLD	OLDBLE 
  0579    CD 0917        C      	CALL	CHKPNT 
  057C    3E 00          C        	MVI	A,0 
  057E    DA 0582        C      	JC	$+4 
  0581    2F             C      	CMA 
  0582    32 1E15        C      	STA	ENDCOR 
  0585    C9             C      	RET 
                         C       
  0586    AF             C      INSRED:	xra	a 
  0587    32 1E3B        C      	sta	?StringBufActive 
  058A    3A 1E1A        C      	LDA	NEWMES 
  058D    3D             C      	DCR	A 
  058E    CD 092F        C      	CALL	CAD1 
  0591    3C             C      	INR	A 
  0592    47             C      	MOV	B,A 
  0593    2B             C      I08:	DCX	H 
  0594    05             C      	DCR	B 
  0595    CA 05A3        C      	JZ	I09 
  0598    7E             C      	MOV	A,M 
  0599    FE 20          C      	CPI	20H 
  059B    CA 0593        C      	JZ	I08 
  059E    FE 09          C      	CPI	9 
  05A0    CA 0593        C      	JZ	I08 
  05A3    23             C      I09:	INX	H 
  05A4    36 0D          C      	MVI	M,0DH 
  05A6    78             C      	MOV	A,B 
  05A7    3C             C      	INR	A 
  05A8    32 1E1A        C      	STA	NEWMES 
  05AB    3A 1E19        C      INSR1:	LDA	OLDMES 
  05AE    4F             C      	MOV	C,A 
  05AF    3A 1E1A        C      	LDA	NEWMES 
  05B2    91             C      	SUB	C 
  05B3    CA 05DC        C      	JZ	I04 
  05B6    06 00          C      	MVI	B,0 
  05B8    D2 05BD        C      	JNC	$+5 
  05BB    06 FF          C      	MVI	B,-1 
  05BD    4F             C      	MOV	C,A 
  05BE    F5             C      	PUSH	PSW 
  05BF    C5             C      	PUSH	B 
  05C0    2A 1E06        C      	LHLD	SCREND 
  05C3    09             C      	DAD	B 
  05C4    22 1E06        C      	SHLD	SCREND 
  05C7    3A 1E19        C      	LDA	OLDMES 
  05CA    CD 093B        C      	CALL	CADR11 
  05CD    C1             C      	POP	B 
  05CE    E5             C      	PUSH	H 
  05CF    09             C      	DAD	B 
  05D0    C1             C      	POP	B 
  05D1    54             C      	MOV	D,H 
	MACRO-80 3.44	09-Dec-81	PAGE	1-18


  05D2    5D             C      	MOV	E,L 
  05D3    F1             C      	POP	PSW 
  05D4    F5             C      	PUSH	PSW 
  05D5    D4 05F1        C      	CNC	UPSHT 
  05D8    F1             C              POP	PSW 
  05D9    DC 0608        C      	CC	DNSHT 
                         C       
  05DC    2A 1E22        C      I04:	LHLD	STRADR 
  05DF    11 1E7D        C      	LXI	D,STRRED 
  05E2    3A 1E1A        C      	LDA	NEWMES 
  05E5    47             C      	MOV	B,A 
  05E6    B7             C      	ORA	A 
  05E7    C8             C      	RZ 
  05E8    1A             C      I06:	LDAX	D 
  05E9    77             C      	MOV	M,A 
  05EA    23             C      	INX	H 
  05EB    13             C      	INX	D 
  05EC    05             C      	DCR	B 
  05ED    C2 05E8        C      	JNZ	I06 
  05F0    C9             C      	RET 
                         C       
  05F1    CD 061E        C      UPSHT:	CALL	COMPADR 
  05F4    03             C      U1:	INX	B 
  05F5    23             C      	INX	H 
  05F6    2B             C      U0:	DCX	H 
  05F7    0B             C      	DCX	B 
  05F8    0A             C      	LDAX	B 
  05F9    77             C      	MOV	M,A 
  05FA    7A             C      	MOV	A,D 
  05FB    BC             C      	CMP	H 
  05FC    C2 05F6        C      	JNZ	U0 
  05FF    7B             C      	MOV	A,E 
  0600    BD             C      	CMP	L 
  0601    C2 05F6        C      	JNZ	U0 
  0604    C2 05F6        C      	JNZ	U0 
  0607    C9             C      	RET 
                         C       
  0608    C5             C      DNSHT:	PUSH	B 
  0609    CD 061E        C      	CALL	COMPADR 
  060C    C1             C      	POP	B 
  060D    0B             C      D1:	DCX	B 
  060E    1B             C      	DCX	D 
  060F    03             C      D0:	INX	B 
  0610    13             C      	INX	D 
  0611    0A             C      	LDAX	B 
  0612    12             C      	STAX	D 
  0613    7C             C      	MOV	A,H 
  0614    BA             C      	CMP	D 
  0615    C2 060F        C      	JNZ	D0 
  0618    7D             C      	MOV	A,L 
  0619    BB             C      	CMP	E 
  061A    C2 060F        C      	JNZ	D0 
  061D    C9             C      	RET 
                         C       
  061E    C5             C      COMPADR:PUSH	B 
  061F    78             C      	MOV	A,B 
	MACRO-80 3.44	09-Dec-81	PAGE	1-19


  0620    2F             C      	CMA 
  0621    47             C      	MOV	B,A 
  0622    79             C      	MOV	A,C 
  0623    2F             C      	CMA 
  0624    4F             C      	MOV	C,A 
  0625    03             C      	INX	B 
  0626    62             C      	MOV	H,D 
  0627    6B             C      	MOV	L,E 
  0628    09             C      	DAD	B 
  0629    C1             C      	POP	B 
  062A    E5             C      	PUSH	H 
  062B    D5             C      	PUSH	D 
  062C    50             C      	MOV	D,B 
  062D    59             C      	MOV	E,C 
  062E    44             C      	MOV	B,H 
  062F    4D             C      	MOV	C,L 
  0630    2A 1E0C        C      	LHLD	BLBEG 
  0633    CD 06AF        C      	CALL	CORPNT 
  0636    3A 1E14        C      	LDA	BEGCOR 
  0639    B7             C      	ORA	A 
  063A    C2 0640        C      	JNZ	$+6 
  063D    22 1E0C        C      	SHLD	BLBEG 
  0640    2A 1E0E        C      	LHLD	BLEND 
  0643    CD 06AF        C      	CALL	CORPNT 
  0646    3A 1E15        C      	LDA	ENDCOR 
  0649    B7             C      	ORA	A 
  064A    C2 0650        C      	JNZ	$+6 
  064D    22 1E0E        C      	SHLD	BLEND 
  0650    2A 1E30        C      	LHLD	STRAD0 
  0653    CD 06AF        C      	CALL	CORPNT 
  0656    22 1E30        C      	SHLD	STRAD0 
  0659    2A 1E2E        C      	LHLD	SCRAD0 
  065C    CD 06AF        C      	CALL	CORPNT 
  065F    22 1E2E        C      	SHLD	SCRAD0 
  0662    AF             C      	XRA	A 
  0663    32 1E14        C      	STA	BEGCOR 
  0666    32 1E15        C      	STA	ENDCOR 
  0669    D1             C      	POP	D 
  066A    E1             C      	POP	H 
  066B    D5             C      	PUSH	D 
  066C    EB             C      	XCHG 
  066D    2A 1E02        C      	LHLD	werhgr 
  0670    E5             C      	PUSH	H 
  0671    CD 067B        C      	CALL	CHKMEM 
  0674    19             C      	DAD	D 
  0675    22 1E02        C      	SHLD	werhgr 
  0678    C1             C      	POP	B 
  0679    D1             C      	POP	D 
  067A    C9             C      	RET 
                         C       
  067B    E5             C      CHKMEM:	PUSH	H 
  067C    21 8000        C      	LXI	H,8000H 
  067F    CD 06CE        C      	CALL	CDEHL 
  0682    E1             C      	POP	H 
  0683    D8             C      	RC 
  0684    E5             C      	PUSH	H 
	MACRO-80 3.44	09-Dec-81	PAGE	1-20


  0685    CD 0F8F        C      	CALL	INV_H 
  0688    D5             C      	PUSH	D 
  0689    EB             C      	XCHG 
  068A    CD 013D        C      	CALL	MAXRAM 
  068D    19             C      	DAD	D 
  068E    D1             C      	POP	D 
  068F    CD 06CE        C      	CALL	CDEHL 
  0692    E1             C      	POP	H 
  0693    D0             C      	RNC 
  0694    CD 0BA6        C      	CALL	CLRSTR 
  0697    CD 1235        C      	CALL	INFPR 
  069A    0028           C      	DW	40 
  069C    4F 55 54 20    C      	DC	'OUT OF MEMORY' 
  06A0    4F 46 20 4D    C      
  06A4    45 4D 4F 52    C      
  06A8    D9             C      
  06A9    CD 150E        C      	CALL	GETCHR 
  06AC    C3 0133        C      	JMP	OUT1 
                         C       
  06AF    78             C      CORPNT:	MOV	A,B 
  06B0    B7             C      	ORA	A 
  06B1    F2 06C8        C      	JP	CRPNT0 
  06B4    CD 06CE        C      	CALL	CDEHL 
  06B7    D2 06CC        C      	JNC	CRPNT1 
  06BA    D5             C      	PUSH	D 
  06BB    EB             C      	XCHG 
  06BC    09             C      	DAD	B 
  06BD    EB             C      	XCHG 
  06BE    CD 06CE        C      	CALL	CDEHL 
  06C1    DA 06C6        C      	JC	CRPNT2 
  06C4    62             C              MOV	H,D 
  06C5    6B             C      	MOV	L,E 
  06C6    D1             C      CRPNT2:	POP	D 
  06C7    C9             C      	RET 
                         C       
  06C8    CD 06CE        C      CRPNT0:	CALL	CDEHL 
  06CB    D8             C      	RC 
  06CC    09             C      CRPNT1:	DAD	B 
  06CD    C9             C      	RET 
                         C       
  06CE    7C             C      CDEHL:	MOV	A,H 
  06CF    BA             C      	CMP	D 
  06D0    C0             C      	RNZ 
  06D1    7D             C      	MOV	A,L 
  06D2    BB             C      	CMP	E 
  06D3    C9             C      	RET 
  06D4    C1             C      LFTM::	POP	B 
  06D5    CD 02B2        C      	CALL	wlewo 
  06D8    C3 0718        C      	JMP	RED 
                         C       
  06DB    C1             C      RHTM::	POP	B 
  06DC    CD 02BD        C      	CALL	wprawo 
  06DF    C3 0718        C      	JMP	RED 
                         C       
  06E2    CD 0586        C      UPM::	CALL	INSRED 
  06E5    CD 049B        C      	CALL	wwerh 
	MACRO-80 3.44	09-Dec-81	PAGE	1-21


  06E8    C3 0136        C      	JMP	OUT3 
                         C       
  06EB    CD 0586        C      DWNM::	CALL	INSRED 
  06EE    CD 03B1        C      	CALL	wniz 
  06F1    C3 0136        C      	JMP	OUT3 
                         C       
  06F4                   C      SCRLUP:: 
  06F4    CD 0586        C      	CALL	INSRED 
  06F7    CD 04B7        C      	CALL	RLDN 
  06FA    C3 0136        C      	JMP	OUT3 
                         C       
  06FD                   C      SCRLDN:: 
  06FD    CD 0586        C      	CALL	INSRED 
  0700    CD 03D3        C      	CALL	RLUP 
  0703    C3 0136        C      	JMP	OUT3 
                         C       
                         C       
  0706    F5             C      SETC:	PUSH	PSW 
  0707    CD 02D8        C      	CALL	GETC 
  070A    32 1E2A        C      	STA	CURX 
  070D    CD 0312        C      	CALL	CURCM 
  0710    F1             C      	POP	PSW 
  0711    C9             C      	RET 
                         C       
                         C       
  0712    CD 0095        C      M03:	CALL	SETINF 
  0715    CD 0519        C      	CALL	SETRST 
                         C       
  0718    CD 01B4        C      RED::	CALL	DISCUR 
  071B    CD 14E5        C      	CALL	GETCHC 
                         C       
  071E    78             C      	MOV	A,B 
  071F    E6 40          C      	ANI	40H ; Ctrl flag 
  0721    C2 072F        C      	JNZ	ANDR 
                         C       
  0724    79             C      	MOV	A,C ; All control symbols are less than 20h except for Backspace - 7Fh 
  0725    FE 7F          C      	CPI	7fH 
  0727    CA 072F        C      	jz	ANDR 
                         C      	 
  072A    FE 20          C      	CPI	20H 
  072C    D2 082B        C      	JNC	PRCHR 
                         C       
  072F    48             C      ANDR:	MOV	C,B 
                         C       
  0730    11 082E        C      	lxi	d,DISALL 
  0733    D5             C      	PUSH	d 
                         C       
  0734    06 00          C      	MVI	B,0 
  0736    21 179D        C      	LXI	H,CMDTBL 
  0739    CD 185F        C      	CALL	FNDCMD 
                         C       
  073C    E5             C      	PUSH	H 
  073D    C5             C      	PUSH	B 
  073E    CD 0706        C      	CALL	SETC 
  0741    C1             C      	POP	B 
  0742    E1             C      	POP	H 
	MACRO-80 3.44	09-Dec-81	PAGE	1-22


                         C       
  0743    CD 185F        C              CALL	FNDCMD 
                         C       
  0746    D1             C      	pop	d 
  0747    11 0133        C      	LXI	d,OUT1 
  074A    D5             C      	PUSH	d 
                         C       
  074B    CD 185F        C      	CALL	FNDCMD 
  074E    E5             C      	PUSH	H 
  074F    C5             C      	PUSH	B 
  0750    CD 0586        C      	CALL	INSRED 
  0753    C1             C      	POP	B 
  0754    E1             C      	POP	H 
  0755    CD 185F        C      	CALL	FNDCMD 
  0758    E5             C      	PUSH	H 
  0759    2A 1E0E        C      	LHLD	BLEND 
  075C    EB             C      	XCHG 
  075D    2A 1E0C        C      	LHLD	BLBEG 
  0760    CD 06CE        C      	CALL	CDEHL 
  0763    E1             C      	POP	H 
  0764    DC 185F        C      	CC	FNDCMD 
  0767    C9             C      	RET 
                         C       
  0768    EB             C      DELCOR:	XCHG 
  0769    CD 0902        C      	CALL	COR 
  076C    D8             C      	RC 
  076D    2B             C      	DCX	H 
  076E    C9             C      	RET 
                         C       
                         C       
  076F    3A 1E2A        C      LDEL::	LDA	CURX 
  0772    3D             C      	DCR	A 
  0773    C8             C      	RZ 
  0774    32 1E2A        C      	STA	CURX 
  0777    CD 0706        C      	CALL	SETC 
                         C       
  077A    CD 0892        C      RDEL::	CALL	FILSP 
  077D    CD 092B        C      	CALL	CAD 
  0780    7E             C      	MOV	A,M 
  0781    FE 0D          C      	CPI	0DH 
  0783    C8             C      	RZ 
  0784    2B             C      	DCX	H 
  0785    7E             C      	MOV	A,M 
  0786    EB             C      	XCHG 
  0787    D5             C      	PUSH	D 
  0788    13             C      	INX	D 
  0789    42             C      	MOV	B,D 
  078A    4B             C      	MOV	C,E 
  078B    D1             C      	POP	D 
  078C    21 1EFB        C      	LXI	H,STRRED+MAXLEN-1 
  078F    CD 060F        C      	CALL	D0 
  0792    21 0768        C      	LXI	H,DELCOR 
  0795    CD 08D8        C      	CALL	CORRECT 
  0798    3A 1E1A        C      	LDA	NEWMES 
  079B    3D             C      	DCR	A 
  079C    32 1E1A        C      	STA	NEWMES 
	MACRO-80 3.44	09-Dec-81	PAGE	1-23


  079F    C9             C      	RET 
                         C       
  07A0                   C      REPMOD:: 
  07A0    3A 1E1B        C      	LDA	MODE 
  07A3    FE 93          C      	CPI	93H 
  07A5    CA 0F26        C      	JZ	INSERT 
  07A8    C3 0F30        C      	JMP	OVRW 
                         C       
                         C       
  07AB    CD 0586        C      BSC::	CALL	INSRED 
  07AE    CD 0A7A        C      	CALL	BSCR 
  07B1    C3 0136        C      	JMP	OUT3 
                         C       
  07B4    CD 07FA        C      TAB::	CALL	PRCH0 
                         C      ;	CALL	wprawo 
  07B7    3A 1E2A        C      	LDA	CURX 
  07BA    3D             C      	dcr	a 
  07BB    CD 034D        C      	call	CalcNextTabPos 
  07BE    32 1E2A        C      	STA	CURX 
  07C1    C9             C      	RET 
                         C       
  07C2    2A 1E10        C      REST::	LHLD	OLDBLB 
  07C5    22 1E0C        C      	SHLD	BLBEG 
  07C8    2A 1E12        C      	LHLD	OLDBLE 
  07CB    22 1E0E        C      	SHLD	BLEND 
  07CE    C3 0133        C      	JMP	OUT1 
                         C       
                         C       
  07D1    CD 0586        C      CR::	CALL	INSRED 
  07D4    2A 1E20        C      	LHLD	SCRADR 
  07D7    EB             C      	XCHG 
  07D8    3E 01          C      	MVI	A,1 
  07DA    32 1E2A        C      	STA	CURX 
  07DD    CD 0221        C      	CALL	DISPLY 
  07E0    CD 03B1        C      CR0:	CALL	wniz 
  07E3    FE FF          C      	CPI	0FFH 
  07E5    C2 0133        C      	JNZ	OUT1 
  07E8    36 0D          C      	MVI	M,0DH 
  07EA    23             C      	INX	H 
  07EB    36 FF          C      	MVI	M,0FFH 
  07ED    22 1E02        C      	SHLD	werhgr 
  07F0    2A 1E08        C      	LHLD	NUMSTR 
  07F3    23             C      	INX	H 
  07F4    22 1E08        C      	SHLD	NUMSTR 
  07F7    C3 07E0        C      	JMP	CR0 
                         C       
  07FA    32 1E42        C      PRCH0:	STA	SYM 
  07FD    21 1E7D        C      	LXI	H,STRRED 
  0800    CD 0892        C      	CALL	FILSP 
  0803    CD 092B        C      	CALL	CAD 
  0806    3A 1E1B        C      	LDA	MODE 
  0809    FE 93          C      	CPI	93H 
  080B    CA 0817        C      	JZ	PRC00 
  080E    3A 1E1A        C      	LDA	NEWMES 
  0811    FE 80          C      	CPI	MAXLEN+1 
  0813    D0             C      	RNC 
	MACRO-80 3.44	09-Dec-81	PAGE	1-24


  0814    CD 08B0        C      	CALL	INSSYM 
  0817    CD 0889        C      PRC00:	CALL	?OUT 
  081A    CC 08B0        C      	CZ	INSSYM 
  081D    E5             C      	push	h 
  081E    CD 02BD        C      	CALL	wprawo 
  0821    E1             C      	pop	h 
  0822    3A 1E42        C      	LDA	SYM 
  0825    77             C      	MOV	M,A 
  0826    C9             C      	RET 
                         C       
  0827                   C      INSCTRL:: 
  0827    C1             C      	POP	B 
  0828    CD 150E        C      	CALL	GETCHR 
                         C       
  082B    CD 07FA        C      PRCHR:	CALL	PRCH0 
                         C      ;	CALL	SETC 
                         C      ;	CALL	wprawo 
  082E    CD 0706        C      DISALL:	CALL	SETC 
  0831    11 1E7D        C      	LXI	D,STRRED 
  0834    2A 1E04        C      	LHLD	VDADR 
  0837    3A 1E2C        C      	lda	DISPOS 
  083A    CD 13B1        C      	CALL	DISSTR 
  083D    CD 01B4        C      	CALL	DISCUR 
  0840    3A 1E33        C      	LDA	SCRBG0+1 
  0843    B7             C      	ORA	A 
  0844    CA 0718        C      	JZ	RED 
  0847    2A 1E2E        C      	LHLD	SCRAD0 
  084A    EB             C      	XCHG 
  084B    2A 1E32        C      	LHLD	SCRBG0 
  084E    3A 1E36        C      	LDA	YSIZE0 
  0851    47             C      	MOV	B,A 
  0852    3A 1E22        C      DIS00:	LDA	STRADR 
  0855    BB             C      	CMP	E 
  0856    C2 0877        C      	JNZ	DIS01 
  0859    3A 1E23        C      	LDA	STRADR+1 
  085C    BA             C      	CMP	D 
  085D    C2 0877        C      	JNZ	DIS01 
  0860    11 1E7D        C      	LXI	D,STRRED 
  0863    3A 1E2C        C      	LDA	DISPOS 
  0866    F5             C      	PUSH	PSW 
  0867    3A 1E3A        C      	LDA	DISPS0 
  086A    32 1E2C        C      	STA	DISPOS 
  086D    CD 13B1        C      	CALL	DISSTR 
  0870    F1             C      	POP	PSW 
  0871    32 1E2C        C      	STA	DISPOS 
  0874    C3 0718        C      	JMP	RED 
  0877    EB             C      DIS01:	XCHG 
  0878    CD 0489        C      	CALL	NEXTST 
  087B    EB             C      	XCHG 
  087C    C5             C      	PUSH	B 
  087D    01 004E        C      	LXI	B,ScrWidth 
  0880    09             C      	DAD	B 
  0881    C1             C      	POP	B 
  0882    05             C      	DCR	B 
  0883    C2 0852        C      	JNZ	DIS00 
  0886    C3 0718        C      	JMP	RED 
	MACRO-80 3.44	09-Dec-81	PAGE	1-25


                         C       
  0889    CD 02D8        C      ?OUT:	CALL	GETC 
  088C    47             C      	MOV	B,A 
  088D    3A 1E1A        C      	LDA	NEWMES 
  0890    90             C      	SUB	B 
  0891    C9             C      	RET 
                         C       
  0892    CD 0889        C      FILSP:	CALL	?OUT 
  0895    D0             C      	RNC 
  0896    2F             C      	CMA 
  0897    C6 02          C      	ADI	2 
  0899    F5             C      	PUSH	PSW 
  089A    CD 092B        C      	CALL	CAD 
  089D    F1             C      	POP	PSW 
  089E    23             C      	INX	H 
  089F    36 0D          C      	MVI	M,0DH 
  08A1    2B             C      RED2:	DCX	H 
  08A2    36 20          C      	MVI	M,20H 
  08A4    3D             C      	DCR	A 
  08A5    C2 08A1        C      	JNZ	RED2 
  08A8    CD 02D8        C      	CALL	GETC 
  08AB    3C             C      	INR	A 
  08AC    32 1E1A        C      	STA	NEWMES 
  08AF    C9             C      	RET 
                         C       
  08B0    E5             C      INSSYM:	PUSH	H 
  08B1    CD 092B        C      	CALL	CAD 
  08B4    23             C      	INX	H 
  08B5    EB             C      	XCHG 
  08B6    21 1EFD        C      	LXI	H,STRRED+MAXLEN+1 
  08B9    01 1EFC        C      	LXI	B,STRRED+MAXLEN 
  08BC    CD 05F4        C      	CALL	U1 
  08BF    3A 1E1A        C      	LDA	NEWMES 
  08C2    3C             C      	INR	A 
  08C3    FE 81          C      	CPI	MAXLEN+2 
  08C5    D2 08CB        C      	JNC	$+6 
  08C8    32 1E1A        C      	STA	NEWMES 
  08CB    3E 0D          C      	MVI	A,0DH 
  08CD    32 1EFC        C      	STA	STRRED+MAXLEN 
  08D0    21 0910        C      	LXI	H,INSCOR 
  08D3    CD 08D8        C      	CALL	CORRECT 
  08D6    E1             C      	POP	H 
  08D7    C9             C      	RET 
                         C       
  08D8    E5             C      CORRECT:	PUSH	H 
  08D9    EB             C      	XCHG 
  08DA    2A 1E0C        C      	LHLD	BLBEG 
  08DD    EB             C      	XCHG 
  08DE    CD 0901        C      	CALL	CORR 
  08E1    3A 1E14        C      	LDA	BEGCOR 
  08E4    B7             C      	ORA	A 
  08E5    CA 08EB        C      	JZ	$+6 
  08E8    22 1E0C        C      	SHLD	BLBEG 
  08EB    E1             C      	POP	H 
  08EC    EB             C      	XCHG 
  08ED    D5             C      	PUSH	D 
	MACRO-80 3.44	09-Dec-81	PAGE	1-26


  08EE    2A 1E0E        C      	LHLD	BLEND 
  08F1    EB             C      	XCHG 
  08F2    CD 0901        C      	CALL	CORR 
  08F5    3A 1E15        C      	LDA	ENDCOR 
  08F8    B7             C      	ORA	A 
  08F9    CA 08FF        C      	JZ	$+6 
  08FC    22 1E0E        C      	SHLD	BLEND 
  08FF    D1             C      	POP	D 
  0900    C9             C       	RET 
                         C       
  0901    E9             C      CORR:	PCHL 
                         C       
  0902    E5             C      COR:	PUSH	H 
  0903    CD 0917        C      	CALL	CHKPNT 
  0906    E1             C      	POP	H 
  0907    D8             C      	RC 
  0908    EB             C      	XCHG 
  0909    CD 0937        C      	CALL	CADR1 
  090C    EB             C      	XCHG 
  090D    C3 06CE        C      	JMP	CDEHL 
                         C       
  0910    EB             C      INSCOR:	XCHG 
  0911    CD 0902        C      	CALL	COR 
  0914    D8             C      	RC 
  0915    23             C      	INX	H 
  0916    C9             C      	RET 
                         C       
  0917    EB             C      CHKPNT:	XCHG 
  0918    2A 1E22        C      	LHLD	STRADR 
  091B    2B             C      	DCX	H 
  091C    CD 06CE        C      	CALL	CDEHL 
  091F    3F             C      	CMC 
  0920    D8             C      	RC 
  0921    3A 1E1A        C      	LDA	NEWMES 
  0924    3D             C      	DCR	A 
  0925    CD 093B        C      	CALL	CADR11 
  0928    C3 06CE        C      	JMP	CDEHL 
                         C       
  092B    CD 02D8        C      CAD:	CALL	GETC 
  092E    3D             C      	DCR	A 
  092F    06 00          C      CAD1:	MVI	B,0 
  0931    4F             C      	MOV	C,A 
  0932    21 1E7D        C      	LXI	H,STRRED 
  0935    09             C      	DAD	B 
  0936    C9             C      	RET 
                         C       
  0937    CD 02D8        C      CADR1:	CALL	GETC 
  093A    3D             C      	DCR	A 
  093B    06 00          C      CADR11:	MVI	B,0 
  093D    4F             C      	MOV	C,A 
  093E    2A 1E22        C      	LHLD	STRADR 
  0941    09             C      	DAD	B 
  0942    C9             C      	RET 
                         C       
                         C       
  0943                   C      SWPWIN:: 
	MACRO-80 3.44	09-Dec-81	PAGE	1-27


  0943    CD 094C        C      	CALL	SWPWN 
  0946    2A 1E22        C      	LHLD	STRADR 
  0949    C3 117E        C      	JMP	DISADR 
                         C       
  094C    3A 1E33        C      SWPWN:	LDA	SCRBG0+1 
  094F    B7             C      	ORA	A 
  0950    C8             C      	RZ 
  0951    CD 10A5        C      	CALL	SETST0 
  0954    21 1E20        C      	LXI	H,SCRADR 
  0957    11 1E2E        C      	LXI	D,SCRAD0 
  095A    0E 0E          C      	MVI	C,14 
  095C    46             C      SWPW0:	MOV	B,M 
  095D    1A             C      	LDAX	D 
  095E    77             C      	MOV	M,A 
  095F    78             C      	MOV	A,B 
  0960    12             C      	STAX	D 
  0961    23             C      	INX	H 
  0962    13             C      	INX	D 
  0963    0D             C      	DCR	C 
  0964    C2 095C        C      	JNZ	SWPW0 
  0967    3A 1E3C        C      	LDA	?WIN1 
  096A    2F             C      	CMA 
  096B    32 1E3C        C      	STA	?WIN1 
  096E    3E 01          C      	MVI	A,1 
  0970    B7             C      	ORA	A 
  0971    C9             C      	RET 
                         C       
  0014                   C      YMAX	EQU	LogicHeight-3 
  0002                   C      YMIN	EQU	2 
                         C       
  0972    3A 1E33        C      WINUP::	LDA	SCRBG0+1 
  0975    B7             C      	ORA	A 
  0976    C2 099A        C      	JNZ	WINU0 
  0979    3E 14          C      	MVI	A,YMAX 
  097B    32 1E28        C      	STA	YSIZE 
  097E    3C             C      	INR	A 
  097F    32 1E37        C      	STA	YBEG0 
  0982    3E 02          C      	MVI	A,YMIN 
  0984    32 1E36        C      	STA	YSIZE0 
  0987    2A 1E26        C      	LHLD	INFADR 
  098A    22 1E34        C      	SHLD	INFAD0 
  098D    01 FF16        C      	LXI	B,-3*ScrWidth 
  0990    09             C      	DAD	B 
  0991    22 1E32        C      	SHLD	SCRBG0 
  0994    22 1E26        C      	SHLD	INFADR 
  0997    C3 09CB        C      	JMP	WIN01 
  099A    3A 1E3C        C      WINU0:	LDA	?WIN1 
  099D    B7             C      	ORA	A 
  099E    C2 09AA        C      	JNZ	WINU1 
  09A1    CD 094C        C      	CALL	SWPWN 
  09A4    CD 09AA        C      	CALL	WINU1 
  09A7    C3 094C        C      	JMP	SWPWN 
  09AA    3A 1E28        C      WINU1:	LDA	YSIZE 
  09AD    FE 02          C      	CPI	YMIN 
  09AF    CA 09DD        C      	JZ	CLRW1 
  09B2    3D             C      	DCR	A 
	MACRO-80 3.44	09-Dec-81	PAGE	1-28


  09B3    32 1E28        C      	STA	YSIZE 
  09B6    21 1E36        C      	LXI	H,YSIZE0 
  09B9    34             C      	INR	M 
  09BA    21 1E37        C      	LXI	H,YBEG0 
  09BD    35             C      	DCR	M 
  09BE    2A 1E26        C      	LHLD	INFADR 
  09C1    01 FFB2        C      	LXI	B,-ScrWidth 
  09C4    09             C      	DAD	B 
  09C5    22 1E32        C      	SHLD	SCRBG0 
  09C8    22 1E26        C      	SHLD	INFADR 
  09CB    3A 1E28        C      WIN01:	LDA	YSIZE 
  09CE    47             C      	MOV	B,A 
  09CF    3A 1E2B        C      	LDA	CURY 
  09D2    B8             C      	CMP	B 
  09D3    D8             C      	RC 
  09D4    CD 049B        C      	CALL	wwerh 
  09D7    CD 03D3        C      	CALL	RLUP 
  09DA    C3 09CB        C      	JMP	WIN01 
                         C       
  09DD    21 0000        C      CLRW1:	LXI	H,0 
  09E0    22 1E24        C      	SHLD	SCRBEG 
  09E3    CD 0943        C      	CALL	SWPWIN 
  09E6    3E FF          C      	MVI	A,0FFH 
  09E8    32 1E3C        C      	STA	?WIN1 
  09EB    C3 015C        C      	JMP	INIT 
                         C       
  09EE    3A 1E33        C      WINDN::	LDA	SCRBG0+1 
  09F1    B7             C      	ORA	A 
  09F2    C2 0A26        C      	JNZ	WIND0 
  09F5    AF             C      	XRA	A 
  09F6    32 1E37        C      	STA	YBEG0 
  09F9    32 1E3C        C      	STA	?WIN1 
  09FC    3E 14          C      	MVI	A,YMAX 
  09FE    32 1E28        C      	STA	YSIZE 
  0A01    2A 0003        C      	LHLD	VRAM_ADR 
  0A04    22 1E32        C      	SHLD	SCRBG0 
  0A07    3E 02          C      	MVI	A,YMIN 
  0A09    32 1E36        C      	STA	YSIZE0 
  0A0C    3C             C      	INR	A 
  0A0D    32 1E29        C      	STA	YBEG 
  0A10    2A 0003        C      	LHLD	VRAM_ADR 
  0A13    11 00EA        C      	LXI	D, 3*ScrWidth 
  0A16    19             C      	DAD	D 
  0A17    22 1E34        C      	SHLD	INFAD0 
  0A1A    22 1E24        C      	SHLD	SCRBEG 
  0A1D    CD 122B        C      	CALL	GETINFADR 
  0A20    22 1E26        C      	SHLD	INFADR 
  0A23    C3 0A57        C      	JMP	WIND01 
  0A26    3A 1E3C        C      WIND0:	LDA	?WIN1 
  0A29    B7             C      	ORA	A 
  0A2A    CA 0A36        C      	JZ	WIND1 
  0A2D    CD 094C        C      	CALL	SWPWN 
  0A30    CD 0A36        C      	CALL	WIND1 
  0A33    C3 094C        C      	JMP	SWPWN 
  0A36    3A 1E28        C      WIND1:	LDA	YSIZE 
  0A39    FE 02          C      	CPI	YMIN 
	MACRO-80 3.44	09-Dec-81	PAGE	1-29


  0A3B    CA 0A69        C      	JZ	CLRWD1 
  0A3E    3D             C      	DCR	A 
  0A3F    32 1E28        C      	STA	YSIZE 
  0A42    21 1E36        C      	LXI	H,YSIZE0 
  0A45    34             C      	INR	M 
  0A46    21 1E29        C      	LXI	H,YBEG 
  0A49    34             C      	INR	M 
  0A4A    2A 1E34        C      	LHLD	INFAD0 
  0A4D    01 004E        C      	LXI	B,ScrWidth 
  0A50    09             C      	DAD	B 
  0A51    22 1E24        C      	SHLD	SCRBEG 
  0A54    22 1E34        C      	SHLD	INFAD0 
  0A57    3A 1E28        C      WIND01:	LDA	YSIZE 
  0A5A    47             C      	MOV	B,A 
  0A5B    3A 1E2B        C      	LDA	CURY 
  0A5E    B8             C      	CMP	B 
  0A5F    D8             C      	RC 
  0A60    CD 049B        C      	CALL	wwerh 
  0A63    CD 03D3        C      	CALL	RLUP 
  0A66    C3 0A57        C      	JMP	WIND01 
                         C       
  0A69    21 0000        C      CLRWD1:	LXI	H,0 
  0A6C    22 1E24        C      	SHLD	SCRBEG 
  0A6F    CD 0943        C      	CALL	SWPWIN 
  0A72    3E FF          C      	MVI	A,0FFH 
  0A74    32 1E3C        C      	STA	?WIN1 
  0A77    C3 015C        C      	JMP	INIT 
                         C       
                         C       
  0A7A    2A 1E20        C      BSCR:	LHLD	SCRADR 
  0A7D    22 1E22        C      	SHLD	STRADR 
  0A80    2A 1E2A        C      	LHLD	CURX 
  0A83    7C             C      	MOV	A,H 
  0A84    B5             C      	ORA	L 
  0A85    3D             C      	DCR	A 
  0A86    C2 0AB2        C      	JNZ	CB1 
  0A89    21 0101        C      CB00:	LXI	H,0101H 
  0A8C    22 1E2A        C      	SHLD	CURX 
  0A8F    3A 1E28        C      	LDA	YSIZE 
  0A92    D6 02          C      	SUI	2 
  0A94    CA 0364        C      	JZ	CURSM 
  0A97    47             C      	MOV	B,A 
  0A98    2A 1E22        C      CB0:	LHLD	STRADR 
  0A9B    CD 0489        C      	CALL	NEXTST 
  0A9E    CA 0364        C      	JZ	CURSM 
  0AA1    22 1E22        C      	SHLD	STRADR 
  0AA4    CD 01CF        C      	CALL	INRCUR 
  0AA7    21 1E2B        C      	LXI	H,CURY 
  0AAA    34             C      	INR	M 
  0AAB    05             C      	DCR	B 
  0AAC    C2 0A98        C      	JNZ	CB0 
  0AAF    C3 0364        C      	JMP	CURSM 
                         C       
  0AB2    3A 1E2B        C      CB1:	LDA	CURY 
  0AB5    21 0101        C      	LXI	H,101H 
  0AB8    22 1E2A        C      	SHLD	CURX 
	MACRO-80 3.44	09-Dec-81	PAGE	1-30


  0ABB    2A 1E0A        C      	LHLD	CURSTR 
  0ABE    4F             C      	MOV	C,A 
  0ABF    0D             C      	DCR	C 
  0AC0    7D             C      	MOV	A,L 
  0AC1    91             C      	SUB	C 
  0AC2    77             C      	MOV	M,A 
  0AC3    D2 0AC7        C      	JNC	$+4 
  0AC6    2B             C      	DCX	H 
  0AC7    22 1E0A        C      	SHLD	CURSTR 
  0ACA    C3 0364        C      	JMP	CURSM 
                         C       
                         C       
                         C       
  0ACD    CD 0BA6        C      NEW::	CALL	CLRSTR 
  0AD0    CD 1235        C      	CALL	INFPR 
  0AD3    0021           C      	DW	33 
  0AD5    4E 45 57 20    C      	DC	'NEW Y/N:' 
  0AD9    59 2F 4E BA    C      
  0ADD    2A 1E2A        C      	LHLD	CURX 
  0AE0    E5             C      	PUSH	H 
  0AE1    21 192A        C      	LXI	H,ScrHeight*256+2AH 
  0AE4    22 1E2A        C      	SHLD	CURX 
  0AE7    CD 035B        C      	CALL	CURM 
  0AEA    CD 150E        C      	CALL	GETCHR 
  0AED    FE 59          C      	CPI	59H 
  0AEF    C2 0B00        C      	JNZ	NEW1 
  0AF2    2A 1E00        C      	LHLD	nivgr 
  0AF5    36 0D          C      	MVI	M,0DH 
  0AF7    23             C      	INX	H 
  0AF8    36 FF          C      	MVI	M,0FFH 
  0AFA    22 1E02        C      	SHLD	werhgr 
  0AFD    C3 0015        C      	JMP	START 
  0B00    E1             C      NEW1:	POP	H 
  0B01    22 1E2A        C      	SHLD	CURX 
  0B04    C3 0364        C      	JMP	CURSM 
                         C       
  0010                   C      kraj		EQU	16 
                         C       
  000F                   C      MaxStrLen	equ	15 
  0000                   C      @extend_key	equ	0 
  0001                   C      @backsp_key	equ	1 
  0003                   C      @exit_key	equ	3 
                         C       
  0B07                   C      Input_And_Show: 
  0B07    3E 01          C      	mvi	a,1 
  0B09    02             C      	stax	b 
  0B0A    EB             C      	xchg 
                         C      	SetScrAddr 
  0B0B                   C      @put_str: 
  0B0B    1A             C      	ldax	d 
  0B0C    B7             C      	ora	a 
  0B0D    CA 0B39        C      	jz	move_curs 
                         C      	WriteNextSym 
  0B10    77             C+     		mov	m,a 
  0B11    23             C+     		inx	h 
  0B12    13             C      	inx	d 
	MACRO-80 3.44	09-Dec-81	PAGE	1-31


  0B13    0A             C      	ldax	b 
  0B14    3C             C      	inr	a 
  0B15    02             C      	stax	b 
  0B16    3A 1E2A        C      	lda	CURX 
  0B19    3C             C      	inr	a 
  0B1A    32 1E2A        C      	sta	CURX 
  0B1D    C3 0B0B        C      	jmp	@put_str 
                         C       
  0B20                   C      INPSTR: 
  0B20    36 00          C      	MVI	M,0 
  0B22    EB             C      	xchg 
  0B23                   C      Edit_Line: 
  0B23    3E 01          C      	MVI	A,1 
  0B25    02             C      	STAX	B 
  0B26    3E 10          C      	MVI	A,kraj 
  0B28    32 1E2A        C      	STA	CURX 
  0B2B    3E 19          C      	MVI	A,ScrHeight 
  0B2D    32 1E2B        C      	STA	CURY 
  0B30    2A 1E26        C      	LHLD	INFADR 
  0B33    D5             C      	PUSH	D 
  0B34    11 000F        C      	LXI	D,kraj-1 
  0B37    19             C      	DAD	D 
  0B38    D1             C      	POP	D 
  0B39                   C      move_curs: 
  0B39    CD 035B        C      	call	CURM 
  0B3C                   C      Get_key: 
  0B3C    CD 150E        C      	CALL	GETCHR 
  0B3F    FE 00          C      	CPI	@extend_key 
  0B41    C2 0B4A        C      	JNZ	No_extend 
  0B44    CD 150E        C      	CALL	GETCHR 
  0B47    C3 0B6F        C      	JMP	Ins_sym 
                         C       
  0B4A                   C      No_extend: 
  0B4A    FE 0D          C      	CPI	0DH 
  0B4C    CA 0B86        C      	jz	exit_inp_str 
  0B4F    FE 03          C      	CPI	@exit_key 
  0B51    CA 0B89        C      	JZ	IN4 
  0B54    FE 01          C      	CPI	@backsp_key 
  0B56    C2 0B6F        C      	JNZ	Ins_Sym 
                         C       
  0B59    0A             C      	LDAX	B 
  0B5A    3D             C      	DCR	A 
  0B5B    CA 0B3C        C      	JZ	Get_Key 
  0B5E    02             C      	STAX	B 
  0B5F    2B             C      	dcx	h 
                         C      	SetScrAddr 
  0B60    AF             C      	xra	a 
                         C      	WriteNextSym 
  0B61    77             C+     		mov	m,a 
  0B62    23             C+     		inx	h 
  0B63    2B             C      	dcx	h 
                         C      	SetScrAddr 
  0B64    1B             C      	dcx	d 
  0B65    3A 1E2A        C      	LDA	CURX 
  0B68    3D             C      	DCR	A 
  0B69    32 1E2A        C      	STA	CURX 
	MACRO-80 3.44	09-Dec-81	PAGE	1-32


  0B6C    C3 0B39        C      	jmp	move_curs 
                         C       
  0B6F                   C      Ins_Sym: 
  0B6F    12             C      	stax	d 
  0B70    0A             C      	ldax	b 
  0B71    FE 0F          C      	CPI	MaxStrLen 
  0B73    CA 0B3C        C      	JZ	Get_Key 
  0B76    3C             C      	inr	a 
  0B77    02             C      	stax	b 
  0B78    3A 1E2A        C      	LDA	CURX 
  0B7B    3C             C      	INR	A 
  0B7C    32 1E2A        C      	STA	CURX 
  0B7F    1A             C      	ldax	d 
                         C      	WriteNextSym 
  0B80    77             C+     		mov	m,a 
  0B81    23             C+     		inx	h 
  0B82    13             C      	inx	d 
  0B83    C3 0B39        C      	jmp	move_curs 
                         C       
  0B86                   C      exit_inp_str: 
  0B86    AF             C      	xra	a 
  0B87    12             C      	stax	d 
  0B88    C9             C      	ret 
                         C       
  0B89    2A 1E22        C      IN4:	LHLD	STRADR 
  0B8C    CD 117E        C      	CALL	DISADR 
  0B8F    C3 0133        C      	JMP	OUT1 
                         C       
                         C       
                         C       
  0B92    C5             C      LINE:	push	b 
                         C      	;LHLD	INFADR 
  0B93    CD 122B        C      	CALL	GETINFADR 
  0B96    01 FFB2        C      	LXI	B,-ScrWidth 
  0B99    09             C      	DAD	B 
                         C      	SetScrAddr 
  0B9A    0E 40          C      	MVI	c,LogicWidth 
  0B9C    3E 1C          C      CLR1:	mvi	a,LineSym 
                         C      	WriteNextSym 
  0B9E    77             C+     		mov	m,a 
  0B9F    23             C+     		inx	h 
  0BA0    0D             C      	dcr	c 
  0BA1    C2 0B9C        C      	JNZ	CLR1 
  0BA4    C1             C      	pop	b 
  0BA5    C9             C      	RET 
                         C       
  0BA6    E5             C      CLRSTR:	PUSH	H 
  0BA7    F5             C      	PUSH	PSW 
  0BA8    C5             C      	push	b 
  0BA9    CD 0B92        C      	CALL	LINE 
  0BAC    2A 0003        C      	LHLD	VRAM_ADR 
  0BAF    01 0702        C      	LXI	B,INFSTR_OFFS-ScrWidth 
  0BB2    09             C      	DAD	B 
                         C      	SetScrAddr 
  0BB3    0E 40          C      	mvi	c,LogicWidth 
  0BB5    3E 20          C      CLR0:	mvi	a,space 
	MACRO-80 3.44	09-Dec-81	PAGE	1-33


                         C      	writeNextSym 
  0BB7    77             C+     		mov	m,a 
  0BB8    23             C+     		inx	h 
  0BB9    0D             C      	dcr	c 
  0BBA    C2 0BB5        C      	JNZ	CLR0 
                         C       
  0BBD    CD 1235        C      	CALL	INFPR 
  0BC0    001E           C      	DW	30 
  0BC2    9B             C      	DB	DelimSym+80h 
                         C       
  0BC3    CD 1235        C      	CALL	INFPR 
  0BC6    0007           C      	DW	7 
  0BC8    9B             C      	DB	DelimSym+80h 
  0BC9    C1             C      	pop	b 
  0BCA    F1             C      	POP	PSW 
  0BCB    E1             C      	POP	H 
  0BCC    C9             C      	RET 
                         C       
  0BCD    CD 0BA6        C      INPSR:	CALL	CLRSTR 
  0BD0    CD 1235        C      	CALL	INFPR 
  0BD3    0008           C      	DW	8 
  0BD5    54 41 52 47    C      	DC	'TARGET:' 
  0BD9    45 54 BA       C      
  0BDC    21 1E61        C      	LXI	H,STRSR 
  0BDF    01 1E16        C      	LXI	B,SRMES 
  0BE2    C3 0B20        C      	JMP	INPSTR 
                         C       
                         C       
  0BE5                   C      CONT_SRREP: 
  0BE5    3A 1E17        C      	LDA	RPMES 
  0BE8    B7             C      	ORA	A 
  0BE9    CA 0CED        C      	JZ	CONT_SRH 
  0BEC    C3 0BEF        C      	JMP	RPREP0 
                         C       
  0BEF    CD 0F57        C      RPREP0:	CALL	MARK 
  0BF2    C3 0C07        C      	JMP	RPREP1 
                         C       
  0BF5    E5             C      REPREP:	PUSH	H 
  0BF6    CD 122B        C      	CALL	GETINFADR 
  0BF9    01 0003        C      	LXI	B,3 
  0BFC    09             C      	DAD	B 
  0BFD    3E 0B          C      	MVI	A,11 
  0BFF    36 00          C      	MVI	M,0 
  0C01    3D             C      	DCR	A 
  0C02    23             C      	INX	H 
  0C03    C2 0BFF        C      	JNZ	$-4 
  0C06    E1             C      	POP	H 
  0C07    3A 1E17        C      RPREP1:	LDA	RPMES 
  0C0A    3D             C      	DCR	A 
  0C0B    4F             C      	MOV	C,A 
  0C0C    06 00          C      	MVI	B,0 
  0C0E    09             C      	DAD	B 
  0C0F    C3 0C72        C      	JMP	REP0 
                         C       
  0C12                   C      REPLACE:: 
  0C12    2A 1E2A        C      	LHLD	CURX 
	MACRO-80 3.44	09-Dec-81	PAGE	1-34


  0C15    E5             C      	PUSH	H 
  0C16    CD 0BCD        C      	CALL	INPSR 
  0C19    CD 0BA6        C      	CALL	CLRSTR 
  0C1C    CD 1235        C      	CALL	INFPR 
  0C1F    0007           C      	DW	7 
  0C21    52 45 50 4C    C      	DC	'REPLACE:' 
  0C25    41 43 45 BA    C      
  0C29    21 1E6F        C      	LXI	H,STRREP 
  0C2C    01 1E17        C      	LXI	B,RPMES 
  0C2F    CD 0B20        C      	CALL	INPSTR 
  0C32    CD 0BA6        C      	CALL	CLRSTR 
  0C35    CD 1235        C      	CALL	INFPR 
  0C38    0021           C      	DW	33 
  0C3A    5B 47 5D 4C    C      	DC	'[G]LOBAL OR [S]TEP:' 
  0C3E    4F 42 41 4C    C      
  0C42    20 4F 52 20    C      
  0C46    5B 53 5D 54    C      
  0C4A    45 50 BA       C      
  0C4D    21 1935        C      	LXI	H,ScrHeight*256+35H 
  0C50    22 1E2A        C      	SHLD	CURX 
  0C53    CD 035B        C      	CALL	CURM 
  0C56    CD 150E        C      REP2:	CALL	GETCHR 
  0C59    E6 5F          C      	ANI	5FH 
  0C5B    32 1E1C        C      	STA	RMODE 
  0C5E    FE 53          C      	CPI	'S' 
  0C60    CA 0C68        C      	JZ	REP3 
  0C63    FE 47          C      	CPI	'G' 
  0C65    C2 0C56        C      	JNZ	REP2 
  0C68    CD 0BA6        C      REP3:	CALL	CLRSTR 
  0C6B    E1             C      	POP	H 
  0C6C    22 1E2A        C      	SHLD	CURX 
  0C6F    2A 1E22        C      	LHLD	STRADR 
  0C72    3A 1E16        C      REP0:	LDA	SRMES 
  0C75    3D             C      	DCR	A 
  0C76    CA 0B89        C      	JZ	IN4 
  0C79    32 1E19        C      	STA	OLDMES 
  0C7C    3A 1E17        C      	LDA	RPMES 
  0C7F    3D             C      	DCR	A 
  0C80    CA 0B89        C      	JZ	IN4 
  0C83    CD 0D11        C      	CALL	SearchStr 
  0C86    E5             C      	PUSH	H 
  0C87    EB             C      	XCHG 
  0C88    CD 11CF        C      	CALL	DISAD1 
  0C8B    CD 0221        C      	CALL	DISPLY 
  0C8E    E1             C      	POP	H 
  0C8F    3A 1E1C        C      	LDA	RMODE 
  0C92    FE 53          C      	CPI	'S' 
  0C94    C2 0CBE        C      	JNZ	REP4 
  0C97    E5             C      	PUSH	H 
  0C98    CD 0BA6        C      	CALL	CLRSTR 
  0C9B    CD 1235        C      	CALL	INFPR 
  0C9E    0021           C      	DW	33 
  0CA0    52 45 50 4C    C      	DC	'REPLACE Y/N' 
  0CA4    41 43 45 20    C      
  0CA8    59 2F CE       C      
  0CAB    E1             C      	POP	H 
	MACRO-80 3.44	09-Dec-81	PAGE	1-35


  0CAC    CD 150E        C      REP1:	CALL	GETCHR 
  0CAF    E6 5F          C      	ANI	5FH 
  0CB1    FE 03          C      	CPI	3 
  0CB3    C8             C      	RZ 
  0CB4    FE 4E          C      	CPI	'N' 
  0CB6    CA 0BF5        C      	JZ	REPREP 
  0CB9    FE 59          C      	CPI	'Y' 
  0CBB    C2 0CAC        C      	JNZ	REP1 
  0CBE    E5             C      REP4:	PUSH	H 
  0CBF    EB             C      	XCHG 
  0CC0    2A 1E22        C      	LHLD	STRADR 
  0CC3    E5             C      	PUSH	H 
  0CC4    EB             C      	XCHG 
  0CC5    22 1E22        C      	SHLD	STRADR 
  0CC8    3A 1E17        C      	LDA	RPMES 
  0CCB    3D             C      	DCR	A 
  0CCC    47             C      	MOV	B,A 
  0CCD    32 1E1A        C      	STA	NEWMES 
  0CD0    21 1E6F        C      	LXI	H,STRREP 
  0CD3    EB             C      	XCHG 
  0CD4    21 1E7D        C      	LXI	H,STRRED 
  0CD7    1A             C      RP0:	LDAX	D 
  0CD8    77             C      	MOV	M,A 
  0CD9    05             C      	DCR	B 
  0CDA    23             C      	INX	H 
  0CDB    13             C      	INX	D 
  0CDC    C2 0CD7        C      	JNZ	RP0 
  0CDF    CD 05AB        C      	CALL	INSR1 
  0CE2    E1             C      	POP	H 
  0CE3    22 1E22        C      	SHLD	STRADR 
  0CE6    CD 0221        C      	CALL	DISPLY 
  0CE9    E1             C      	POP	H 
  0CEA    C3 0BF5        C      	JMP	REPREP 
                         C       
  0CED                   C      CONT_SRH:: 
  0CED    CD 0F57        C      	CALL	MARK 
  0CF0    23             C      	INX	H 
  0CF1    CD 0D11        C      	CALL	SearchStr 
  0CF4    EB             C      	XCHG 
  0CF5    C3 11CF        C      	JMP	DISAD1 
                         C       
  0CF8                   C      SEARCH:: 
  0CF8    AF             C      	XRA	A 
  0CF9    32 1E17        C      	STA	RPMES 
  0CFC    2A 1E2A        C      	LHLD	CURX 
  0CFF    E5             C      	PUSH	H 
  0D00    CD 0BCD        C      	CALL	INPSR 
  0D03    E1             C      	POP	H 
  0D04    22 1E2A        C      	SHLD	CURX 
  0D07    2A 1E22        C      	LHLD	STRADR 
  0D0A    CD 0D11        C      	call	SearchStr 
  0D0D    EB             C      	XCHG 
  0D0E    C3 11CF        C      	JMP	DISAD1 
                         C       
                         C      GetSym	macro 
                         C      local	@no_upc 
	MACRO-80 3.44	09-Dec-81	PAGE	1-36


                         C      	ldax	d 
                         C      	inx	d 
                         C      	cmp	b 
                         C      	jc	@no_upc 
                         C      	cpi	0ffh 
                         C      	jz	NotFound 
                         C      	cmp	c 
                         C      	jnc	@No_Upc 
                         C      	sui	20h 
                         C      @No_Upc: 
                         C      	endm 
                         C       
  0D11                   C      SearchStr: 
  0D11    01 617B        C      	lxi	b,'a' SHL 8 + 'z'+1 
  0D14    EB             C      	xchg 
  0D15    21 1E61        C      	lxi	h,STRSR 
  0D18    E5             C      	push	h 
  0D19                   C      @upcase_lp: 
  0D19    7E             C      	mov	a,m 
  0D1A    B8             C      	cmp	b 
  0D1B    DA 0D24        C      	jc	@noupcase 
  0D1E    B9             C      	cmp	c 
  0D1F    D2 0D24        C      	jnc	@noupcase 
  0D22    D6 20          C      	sui	20h 
  0D24                   C      @noupcase: 
  0D24    77             C      	mov	m,a 
  0D25    23             C      	inx	h 
  0D26    B7             C      	ora	a 
  0D27    C2 0D19        C      	jnz	@upcase_lp 
  0D2A    E1             C      	pop	h 
                         C       
                         C      	init_brk_check 
  0D2B    E5             C+     		PUSH	H 
  0D2C    2A 0005        C+     		LHLD	PPI_ADR 
  0D2F    36 FE          C+     		MVI	M,0FEH 
  0D31    E1             C+     		POP	H 
  0D32                   C      @SrhLoop: 
  0D32                   C      @SrhLp: 
                         C      	check_break 
  0D32    E5             C+     		PUSH	H 
  0D33    2A 0005        C+     		LHLD	PPI_ADR 
  0D36    2C             C+     		INR	L 
  0D37    7E             C+     		MOV	A,M 
  0D38    E1             C+     		POP	H 
  0D39    E6 40          C+     		ANI	40h 
  0D3B    CA 0D92        C      	jz	ABSRH 
                         C      	GetSym 
  0D3E    1A             C+     	ldax	d 
  0D3F    13             C+     	inx	d 
  0D40    B8             C+     	cmp	b 
  0D41    DA 0D4F        C+     	jc	..0000 
  0D44    FE FF          C+     	cpi	0ffh 
  0D46    CA 0D78        C+     	jz	NotFound 
  0D49    B9             C+     	cmp	c 
  0D4A    D2 0D4F        C+     	jnc	..0000 
  0D4D    D6 20          C+     	sui	20h 
	MACRO-80 3.44	09-Dec-81	PAGE	1-37


  0D4F                   C+     ..0000: 
  0D4F    BE             C              cmp	m 
  0D50    C2 0D32        C      	jnz	@SrhLp 
  0D53    23             C      	inx	h 
  0D54    D5             C      	push	d 
  0D55                   C      @Cont:	GetSym 
  0D55    1A             C+     	ldax	d 
  0D56    13             C+     	inx	d 
  0D57    B8             C+     	cmp	b 
  0D58    DA 0D66        C+     	jc	..0001 
  0D5B    FE FF          C+     	cpi	0ffh 
  0D5D    CA 0D78        C+     	jz	NotFound 
  0D60    B9             C+     	cmp	c 
  0D61    D2 0D66        C+     	jnc	..0001 
  0D64    D6 20          C+     	sui	20h 
  0D66                   C+     ..0001: 
  0D66    BE             C      	cmp	m 
  0D67    23             C      	inx	h 
  0D68    CA 0D55        C      	jz	@Cont 
  0D6B    D1             C      	pop	d 
  0D6C    2B             C      	dcx	h 
  0D6D    AF             C      	xra	a 
  0D6E    BE             C      	cmp	m 
  0D6F    21 1E61        C      	lxi	h,STRSR 
  0D72    C2 0D32        C      	jnz	@SrhLoop 
  0D75    1B             C      	dcx	d 
  0D76    EB             C      	xchg 
  0D77    C9             C      	ret 
                         C       
  0D78                   C      NotFound: 
  0D78    CD 0BA6        C      	CALL	CLRSTR 
  0D7B    CD 1235        C      	CALL	INFPR 
  0D7E    0021           C      	DW	33 
  0D80    4E 4F 54 20    C      	DC	'NOT FOUND' 
  0D84    46 4F 55 4E    C      
  0D88    C4             C      
  0D89    CD 150E        C      	CALL	GETCHR 
  0D8C    CD 035B        C      	CALL	CURM 
  0D8F    C3 0133        C      	JMP	OUT1 
                         C       
  0D92    CD 150E        C      ABSRH:	CALL	GETCHR 
  0D95    CD 0BA6        C      	CALL	CLRSTR 
  0D98    CD 1235        C      	CALL	INFPR 
  0D9B    0021           C      	DW	33 
  0D9D    53 45 41 52    C      	DC	'SEARCH/REPLACE ABORTED' 
  0DA1    43 48 2F 52    C      
  0DA5    45 50 4C 41    C      
  0DA9    43 45 20 41    C      
  0DAD    42 4F 52 54    C      
  0DB1    45 C4          C      
  0DB3    CD 150E        C      	CALL	GETCHR 
  0DB6    CD 035B        C      	CALL	CURM 
  0DB9    C3 0133        C      	JMP	OUT1 
                         C       
                         C       
  0DBC    3E 01          C      LEND::	MVI	A,1 
	MACRO-80 3.44	09-Dec-81	PAGE	1-38


  0DBE    32 1E2A        C      	STA	CURX 
  0DC1    C9             C      	RET 
                         C       
  0DC2    3A 1E1A        C      REND::	LDA	NEWMES 
  0DC5    FE 80          C      	CPI	MAXLEN+1 
  0DC7    DA 0DCB        C      	JC	$+4 
  0DCA    3D             C      	DCR	A 
  0DCB    32 1E2A        C      	STA	CURX 
  0DCE    C3 0312        C      	JMP	CURCM 
                         C       
  0DD1                   C      BRKSTR:: 
  0DD1    2A 1E08        C      	LHLD	NUMSTR 
  0DD4    23             C      	INX	H 
  0DD5    22 1E08        C      	SHLD	NUMSTR 
  0DD8    CD 08B0        C      	CALL	INSSYM 
  0DDB    CD 092B        C      	CALL	CAD 
  0DDE    36 0D          C      	MVI	M,0DH 
  0DE0    C3 07D1        C      	JMP	CR 
                         C       
  0DE3                   C      INSSPC:: 
  0DE3    CD 08B0        C      	CALL	INSSYM 
  0DE6    CD 092B        C      	CALL	CAD 
  0DE9    36 20          C      	MVI	M,20H 
  0DEB    C9             C      	RET 
                         C       
  0DEC    CD 0892        C      DELLT::	CALL	FILSP 
  0DEF    21 0E19        C      	LXI	H,LDCOR 
  0DF2    CD 08D8        C      	CALL	CORRECT 
  0DF5    CD 02D8        C      	CALL	GETC 
  0DF8    4F             C      	MOV	C,A 
  0DF9    3A 1E1A        C      	LDA	NEWMES 
  0DFC    91             C      	SUB	C 
  0DFD    CD 092F        C      	CALL	CAD1 
  0E00    F5             C      	PUSH	PSW 
  0E01    E5             C      	PUSH	H 
  0E02    CD 092B        C      	CALL	CAD 
  0E05    44             C      	MOV	B,H 
  0E06    4D             C      	MOV	C,L 
  0E07    E1             C      	POP	H 
  0E08    F1             C      	POP	PSW 
  0E09    3C             C      	INR	A 
  0E0A    32 1E1A        C      	STA	NEWMES 
  0E0D    11 1E7D        C      	LXI	D,STRRED 
  0E10    CD 060D        C      	CALL	D1 
  0E13    3E 01          C      	MVI	A,1 
  0E15    32 1E2A        C      	STA	CURX 
  0E18    C9             C      	RET 
                         C       
  0E19    EB             C      LDCOR:	XCHG 
  0E1A    E5             C      	PUSH	H 
  0E1B    CD 0917        C      	CALL	CHKPNT 
  0E1E    E1             C      	POP	H 
  0E1F    D8             C      	RC 
  0E20    EB             C      	XCHG 
  0E21    CD 0937        C      	CALL	CADR1 
  0E24    CD 06CE        C      	CALL	CDEHL 
	MACRO-80 3.44	09-Dec-81	PAGE	1-39


  0E27    EB             C      	XCHG 
  0E28    D2 0E37        C      	JNC	LDC0 
  0E2B    EB             C      	XCHG 
  0E2C    CD 0F8F        C      	CALL	INV_H 
  0E2F    19             C      	DAD	D 
  0E30    EB             C      	XCHG 
  0E31    2A 1E22        C      	LHLD	STRADR 
  0E34    19             C      	DAD	D 
  0E35    23             C      	INX	H 
  0E36    C9             C      	RET 
  0E37    2A 1E22        C      LDC0:	LHLD	STRADR 
  0E3A    C9             C      	RET 
                         C       
  0E3B    CD 02D8        C      DELRT::	CALL	GETC 
  0E3E    47             C      	MOV	B,A 
  0E3F    3A 1E1A        C      	LDA	NEWMES 
  0E42    B8             C      	CMP	B 
  0E43    D8             C      	RC 
  0E44    CD 092B        C      	CALL	CAD 
  0E47    36 0D          C      	MVI	M,0DH 
  0E49    21 0E56        C      	LXI	H,RDCOR 
  0E4C    CD 08D8        C      	CALL	CORRECT 
  0E4F    CD 02D8        C      	CALL	GETC 
  0E52    32 1E1A        C      	STA	NEWMES 
  0E55    C9             C      	RET 
                         C       
  0E56    EB             C      RDCOR:	XCHG 
  0E57    E5             C      	PUSH	H 
  0E58    CD 0917        C      	CALL	CHKPNT 
  0E5B    E1             C      	POP	H 
  0E5C    D8             C      	RC 
  0E5D    EB             C      	XCHG 
  0E5E    CD 0937        C      	CALL	CADR1 
  0E61    CD 06CE        C      	CALL	CDEHL 
  0E64    D8             C      	RC 
  0E65    EB             C      	XCHG 
  0E66    C9             C      	RET 
                         C       
  0E67                   C      JoinStr:: 
  0E67    2A 1E22        C      	LHLD	STRADR 
  0E6A    CD 0489        C      	CALL	NEXTST 
  0E6D    C8             C      	RZ 
  0E6E    2A 1E08        C      	LHLD	NUMSTR 
  0E71    2B             C      	DCX	H 
  0E72    22 1E08        C      	SHLD	NUMSTR 
  0E75    3A 1E1A        C      	LDA	NEWMES 
  0E78    3D             C      	DCR	A 
  0E79    32 1E1A        C      	STA	NEWMES 
  0E7C    C3 05AB        C      	JMP	INSR1 
                         C       
  0E7F                   C      BEGBUF:: 
  0E7F    21 0001        C      	LXI	H,1 
  0E82    22 1E0A        C      	SHLD	CURSTR 
  0E85    2A 1E00        C      	LHLD	nivgr 
  0E88    22 1E20        C      	SHLD	SCRADR 
  0E8B    22 1E22        C      	SHLD	STRADR 
	MACRO-80 3.44	09-Dec-81	PAGE	1-40


  0E8E    21 0101        C      	LXI	H,0101H 
  0E91    22 1E2A        C      	SHLD	CURX 
  0E94    C3 0364        C      	JMP	CURSM 
                         C       
  0E97                   C      ENDBUF:: 
  0E97    2A 1E08        C      DREND:	LHLD	NUMSTR 
  0E9A    23             C      	INX	H 
  0E9B    22 1E0A        C      	SHLD	CURSTR 
  0E9E    2A 1E02        C      	LHLD	werhgr 
  0EA1    22 1E20        C      	SHLD	SCRADR 
  0EA4    22 1E22        C      	SHLD	STRADR 
  0EA7    21 0101        C      	LXI	H,101H 
  0EAA    22 1E2A        C      	SHLD	CURX 
  0EAD    CD 0EB3        C      	CALL	PAGEUP 
  0EB0    C3 0A89        C      	JMP	CB00 
                         C       
  0EB3                   C      PAGEUP:: 
  0EB3    3A 1E28        C      	LDA	YSIZE 
  0EB6    3D             C      	DCR	A 
  0EB7    47             C      	MOV	B,A 
                         C       
  0EB8    2A 1E20        C      STR2:	LHLD	SCRADR 
  0EBB    CD 04F8        C      	CALL	PREVST 
  0EBE    22 1E20        C      	SHLD	SCRADR 
  0EC1    C2 0EC8        C      	JNZ	$+7 
  0EC4    21 1E2B        C      	LXI	H,CURY 
  0EC7    35             C      	DCR	M 
  0EC8    2A 1E22        C      	LHLD	STRADR 
  0ECB    CD 04F8        C      	CALL	PREVST 
  0ECE    22 1E22        C      	SHLD	STRADR 
  0ED1    CA 0EDE        C      	JZ	STR3 
  0ED4    CD 01D7        C      	CALL	DCRCUR 
  0ED7    05             C      	DCR	B 
  0ED8    C2 0EB8        C      	JNZ	STR2 
  0EDB    C3 0364        C      	JMP	CURSM 
  0EDE    C3 0E7F        C      STR3:	JMP	BEGBUF 
                         C       
  0EE1                   C      PAGEDN:: 
  0EE1    3A 1E28        C      	LDA	YSIZE 
  0EE4    3D             C      	DCR	A 
  0EE5    47             C      	MOV	B,A 
                         C       
  0EE6    2A 1E22        C      DR3:	LHLD	STRADR 
  0EE9    CD 0489        C      	CALL	NEXTST 
  0EEC    CA 0E97        C      	JZ	DREND 
  0EEF    22 1E22        C      	SHLD	STRADR 
  0EF2    2A 1E20        C      	LHLD	SCRADR 
  0EF5    CD 0489        C      	CALL	NEXTST 
  0EF8    22 1E20        C      	SHLD	SCRADR 
  0EFB    CD 01CF        C      	CALL	INRCUR 
  0EFE    05             C      	DCR	B 
  0EFF    C2 0EE6        C      	JNZ	DR3 
  0F02    C9             C      	RET 
                         C       
                         C      	.comment % 
                         C      MODSCR:: 
	MACRO-80 3.44	09-Dec-81	PAGE	1-41


                         C      	LHLD	CURX 
                         C      	PUSH	H 
                         C      	CALL	CLRSTR 
                         C      	CALL	INFPR 
                         C      	DW	33 
                         C      	DC	'NULL (0-9):' 
                         C      	LXI	H,ScrHeight*256+2DH 
                         C      	SHLD	CURX 
                         C      	CALL	CURM 
                         C      MODSC0:	CALL	GETCHR 
                         C      	CPI	30H 
                         C      	JC	MODSC0 
                         C      	CPI	3AH 
                         C      	JNC	MODSC0 
                         C      	PUSH	PSW 
                         C      	CALL	CLS 
                         C      	POP	PSW 
                         C      	SUI	30H-7 
                         C      	STA	LPOS 
                         C      	SUI	6 
                         C      	LHLD	VRAM_ADR 
                         C      	PUSH	D 
                         C      	LXI	H,0E7B9H-0E7C2H 
                         C      	DAD	D 
                         C      	POP	D 
                         C      	DCR	A 
                         C      	DCX	H 
                         C      	JNZ	$-2 
                         C      	MVI	M,0F1H 
                         C      	POP	H 
                         C      	SHLD	CURX 
                         C      	JMP	SAVMOD 
                         C      % 
                         C       
                         C       
  0F03                   C      DELLIN:: 
  0F03    2A 1E22        C      	LHLD	STRADR 
  0F06    54             C      	MOV	D,H 
  0F07    5D             C      	MOV	E,L 
  0F08    CD 0489        C      	CALL	NEXTST 
  0F0B    C8             C      	RZ 
  0F0C    E5             C      	PUSH	H 
  0F0D    2A 1E08        C      	LHLD	NUMSTR 
  0F10    2B             C      	DCX	H 
  0F11    22 1E08        C      	SHLD	NUMSTR 
  0F14    D5             C      	PUSH	D 
  0F15    21 0F22        C      	LXI	H,DLCOR 
  0F18    CD 08D8        C      	CALL	CORRECT 
  0F1B    D1             C      	POP	D 
  0F1C    E1             C      	POP	H 
  0F1D    44             C      	MOV	B,H 
  0F1E    4D             C      	MOV	C,L 
  0F1F    C3 0608        C      	JMP	DNSHT 
                         C       
  0F22    2A 1E22        C      DLCOR:	LHLD	STRADR 
  0F25    C9             C      	RET 
	MACRO-80 3.44	09-Dec-81	PAGE	1-42


                         C       
  0F26    3E B3          C      INSERT:	MVI	A,0B3H 
  0F28    32 1E1B        C      	STA	MODE 
  0F2B    3E ED          C      	MVI	A,CURSOR_BLOCK ; 0EDH 
  0F2D    C3 0F37        C      	JMP	WIDCUR 
                         C       
  0F30    3E 93          C      OVRW:	MVI	A,93H 
  0F32    32 1E1B        C      	STA	MODE 
  0F35    3E DD          C      	MVI	A,CURSOR_LINE ; 0DDH 
  0F37                   C      WIDCUR: 
  0F37    CD 1432        C      	call	SETSCR 
  0F3A    C3 0364        C      	JMP	CURSM 
                         C       
  0F3D    3A 1E1B        C      SAVMOD:	LDA	MODE 
  0F40    FE 93          C      	CPI	93H 
  0F42    F5             C      	PUSH	PSW 
  0F43    C4 0F26        C      	CNZ	INSERT 
  0F46    F1             C      	POP	PSW 
  0F47    CC 0F30        C      	CZ	OVRW 
  0F4A    C9             C      	RET 
                         C       
  0F4B                   C      DISBEG:: 
  0F4B    2A 1E0C        C      	LHLD	BLBEG 
  0F4E    C3 117E        C      	JMP	DISADR 
                         C       
  0F51                   C      DISEND:: 
  0F51    2A 1E0E        C      	LHLD	BLEND 
  0F54    C3 117E        C      	JMP	DISADR 
                         C       
  0F57    21 1E1A        C      MARK:	LXI	H,NEWMES 
  0F5A    CD 02D8        C      	CALL	GETC 
  0F5D    BE             C      	CMP	M 
  0F5E    DA 0F62        C      	JC	MAR0 
  0F61    7E             C      	MOV	A,M 
  0F62    3D             C      MAR0:	DCR	A 
  0F63    C3 093B        C      	JMP	CADR11 
                         C       
  0F66    CD 0F57        C      MRBEG::	CALL	MARK 
  0F69    22 1E0C        C      	SHLD	BLBEG 
  0F6C    C9             C      	RET 
                         C       
  0F6D    CD 0F57        C      MREND::	CALL	MARK 
  0F70    22 1E0E        C      	SHLD	BLEND 
  0F73    C9             C      	RET 
                         C      ;------------- Main block commands ----------- 
                         C       
  0F74    CD 0F83        C      DELBL::	CALL	DBL 
  0F77    CD 01DF        C      	CALL	COMPST 
  0F7A    2A 1E0C        C      	LHLD	BLBEG 
  0F7D    22 1E0E        C      	SHLD	BLEND 
  0F80    C3 117E        C      	JMP	DISADR 
  0F83    2A 1E0C        C      DBL:	LHLD	BLBEG 
  0F86    EB             C      	XCHG 
  0F87    2A 1E0E        C      	LHLD	BLEND 
  0F8A    44             C      	MOV	B,H 
  0F8B    4D             C      	MOV	C,L 
	MACRO-80 3.44	09-Dec-81	PAGE	1-43


  0F8C    C3 0608        C      	JMP	DNSHT 
                         C       
  0F8F    7C             C      INV_H:	MOV	A,H 
  0F90    2F             C      	CMA 
  0F91    67             C      	MOV	H,A 
  0F92    7D             C      	MOV	A,L 
  0F93    2F             C      	CMA 
  0F94    6F             C      	MOV	L,A 
  0F95    C9             C      	RET 
                         C       
  0F96    2A 117C        C      JBLCU:	LHLD	DSTADR 
  0F99    2B             C      	DCX	H 
  0F9A    CD 06CE        C      	CALL	CDEHL 
  0F9D    D0             C      	RNC 
  0F9E    2A 1E0E        C      	LHLD	BLEND 
  0FA1    2B             C      	DCX	H 
  0FA2    CD 06CE        C      	CALL	CDEHL 
  0FA5    D8             C      	RC 
  0FA6    2A 1E0C        C      	LHLD	BLBEG 
  0FA9    2B             C      	DCX	H 
  0FAA    CD 06CE        C      	CALL	CDEHL 
  0FAD    DA 0FB9        C      	JC	INBLK 
  0FB0    D5             C      	PUSH	D 
  0FB1    CD 112F        C      	CALL	BLKSIZ 
  0FB4    23             C      	INX	H 
  0FB5    D1             C      	POP	D 
  0FB6    19             C      	DAD	D 
  0FB7    EB             C      	XCHG 
  0FB8    C9             C      	RET 
  0FB9    D5             C      INBLK:	PUSH	D 
  0FBA    CD 113A        C      	CALL	GLBSIZ 
  0FBD    EB             C      	XCHG 
  0FBE    E1             C      	POP	H 
  0FBF    CD 12DA        C      	CALL	CSUB 
  0FC2    EB             C      	XCHG 
  0FC3    C9             C      	RET 
                         C       
  0FC4    2A 1E0C        C      JBLCD:	LHLD	BLBEG 
  0FC7    2B             C      	DCX	H 
  0FC8    CD 06CE        C      	CALL	CDEHL 
  0FCB    D0             C      	RNC 
  0FCC    2A 117C        C      	LHLD	DSTADR 
  0FCF    2B             C      	DCX	H 
  0FD0    CD 06CE        C      	CALL	CDEHL 
  0FD3    D8             C      	RC 
  0FD4    2A 1E0E        C      	LHLD	BLEND 
  0FD7    2B             C      	DCX	H 
  0FD8    CD 06CE        C      	CALL	CDEHL 
  0FDB    D2 0FEA        C      	JNC	INBLD 
  0FDE    D5             C      	PUSH	D 
  0FDF    CD 112F        C      	CALL	BLKSIZ 
  0FE2    23             C      	INX	H 
  0FE3    D1             C      	POP	D 
  0FE4    EB             C      	XCHG 
  0FE5    CD 12DA        C      	CALL	CSUB 
  0FE8    EB             C      	XCHG 
	MACRO-80 3.44	09-Dec-81	PAGE	1-44


  0FE9    C9             C      	RET 
                         C       
  0FEA    2A 117C        C      INBLD:	LHLD	DSTADR 
  0FED    19             C      	DAD	D 
  0FEE    EB             C      	XCHG 
  0FEF    2A 1E0E        C      	LHLD	BLEND 
  0FF2    EB             C      	XCHG 
  0FF3    CD 12DA        C      	CALL	CSUB 
  0FF6    EB             C      	XCHG 
  0FF7    C9             C      	RET 
                         C       
  0FF8                   C      COPYBL:: 
  0FF8    CD 1004        C      	CALL	CBL 
  0FFB    CD 01DF        C      	CALL	COMPST 
  0FFE    2A 1E0C        C      	LHLD	BLBEG 
  1001    C3 117E        C      	JMP	DISADR 
  1004    CD 1039        C      CBL:	CALL	CHBL 
  1007    D2 1014        C      	JNC	CBL1 
  100A    2A 1E0E        C      	LHLD	BLEND 
  100D    2B             C      	DCX	H 
  100E    CD 06CE        C      	CALL	CDEHL 
  1011    D2 0133        C      	JNC	OUT1 
  1014    CD 112F        C      CBL1:	CALL	BLKSIZ 
  1017    EB             C      	XCHG 
  1018    2A 117C        C      	LHLD	DSTADR 
  101B    44             C      	MOV	B,H 
  101C    4D             C      	MOV	C,L 
  101D    E5             C      	PUSH	H 
  101E    19             C      	DAD	D 
  101F    E5             C      	PUSH	H 
  1020    23             C      	INX	H 
  1021    EB             C      	XCHG 
  1022    CD 05F1        C      	CALL	UPSHT 
  1025    2A 1E0C        C      	LHLD	BLBEG 
  1028    44             C      	MOV	B,H 
  1029    4D             C      	MOV	C,L 
  102A    E1             C      	POP	H 
  102B    23             C      	INX	H 
  102C    22 1E0E        C      	SHLD	BLEND 
  102F    2B             C      	DCX	H 
  1030    EB             C      	XCHG 
  1031    E1             C      	POP	H 
  1032    22 1E0C        C      	SHLD	BLBEG 
  1035    EB             C      	XCHG 
  1036    C3 060D        C      	JMP	D1 
                         C       
  1039    CD 0F57        C      CHBL:	CALL	MARK 
  103C    22 117C        C      	SHLD	DSTADR 
  103F    EB             C      	XCHG 
  1040    2A 1E0C        C      	LHLD	BLBEG 
  1043    2B             C      	DCX	H 
  1044    C3 06CE        C      	JMP	CDEHL 
                         C       
  1047    CD 1039        C      JMPBL::	CALL	CHBL 
  104A    D2 1059        C      	JNC	JBLUP 
  104D    2A 1E0E        C      	LHLD	BLEND 
	MACRO-80 3.44	09-Dec-81	PAGE	1-45


  1050    CD 06CE        C      	CALL	CDEHL 
  1053    DA 107F        C      	JC	JBLDN 
  1056    C3 0133        C      	JMP	OUT1 
  1059    2A 1E2E        C      JBLUP:	LHLD	SCRAD0 
  105C    EB             C      	XCHG 
  105D    CD 0F96        C      	CALL	JBLCU 
  1060    EB             C      	XCHG 
  1061    22 1E2E        C      	SHLD	SCRAD0 
  1064    CD 112F        C      	CALL	BLKSIZ 
  1067    EB             C      	XCHG 
  1068    2A 117C        C      	LHLD	DSTADR 
  106B    E5             C      	PUSH	H 
  106C    D5             C      	PUSH	D 
  106D    CD 10BC        C      	CALL	JBLU 
  1070    D1             C      JBLEX:	POP	D 
  1071    E1             C      	POP	H 
  1072    22 1E0C        C      	SHLD	BLBEG 
  1075    E5             C      	PUSH	H 
  1076    19             C      	DAD	D 
  1077    23             C      	INX	H 
  1078    22 1E0E        C      	SHLD	BLEND 
  107B    E1             C      	POP	H 
  107C    C3 117E        C      	JMP	DISADR 
                         C       
  107F    2A 1E2E        C      JBLDN:	LHLD	SCRAD0 
  1082    EB             C      	XCHG 
  1083    CD 0FC4        C      	CALL	JBLCD 
  1086    EB             C      	XCHG 
  1087    22 1E2E        C      	SHLD	SCRAD0 
  108A    CD 112F        C      	CALL	BLKSIZ 
  108D    EB             C      	XCHG 
  108E    2A 117C        C      	LHLD	DSTADR 
  1091    E5             C      	PUSH	H 
  1092    D5             C      	PUSH	D 
  1093    CD 10F0        C      	CALL	JBLD 
  1096    D1             C      	POP	D 
  1097    E1             C      	POP	H 
  1098    22 1E0E        C      	SHLD	BLEND 
  109B    2B             C      	DCX	H 
  109C    CD 12DA        C      	CALL	CSUB 
  109F    22 1E0C        C      	SHLD	BLBEG 
  10A2    C3 117E        C      	JMP	DISADR 
                         C       
  10A5    E5             C      SETST0:	PUSH	H 
  10A6    3A 1E39        C      	LDA	CURY0 
  10A9    2A 1E2E        C      	LHLD	SCRAD0 
  10AC    47             C      	MOV	B,A 
  10AD    05             C      SST00:	DCR	B 
  10AE    CA 10B7        C      	JZ	SST01 
  10B1    CD 0489        C      	CALL	NEXTST 
  10B4    C2 10AD        C      	JNZ	SST00 
  10B7    22 1E30        C      SST01:	SHLD	STRAD0 
  10BA    E1             C      	POP	H 
  10BB    C9             C      	RET 
                         C       
                         C       
	MACRO-80 3.44	09-Dec-81	PAGE	1-46


  10BC    CD 112F        C      JBLU:	CALL	BLKSIZ 
  10BF    23             C      	INX	H 
  10C0    E5             C      	PUSH	H 
  10C1    CD 113A        C      	CALL	GLBSIZ 
  10C4    D1             C      	POP	D 
  10C5    CD 137A        C      	CALL	?DVNHD 
  10C8    2A 117C        C      	LHLD	DSTADR 
  10CB    7A             C      	MOV	A,D 
  10CC    B3             C      	ORA	E 
  10CD    F5             C      	PUSH	PSW	; ? End of relocation 
  10CE    19             C      	DAD	D 
  10CF    44             C      	MOV	B,H 
  10D0    4D             C      	MOV	C,L 
  10D1    0B             C      	DCX	B 
  10D2    2A 1E0C        C      	LHLD	BLBEG 
  10D5    EB             C      	XCHG 
  10D6    1B             C       	DCX	D 
  10D7    2A 1E0E        C      	LHLD	BLEND 
  10DA    2B             C      	DCX	H 
  10DB    CD 1144        C      	CALL	GREXU	; "Great" Exchange 
  10DE    EB             C      	XCHG 
  10DF    23             C      	INX	H 
  10E0    22 1E0E        C      	SHLD	BLEND 
  10E3    2A 117C        C      	LHLD	DSTADR 
  10E6    22 1E0C        C       	SHLD	BLBEG 
  10E9    EB             C      	XCHG 
  10EA    23             C      	INX	H 
  10EB    22 117C        C      	SHLD	DSTADR 
  10EE    F1             C      	POP	PSW	; Z - the end 
  10EF    C8             C      	RZ 
  10F0    CD 112F        C      JBLD:	CALL	BLKSIZ 
  10F3    23             C      	INX	H 
  10F4    E5             C      	PUSH	H 
  10F5    2A 1E0E        C      	LHLD	BLEND 
  10F8    2B             C      	DCX	H 
  10F9    EB             C      	XCHG 
  10FA    2A 117C        C      	LHLD	DSTADR 
  10FD    CD 12DA        C      	CALL	CSUB 
  1100    2B             C      	DCX	H 
  1101    D1             C      	POP	D 
  1102    CD 137A        C      	CALL	?DVNHD 
  1105    2A 117C        C      	LHLD	DSTADR 
  1108    7A             C      	MOV	A,D 
  1109    B3             C      	ORA	E 
  110A    F5             C      	PUSH	PSW	; ? End of relocation 
  110B    CD 12DA        C      	CALL	CSUB 
  110E    44             C      	MOV	B,H 
  110F    4D             C      	MOV	C,L 
  1110    2A 1E0E        C      	LHLD	BLEND 
  1113    2B             C      	DCX	H 
  1114    EB             C      	XCHG 
  1115    13             C       	INX	D 
  1116    2A 1E0C        C      	LHLD	BLBEG 
  1119    CD 1160        C      	CALL	GREXD	; "Great" Exchange 
  111C    EB             C      	XCHG 
  111D    22 1E0C        C      	SHLD	BLBEG 
	MACRO-80 3.44	09-Dec-81	PAGE	1-47


  1120    2A 117C        C      	LHLD	DSTADR 
  1123    22 1E0E        C       	SHLD	BLEND 
  1126    EB             C      	XCHG 
  1127    22 117C        C      	SHLD	DSTADR 
  112A    F1             C      	POP	PSW	; Z - the end 
  112B    C2 10BC        C      	JNZ	JBLU 
  112E    C9             C      	RET 
                         C       
  112F    2A 1E0C        C      BLKSIZ:	LHLD	BLBEG 
  1132    EB             C      	XCHG 
  1133    2A 1E0E        C      	LHLD	BLEND 
  1136    2B             C      	DCX	H 
  1137    C3 12DA        C      	JMP	CSUB 
                         C       
  113A    2A 117C        C      GLBSIZ:	LHLD	DSTADR 
  113D    EB             C      	XCHG 
  113E    2A 1E0C        C      	LHLD	BLBEG 
  1141    C3 12DA        C      	JMP	CSUB 
                         C       
  1144    7B             C      GREXU:	MOV	A,E 
  1145    B9             C      	CMP	C 
  1146    C2 114C        C      	JNZ	GREXU0 
  1149    7A             C      	MOV	A,D 
  114A    B8             C      	CMP	B 
  114B    C8             C      	RZ 
  114C    C5             C      GREXU0:	PUSH	B 
  114D    4E             C      GREXU1:	MOV	C,M 
  114E    1A             C      	LDAX	D 
  114F    77             C      	MOV	M,A 
  1150    79             C      	MOV	A,C 
  1151    12             C      	STAX	D 
  1152    2B             C      	DCX	H 
  1153    1B             C      	DCX	D 
  1154    7A             C      	MOV	A,D 
  1155    B8             C      	CMP	B 
  1156    C2 114D        C      	JNZ	GREXU1 
  1159    C1             C      	POP	B 
  115A    7B             C      	MOV	A,E 
  115B    B9             C      	CMP	C 
  115C    C2 114C        C              JNZ	GREXU0 
  115F    C9             C      	RET 
                         C       
                         C       
  1160    7B             C      GREXD:	MOV	A,E 
  1161    B9             C      	CMP	C 
  1162    C2 1168        C      	JNZ	GREXD0 
  1165    7A             C      	MOV	A,D 
  1166    B8             C      	CMP	B 
  1167    C8             C      	RZ 
  1168    C5             C      GREXD0:	PUSH	B 
  1169    4E             C      GREXD1:	MOV	C,M 
  116A    1A             C      	LDAX	D 
  116B    77             C      	MOV	M,A 
  116C    79             C      	MOV	A,C 
  116D    12             C      	STAX	D 
  116E    23             C      	INX	H 
	MACRO-80 3.44	09-Dec-81	PAGE	1-48


  116F    13             C      	INX	D 
  1170    7A             C      	MOV	A,D 
  1171    B8             C      	CMP	B 
  1172    C2 1169        C      	JNZ	GREXD1 
  1175    C1             C      	POP	B 
  1176    7B             C      	MOV	A,E 
  1177    B9             C      	CMP	C 
  1178    C2 1168        C      	JNZ	GREXD0 
  117B    C9             C      	RET 
                         C       
  117C                   C      DSTADR:	DS	2 
                         C      ;------------------------------------------ 
                         C       
  117E    EB             C      DISADR:	XCHG 
  117F    2A 1E20        C      	LHLD	SCRADR 
  1182    CD 11C2        C      	CALL	DA2 
  1185    22 1E20        C      	SHLD	SCRADR 
  1188    EB             C      	XCHG 
  1189    CD 06CE        C      	CALL	CDEHL 
  118C    EB             C      	XCHG 
  118D    DA 11CF        C      	JC	DISAD1 
  1190    2A 1E06        C      	LHLD	SCREND 
  1193    CD 11C2        C      	CALL	DA2 
  1196    22 1E06        C      	SHLD	SCREND 
  1199    EB             C      	XCHG 
  119A    CD 06CE        C      	CALL	CDEHL 
  119D    EB             C      	XCHG 
  119E    D2 11CF        C      	JNC	DISAD1 
  11A1    CD 11C0        C      DAD1:	CALL	DA1 
  11A4    22 1E22        C      	SHLD	STRADR 
  11A7    2A 1E20        C      	LHLD	SCRADR 
  11AA    06 00          C      	MVI	B,0 
  11AC    04             C      DAD0:	INR	B 
  11AD    78             C      	MOV	A,B 
  11AE    32 1E2B        C      	STA	CURY 
  11B1    CD 0489        C      	CALL	NEXTST 
  11B4    CD 06CE        C      	CALL	CDEHL 
  11B7    CA 11AC        C      	JZ	DAD0 
  11BA    D2 11E9        C      	JNC	DSAD0 
  11BD    C3 11AC        C      	JMP	DAD0 
                         C       
  11C0    62             C      DA1:	MOV	H,D 
  11C1    6B             C      	MOV	L,E 
  11C2    2B             C      DA2:	DCX	H 
  11C3    7E             C      	MOV	A,M 
  11C4    FE 0D          C      	CPI	0DH 
  11C6    C2 11CB        C      	JNZ	DI3 
  11C9    23             C      	INX	H 
  11CA    C9             C      	RET 
  11CB    23             C      DI3:	INX	H 
  11CC    C3 04F8        C      	JMP	PREVST 
                         C       
  11CF    CD 11C0        C      DISAD1:	CALL	DA1 
  11D2    22 1E20        C      	SHLD	SCRADR 
  11D5    3A 1E2B        C      	LDA	CURY 
  11D8    4F             C      	MOV	C,A 
	MACRO-80 3.44	09-Dec-81	PAGE	1-49


  11D9    0D             C      DS6:	DCR	C 
  11DA    CA 11A1        C      	JZ	DAD1 
  11DD    CD 04F8        C      	CALL	PREVST 
  11E0    CA 11A1        C      	JZ	DAD1 
  11E3    22 1E20        C      	SHLD	SCRADR 
  11E6    C3 11D9        C      	JMP	DS6 
                         C       
  11E9    2A 1E22        C      DSAD0:	LHLD	STRADR 
  11EC    22 1E3D        C      	SHLD	TABSRH 
  11EF    06 01          C      DS5:	MVI	B,1 
  11F1    7A             C      DS0:	MOV	A,D 
  11F2    BC             C      	CMP	H 
  11F3    C2 11FB        C      	JNZ	DS1 
  11F6    7B             C      	MOV	A,E 
  11F7    BD             C      	CMP	L 
  11F8    CA 1200        C      	JZ	DISAD0 
  11FB    23             C      DS1:	INX	H 
  11FC    04             C      	INR	B 
  11FD    C2 11F1        C      	JNZ	DS0 
  1200    78             C      DISAD0:	MOV	A,B 
  1201    32 1E2A        C      	STA	CURX 
  1204    CD 01FA        C      	CALL	COMCUR 
  1207    C3 0312        C      	JMP	CURCM 
                         C       
  120A    7B             C      BPR:	MOV	A,E 
  120B    CD 1212        C      	CALL	BPR1 
  120E    7A             C      	MOV	A,D 
  120F    C3 1212        C      	JMP	BPR1 
  1212    F5             C      BPR1:	PUSH	PSW 
  1213    CD 121B        C      	call	BPR01 
  1216    F1             C      	POP	PSW 
  1217    0F             C      	RRC 
  1218    0F             C      	RRC 
  1219    0F             C      	RRC 
  121A    0F             C      	RRC 
  121B    E6 0F          C      BPR01:	ANI	0FH 
  121D    C6 30          C      	ADI	48 
  121F    FE 3A          C      	CPI	58 
  1221    DA 1226        C      	JC	$+5 
  1224    C6 07          C      	ADI	7 
                         C      	SetScrAddr 
                         C      	WriteNextSym 
  1226    77             C+     		mov	m,a 
  1227    23             C+     		inx	h 
  1228    2B             C      	DCX	H 
  1229    2B             C      	DCX	H 
  122A    C9             C      	RET 
                         C       
  122B                   C      GETINFADR: 
  122B    C5             C      	PUSH	B 
  122C    2A 0003        C      	LHLD	VRAM_ADR 
  122F    01 0750        C      	LXI	B,INFSTR_OFFS 
  1232    09             C      	DAD	B 
  1233    C1             C      	POP	B 
  1234    C9             C      	RET 
                         C       
	MACRO-80 3.44	09-Dec-81	PAGE	1-50


  1235    E1             C      INFPR:	POP	H 
  1236    5E             C      	MOV	E,M 
  1237    23             C      	INX	H 
  1238    56             C      	MOV	D,M 
  1239    23             C      	INX	H 
  123A    E5             C       	PUSH	H 
  123B    CD 122B        C      	CALL	GETINFADR 
  123E    19             C      	DAD	D 
  123F    EB             C      	XCHG 
  1240    E1             C      	POP	H 
  1241    C3 1249        C      	JMP	print0 
                         C       
  1244    E1             C      PRINT:	POP	H 
  1245    5E             C      	MOV	E,M 
  1246    23             C      	INX	H 
  1247    56             C      	MOV	D,M 
  1248    23             C      	INX	H 
                         C       
  1249    EB             C      PRINT0:	xchg 
                         C      	SetScrAddr 
  124A    1A             C      @prnt:	ldax	d 
  124B    B7             C      	ORA	A 
  124C    FA 1255        C      	JM	PRINT1 
                         C       
                         C      	WriteNextSym 
  124F    77             C+     		mov	m,a 
  1250    23             C+     		inx	h 
  1251    13             C      	inx	d 
  1252    C3 124A        C      	JMP	@prnt 
                         C       
  1255    E6 7F          C      PRINT1:	ANI	7FH 
                         C      	WriteNextSym 
  1257    77             C+     		mov	m,a 
  1258    23             C+     		inx	h 
  1259    EB             C      	xchg 
  125A    23             C      	inx	h 
  125B    E9             C      	pchl 
                         C       
  125C    CD 0BA6        C      CALC::	CALL	CLRSTR 
  125F    CD 1235        C      	CALL	INFPR 
  1262    001F           C      	DW	31 
  1264    3D 20 30 30    C      	DC	'= 0000H  0000DEC' 
  1268    30 30 48 20    C      
  126C    20 30 30 30    C      
  1270    30 44 45 C3    C      
  1274    CD 1235        C      CALC0:	CALL	INFPR 
  1277    000A           C      	DW	10 
  1279    45 58 50 52    C      	DC	'EXPR=' 
  127D    BD             C      
  127E    21 1E7D        C      	LXI	H,FILNAM 
  1281    01 1E18        C      	LXI	B,NAMMES 
  1284    E5             C      	PUSH	H 
  1285    CD 0B20        C      	CALL	INPSTR 
  1288    E1             C      	POP	H 
  1289    CD 12AE        C      	CALL	COMPUTE 
  128C    E5             C      	PUSH	H 
	MACRO-80 3.44	09-Dec-81	PAGE	1-51


  128D    EB             C      	XCHG 
  128E    CD 122B        C      	CALL	GETINFADR 
  1291    C5             C      	PUSH	B 
  1292    01 0024        C      	LXI	B,36 
  1295    09             C      	DAD	B 
  1296    C1             C      	POP	B 
  1297    CD 120A        C      	CALL	BPR 
  129A    E1             C      	POP	H 
  129B    CD 131C        C      	CALL	?FBBCD 
  129E    EB             C      	XCHG 
  129F    CD 122B        C      	CALL	GETINFADR 
  12A2    C5             C      	PUSH	B 
  12A3    01 002B        C      	LXI	B,43 
  12A6    09             C      	DAD	B 
  12A7    C1             C      	POP	B 
  12A8    CD 120A        C      	CALL	BPR 
  12AB    C3 1274        C      	JMP	CALC0 
                         C       
  12AE    CD 12E0        C      COMPUTE:CALL	GETVL1 
  12B1    7E             C      	MOV	A,M 
  12B2    23             C      	INX	H 
  12B3    42             C      	MOV	B,D 
  12B4    4B             C      	MOV	C,E 
  12B5    F5             C      	PUSH	PSW 
  12B6    C5             C      	PUSH	B 
  12B7    CD 12E0        C      	CALL	GETVL1 
  12BA    C1             C      	POP	B 
  12BB    60             C      	MOV	H,B 
  12BC    69             C      	MOV	L,C 
  12BD    F1             C      	POP	PSW 
                         C       
  12BE    FE 2B          C      	CPI	'+' 
  12C0    CA 12D5        C      	JZ	CADD 
  12C3    FE 2D          C      	CPI	'-' 
  12C5    CA 12DA        C      	JZ	CSUB 
  12C8    FE 2A          C      	CPI	'*' 
  12CA    CA 1366        C      	JZ	?MULHD 
  12CD    FE 2F          C      	CPI	'/' 
  12CF    CA 137A        C      	JZ	?DVNHD 
  12D2    C3 12D7        C      	JMP	ERR 
                         C       
  12D5    19             C      CADD:	DAD	D 
  12D6    C9             C      	RET 
                         C       
  12D7    C3 0B89        C      ERR:	JMP	IN4 
                         C       
  12DA    EB             C      CSUB:	XCHG 
  12DB    CD 13A3        C      	CALL	?NEGHL 
  12DE    19             C      	DAD	D 
  12DF    C9             C      	RET 
                         C       
                         C       
                         C       
  12E0    11 0000        C      GETVL1:	LXI	D,0 
  12E3    7E             C      	MOV	A,M 
  12E4    CD 130D        C      	CALL	GET4 
	MACRO-80 3.44	09-Dec-81	PAGE	1-52


  12E7    B7             C      	ORA	A 
  12E8    F8             C      	RM 
  12E9    7E             C      GET2:	MOV	A,M 
  12EA    CD 130D        C      	CALL	GET4 
  12ED    B7             C      	ORA	A 
  12EE    FA 12FD        C      	JM	GET1 
  12F1    EB             C      	XCHG 
  12F2    29             C      	DAD	H 
  12F3    29             C      	DAD	H 
  12F4    29             C      	DAD	H 
  12F5    29             C      	DAD	H 
  12F6    EB             C      	XCHG 
  12F7    B3             C      	ORA	E 
  12F8    5F             C      	MOV	E,A 
  12F9    23             C      	INX	H 
  12FA    C3 12E9        C      	JMP	GET2 
  12FD    7E             C      GET1:	MOV	A,M 
  12FE    FE 48          C      	CPI	'H' 
  1300    CA 130B        C      	JZ	GET3 
  1303    E5             C      	PUSH	H 
  1304    EB             C      	XCHG 
  1305    CD 1330        C      	CALL	?FBCDB 
  1308    EB             C      	XCHG 
  1309    E1             C      	POP	H 
  130A    C9             C      	RET 
                         C       
  130B    23             C      GET3:	INX	H 
  130C    C9             C      	RET 
                         C       
  130D    D6 30          C      GET4:	SUI	'0' 
  130F    D8             C      	RC 
  1310    FE 0A          C      	CPI	0AH 
  1312    D8             C      	RC 
  1313    D6 07          C      	SUI	7 
  1315    D8             C      	RC 
  1316    FE 10          C      	CPI	16 
  1318    D8             C      	RC 
  1319    3E F9          C      GET5:	MVI	A,-7 
  131B    C9             C      	RET 
                         C       
  131C    11 0000        C      ?FBBCD: LXI	D,0 
  131F    0E 10          C      	MVI	C,16 
  1321    29             C      ?FBBC0:	DAD	H 
  1322    7B             C      	MOV	A,E 
  1323    8F             C      	ADC	A 
  1324    27             C      	DAA 
  1325    5F             C      	MOV	E,A 
  1326    7A             C      	MOV	A,D 
  1327    8F             C      	ADC	A 
  1328    27             C      	DAA 
  1329    57             C      	MOV	D,A 
  132A    0D             C      	DCR	C 
  132B    C2 1321        C      	JNZ	?FBBC0 
  132E    EB             C      	XCHG 
  132F    C9             C      	RET 
  1330    11 0000        C      ?FBCDB:	LXI	D,0 
	MACRO-80 3.44	09-Dec-81	PAGE	1-53


  1333    EB             C      	XCHG 
  1334    0E 10          C      	MVI	C,16 
  1336    AF             C      ?FBCB0:	XRA	A 
  1337    7A             C      	MOV	A,D 
  1338    1F             C      	RAR 
  1339    CD 134E        C      	CALL	CORR_A 
  133C    57             C      	MOV	D,A 
  133D    7B             C      	MOV	A,E 
  133E    1F             C      	RAR 
  133F    CD 134E        C      	CALL	CORR_A 
  1342    5F             C      	MOV	E,A 
  1343    7C             C      	MOV	A,H 
  1344    1F             C      	RAR 
  1345    67             C      	MOV	H,A 
  1346    7D             C      	MOV	A,L 
  1347    1F             C      	RAR 
  1348    6F             C      	MOV	L,A 
  1349    0D             C      	DCR	C 
  134A    C2 1336        C      	JNZ	?FBCB0 
  134D    C9             C      	RET 
                         C       
  134E    F5             C      CORR_A:	PUSH	PSW 
  134F    47             C      	MOV	B,A 
  1350    E6 08          C      	ANI	8 
  1352    CA 1359        C      	JZ	NOCR1 
  1355    78             C      	MOV	A,B 
  1356    D6 03          C      	SUI	3 
  1358    47             C      	MOV	B,A 
  1359    78             C      NOCR1:	MOV	A,B 
  135A    E6 80          C      	ANI	80H 
  135C    CA 1363        C      	JZ	NOCR2 
  135F    78             C      	MOV	A,B 
  1360    D6 30          C      	SUI	30H 
  1362    47             C      	MOV	B,A 
  1363    F1             C      NOCR2:	POP	PSW 
  1364    78             C      	MOV	A,B 
  1365    C9             C      	RET 
                         C       
                         C       
                         C      ; 16-BIT MULTIPLY 
                         C      ; HL *= DE 
  1366    44             C      ?MULHD:	MOV	B,H 
  1367    4D             C      	MOV	C,L 
  1368    21 0000        C      	LXI	H,0 
  136B    3E 10          C      	MVI	A,16 
  136D    29             C      ?01:	DAD	H 
  136E    EB             C      	XCHG 
  136F    29             C      	DAD	H 
  1370    EB             C      	XCHG 
  1371    D2 1375        C      	JNC	?02 
  1374    09             C      	DAD	B 
  1375    3D             C      ?02:	DCR	A 
  1376    C2 136D        C      	JNZ	?01 
  1379    C9             C      	RET 
                         C       
                         C       
	MACRO-80 3.44	09-Dec-81	PAGE	1-54


                         C      ; 16 - BIT UNSIGNED DIVISION 
                         C      ; HL /= DE 
                         C      ; DE = HL % DE 
  137A    42             C      ?DVNHD:	MOV	B,D 
  137B    4B             C      	MOV	C,E 
  137C    11 0000        C      	LXI	D,0 
  137F    3E 10          C      	MVI	A,16 
  1381    F5             C      ?21:	PUSH	PSW 
  1382    29             C      	DAD	H 
  1383    7B             C      	MOV	A,E 
  1384    17             C      	RAL 
  1385    5F             C      	MOV	E,A 
  1386    7A             C      	MOV	A,D 
  1387    17             C      	RAL 
  1388    57             C      	MOV	D,A 
  1389    DA 1393        C      	JC	?22 
  138C    7B             C      	MOV	A,E 
  138D    91             C      	SUB	C 
  138E    7A             C      	MOV	A,D 
  138F    98             C      	SBB	B 
  1390    DA 139A        C      	JC	?23 
  1393    7B             C      ?22:	MOV	A,E 
  1394    91             C      	SUB	C 
  1395    5F             C      	MOV	E,A 
  1396    7A             C      	MOV	A,D 
  1397    98             C      	SBB	B 
  1398    57             C      	MOV	D,A 
  1399    2C             C      	INR	L 
  139A    F1             C      ?23:	POP	PSW 
  139B    3D             C      	DCR	A 
  139C    C2 1381        C      	JNZ	?21 
  139F    C9             C      	RET 
                         C       
  13A0    7C             C      ?ABSHL:	MOV	A,H 
  13A1    B7             C      	ORA	A 
  13A2    F0             C      	RP 
  13A3    2B             C      ?NEGHL:	DCX	H 
  13A4    7D             C      ?NOTHL:	MOV	A,L 
  13A5    2F             C      	CMA 
  13A6    6F             C      	MOV	L,A 
  13A7    7C             C      	MOV	A,H 
  13A8    2F             C      	CMA 
  13A9    67             C      	MOV	H,A 
  13AA    C9             C      	RET 
                         C       
                         C       
  13AB    CD 0147        C      EXIT::	call	CLS 
  13AE    C3 F800        C      	JMP	0F800h;rst	0 
                         C       
                         C      ;----- Display one editor string ---------- 
  13B1                   C      DISSTR::	SetScrAddr 
  13B1    06 00          C      	MVI	B,0 
  13B3    3A 1E2C        C      	LDA	DISPOS 
  13B6    4F             C      	MOV	C,A   
  13B7    CD 1408        C      	call	_SkipSyms 
  13BA    0E 40          C      	MVI	C,LogicWidth 
	MACRO-80 3.44	09-Dec-81	PAGE	1-55


  13BC    E5             C      	push	h 
  13BD                   C      _DispNxtChr: 
  13BD    1A             C      	LDAX	D 
  13BE    FE FF          C      	CPI	0FFH 
  13C0    CA 13FB        C      	JZ	_BlankEos ; Blank to end of screen 
  13C3    FE 0D          C      	CPI	13 
  13C5    CA 13FB        C      	JZ	_BlankEos 
  13C8    FE 09          C      	CPI	9 
  13CA    CA 13E5        C      	JZ	_DispTab 
                         C      ifdef	LimitedCharSet 
                         C      	ORA	A 
                         C      	JP	$+5 
                         C      	MVI	A,0D6H 
                         C      endif 
                         C      	WriteNextSym 
  13CD    77             C+     		mov	m,a 
  13CE    23             C+     		inx	h 
  13CF    13             C      	INX	D 
  13D0    04             C      	INR	B 
  13D1    0D             C      	DCR	C 
  13D2    C2 13BD        C      	JNZ	_DispNxtChr 
                         C       
  13D5    E1             C      _Eos:	POP	H 
  13D6    01 004E        C      	lxi	b,ScrWidth 
  13D9    09             C      	dad	b 
  13DA                   C      _SkipToEol: 
  13DA    1A             C      	LDAX	D 
  13DB    FE 0D          C      	CPI	13 
  13DD    C8             C      	RZ 
  13DE    FE FF          C      	cpi	0ffh 
  13E0    C8             C      	RZ 
  13E1    13             C      	INX	D 
  13E2    C3 13DA        C      	JMP	_SkipToEol 
                         C       
  13E5                   C      _DispTab: 
  13E5    CD 1428        C      	call	CalcTab 
  13E8    13             C      	INX	D 
  13E9    F5             C      _DspT:	push	psw 
  13EA    3E 20          C      	mvi	a,space 
                         C      	WriteNextSym 
  13EC    77             C+     		mov	m,a 
  13ED    23             C+     		inx	h 
  13EE    F1             C      	pop	psw 
  13EF    04             C      	INR	B 
  13F0    0D             C      	DCR	C 
  13F1    CA 13D5        C      	JZ	_Eos 
  13F4    3D             C      	DCR	A 
  13F5    C2 13E9        C      	JNZ	_DspT 
  13F8    C3 13BD        C      	JMP	_DispNxtChr 
                         C       
                         C       
  13FB                   C      _BlankEos: 
  13FB    F5             C      	push	psw 
  13FC    3E 20          C      	mvi	a,space 
                         C      	WriteNextSym 
  13FE    77             C+     		mov	m,a 
	MACRO-80 3.44	09-Dec-81	PAGE	1-56


  13FF    23             C+     		inx	h 
  1400    F1             C      	pop	psw 
  1401    0D             C      	DCR	C 
  1402    C2 13FB        C      	JNZ	_BlankEos 
  1405    C3 13D5        C      	JMP	_Eos 
                         C       
                         C      ;	* 
  1408                   C      _SkipSyms: 
  1408    04             C      	INR	B 
  1409    0D             C      	DCR	C 
  140A    C8             C      	rz 
  140B    1A             C      	LDAX	D 
  140C    FE FF          C      	CPI	0FFH 
  140E    C8             C      	rz 
  140F    FE 0D          C      	CPI	0DH 
  1411    C8             C      	rz 
  1412    FE 09          C      	CPI	9 
  1414    C2 1424        C      	jnz	_ContSkipping 
  1417    CD 1428        C      	call	CalcTab 
  141A                   C      _SkTabLp: 
  141A    3D             C      	DCR	A 
  141B    CA 1424        C      	JZ	_ContSkipping 
  141E    04             C      	INR	B 
  141F    0D             C      	DCR	C 
  1420    C8             C      	rz 
  1421    C3 141A        C      	jmp	_SkTabLp 
                         C       
  1424                   C      _ContSkipping: 
  1424    13             C      	INX	D 
  1425    C3 1408        C      	JMP	_SkipSyms 
                         C       
  1428    78             C      CalcTab:MOV	A,B 
  1429    3D             C      	DCR	A 
  142A    E6 07          C      	ANI	TabStep-1 
  142C    D6 09          C      	SUI	TabStep+1 
  142E    2F             C      	CMA 
  142F    C9             C      	ret 
                         C       
                         C      ;--------------- DISSTR ---------- 
                         C      PUBLIC BLBEG,BLEND,CDEHL,CLRSTR,CURX,DISADR,FILNAM,INFPR,INPSTR,MARK,MAXRAM 
                         C      PUBLIC NAMMES,nivgr,werhgr,OUT1,PRINT 
                         C       
                         C       
  1E00                   C      nivgr	EQU	WRK 
  1E02                   C      werhgr	EQU	WRK+2 
  1E04                   C      VDADR	EQU	WRK+4 
  1E06                   C      SCREND	EQU	WRK+6 
  1E08                   C      NUMSTR	EQU	WRK+8 
  1E0A                   C      CURSTR	EQU	WRK+10 
  1E0C                   C      BLBEG	EQU	WRK+12 
  1E0E                   C      BLEND	EQU	WRK+14 
  1E10                   C      OLDBLB	EQU	WRK+16 
  1E12                   C      OLDBLE	EQU	WRK+18 
  1E14                   C      BEGCOR	EQU	WRK+20 
  1E15                   C      ENDCOR	EQU	WRK+21 
  1E16                   C      SRMES	EQU	WRK+22 
	MACRO-80 3.44	09-Dec-81	PAGE	1-57


  1E17                   C      RPMES	EQU	WRK+23 
  1E18                   C      NAMMES	EQU	WRK+24 
  1E19                   C      OLDMES	EQU	WRK+25 
  1E1A                   C      NEWMES	EQU	WRK+26 
  1E1B                   C      MODE	EQU	WRK+27 
  1E1C                   C      RMODE	EQU	WRK+28	; 1 
                         C       
  1E20                   C      SCRADR	EQU	WRK+32 
  1E22                   C      STRADR	EQU	WRK+34 
  1E24                   C      SCRBEG	EQU	WRK+36 
  1E26                   C      INFADR	EQU	WRK+38 
  1E28                   C      YSIZE	EQU	WRK+40 
  1E29                   C      YBEG	EQU	WRK+41 
  1E2A                   C      CURX	EQU	WRK+42 
  1E2B                   C      CURY	EQU	WRK+43 
  1E2C                   C      DISPOS	EQU	WRK+44 
  1E2D                   C      ?END	EQU	WRK+45 
                         C       
  1E2E                   C      SCRAD0	EQU	WRK+46 
  1E30                   C      STRAD0	EQU	WRK+48 
  1E32                   C      SCRBG0	EQU	WRK+50 
  1E34                   C      INFAD0	EQU	WRK+52 
  1E36                   C      YSIZE0	EQU	WRK+54 
  1E37                   C      YBEG0	EQU	WRK+55 
  1E38                   C      CURX0	EQU	WRK+56 
  1E39                   C      CURY0	EQU	WRK+57 
  1E3A                   C      DISPS0	EQU	WRK+58 
  1E3B                   C      ?StringBufActive	EQU	WRK+59 
                         C       
  1E3C                   C      ?WIN1	EQU	WRK+60 
                         C      ;PRSP	EQU	WRK+59 
  1E3D                   C      TABSRH	EQU	WRK+61 
                         C      ;?END	EQU	WRK+63 
  1E42                   C      SYM	EQU	WRK+66	; 1 
  1E61                   C      STRSR	EQU	WRK+97 
  1E6F                   C      STRREP	EQU	WRK+111 
  1E7D                   C      FILNAM	EQU	WRK+125 
  1E7D                   C      STRRED	EQU	WRK+125 
  1430                   C      PRSP:	DS	2 
                         C      IFNDEF	noend 
                         C      	END 
                         C      ENDIF 
                         C       
                         C       
                         C      include	E0DISP.ASM 
                         C      ;----- Display one editor string ---------- 
                         C       
                         C      ;include E0DISP.MAC 
                         C      ;include RK86.MAC 
                         C      IFNDEF	CURSM 
                         C      extrn CURSM 
                         C      EXTRN	DISP_ADR, DMA_ADR, VRAM_ADR 
                         C      ENDIF 
                         C       
  1432                   C      SETSCR:: 
                         C      	;RET 
	MACRO-80 3.44	09-Dec-81	PAGE	1-58


                         C       
                         C      	;LXI	H,DISP+1 
  1432    2A 0009        C      	LHLD	DISP_ADR 
  1435    23             C      	INX	H 
  1436    36 00          C      	MVI	M,0 
  1438    2B             C      	DCX	H 
                         C       
                         C      IFDEF	Palmira 
                         C      	MVI	M,4DH;ScrWidth-1 
                         C      	MVI	M,5DH;(ScrHeight+5-1) 
                         C      	MVI	M,0FFH 
                         C      ELSE 
  1439    36 4D          C      	MVI	M,ScrWidth-1 
  143B    36 1D          C      	MVI	M,(ScrHeight+5-1) 
  143D    36 99          C       	MVI	M,99H 
                         C      ENDIF 
  143F    77             C      	mov	m,a 
  1440    23             C      	INX	H 
  1441    36 27          C      	MVI	M,27H 
  1443    7E             C      	MOV	A,M 
  1444    7E             C      	MOV	A,M 
  1445    E6 20          C      	ANI	20H 
  1447    CA 1444        C      	JZ	$-3 
                         C       
                         C      	;LXI	H,DMA+8 
  144A    2A 000B        C      	LHLD	DMA_ADR 
  144D    C5             C      	PUSH	B 
  144E    01 0008        C      	LXI	B,8 
  1451    09             C      	DAD	B 
  1452    C1             C      	POP	B 
  1453    36 80          C      	MVI	M,80H 
  1455    E5             C      	PUSH	H ; DMA+8 
                         C      	;MVI	L,Low(DMA+4) 
  1456    2D             C      	DCR	L 
  1457    2D             C      	DCR	L 
  1458    2D             C      	DCR	L 
  1459    2D             C      	DCR	L 
  145A    C5             C      	PUSH	B 
  145B    EB             C      	XCHG 
  145C    2A 0003        C      	LHLD	VRAM_ADR 
  145F    01 FF0E        C      	LXI	B,-ScrOffset 
  1462    09             C      	DAD	B 
  1463    EB             C      	XCHG 
  1464    73             C      	MOV	M,E 
  1465    72             C      	MOV	M,D 
  1466    D1             C      	POP	D 
  1467    23             C      	INX	H 
  1468    36 23          C      	MVI	M,Low(ScrSize-1) 
  146A    36 49          C      	MVI	M,High(ScrSize-1) or 40h 
                         C      	;MVI	L,Low(DMA+8) 
  146C    E1             C      	POP	H ; DMA+8 
  146D    36 A4          C      	MVI	M,0A4H 
  146F    C9             C      	RET 
                         C      	 
  1470                   C      SetCursor:: 
  1470    3E 80          C      	MVI	A,80H 
	MACRO-80 3.44	09-Dec-81	PAGE	1-59


                         C      	;STA	DISP+1 
  1472    EB             C      	XCHG 
  1473    2A 0009        C      	LHLD	DISP_ADR 
  1476    23             C      	INX	H 
  1477    77             C      	MOV	M,A 
  1478    2B             C      	DCX	H 
  1479    7B             C      	MOV     A,E 
  147A    E5             C      	PUSH	H 
  147B    21 148B        C      	LXI	H,LPOS 
  147E    86             C      	ADD	M 
  147F    23             C      	INX	H 
  1480    86             C      	ADD	M 
  1481    E1             C      	POP	H 
  1482    3D             C      	DCR	A 
  1483    C6 08          C      	ADI	ScrXOffset 
                         C      	;STA	DISP 
  1485    77             C      	MOV	M,A 
  1486    7A             C      	MOV	A,D 
  1487    C6 02          C      	ADI	2 
                         C      	;STA	DISP 
  1489    77             C      	MOV	M,A 
  148A    C9             C      	RET 
                         C       
  148B    00             C      LPOS:	DB	0 
                         C      ;RK_END 
  148C                   C      @RK_END:: 
  148C    0000           C      	DW	0 
                         C      IFNDEF	noend 
                         C      	END 
                         C      ENDIF 
                         C      include	E0FILEIO.ASM 
                         C      ;******************************************************** 
                         C      ;*  SC80 text screen editor       File I/O module  Tape * 
                         C      ;*                        (c) TCHV,1989-93              * 
                         C      ;******************************************************** 
                         C       
                         C      IFNDEF	nivgr 
                         C      EXTRN	nivgr,werhgr,START,CURX,BLBEG,BLEND 
                         C      EXTRN	JMPBL,OUT1, MARK,DISADR 
                         C      ENDIF 
                         C       
  148E    21 0000        C      RDFIL::	LXI	H,0 
  1491    CD F824        C      	CALL	0F824H 
  1494    EB             C      	XCHG 
  1495    22 1E02        C      	SHLD	werhgr 
  1498    C3 0015        C      	JMP	START 
                         C       
                         C       
  149B    2A 1E02        C      RDBL::	LHLD	werhgr 
  149E    23             C      	INX	H 
  149F    11 E000        C      	LXI	D,-2000H 
  14A2    19             C      	DAD	D 
  14A3    CD F824        C      	CALL	0F824H ; Read block from tape 
  14A6    EB             C      	XCHG 
  14A7    22 1E0E        C      	SHLD	BLEND 
  14AA    2B             C      	DCX	H 
	MACRO-80 3.44	09-Dec-81	PAGE	1-60


  14AB    22 1E02        C      	SHLD    werhgr 
  14AE    E1             C      	POP	H 
  14AF    22 1E2A        C      	SHLD	CURX 
  14B2    CD 1047        C      	CALL	JMPBL 
  14B5    C3 0133        C      	JMP	OUT1 
                         C       
  14B8                   C      WRFIL:: 
  14B8    CD 0F57        C      	CALL	MARK 
  14BB    E5             C      	PUSH	H 
  14BC    2A 1E00        C      	LHLD	nivgr 
  14BF    EB             C      	XCHG 
  14C0    2A 1E02        C      	LHLD	werhgr 
  14C3    EB             C      	XCHG 
  14C4    CD 14DF        C      	CALL	WRSEG 
  14C7    E1             C      	POP	H 
  14C8    C3 117E        C      	JMP	DISADR 
                         C       
  14CB    CD 0F57        C      WRBL::	CALL	MARK 
  14CE    E5             C      	PUSH	H 
  14CF    2A 1E0C        C      	LHLD	BLBEG 
  14D2    EB             C      	XCHG 
  14D3    2A 1E0E        C      	LHLD	BLEND 
  14D6    2B             C      	DCX	H 
  14D7    EB             C      	XCHG 
  14D8    CD 14DF        C      	CALL	WRSEG 
  14DB    E1             C      	POP	H 
  14DC    C3 117E        C      	JMP	DISADR 
                         C       
                         C       
  14DF                   C      WRSEG: 
  14DF    CD F82A        C      	CALL	0F82AH ; Checksum calc 
  14E2    C3 F827        C      	JMP	0F827H ; Write block to tape 
                         C      IFNDEF	noend 
                         C      	END 
                         C      ENDIF 
                         C      include	E0GETC.ASM 
                         C      ; 
                         C      ;	E0GETC.ASM -	ED SC80  get symbol module (OS dependent) 
                         C      ;			RK version (hardware dependent) 
                         C      ;			Uses external PPI_ADR 
                         C       
  0040                   C      ?Ctrl	equ	40h 
  0020                   C      ?Shift	equ	20h 
                         C       
                         C      IFNDEF	PPI_ADR 
                         C      EXTRN	PPI_ADR 
                         C      ENDIF 
                         C       
                         C      ; Return SYMBOL and SHIFT/CNTRL flags 
                         C      ; 	40h - CNTRL  &  80h - SHIFT 
                         C      ;	B - SYMBOL or MASK 
                         C      ;	C - SYMBOL 
  14E5                   C      GETCHC:: 
  14E5    CD 150E        C      	CALL	GETCHR 
  14E8    E5             C      	PUSH	H 
  14E9    F5             C      	push	psw 
	MACRO-80 3.44	09-Dec-81	PAGE	1-61


  14EA    E6 3F          C      	ANI	3FH 
  14EC    4F             C      	MOV	C,A 
  14ED    3A 1779        C      	LDA	@CTRL 
                         C      	;LDA	PPI+2 
  14F0    2A 0005        C      	LHLD	PPI_ADR 
  14F3    23             C      	INX	H 
  14F4    23             C      	INX	H 
  14F5    A6             C      	ANA	M 
  14F6    E5             C      	PUSH	H ; PPI+2 
  14F7    79             C      	MOV	A,C 
  14F8    C2 14FD        C      	JNZ	$+5 
  14FB    F6 40          C      	ORI	40H 
  14FD    4F             C      	MOV	C,A 
                         C       
  14FE    3A 177A        C      	LDA	@SHFT 
  1501    E1             C      	POP	H 
  1502    A6             C      	ANA	M 
  1503    79             C      	MOV	A,C 
  1504    C2 1509        C      	JNZ	$+5 
  1507    F6 80          C      	ORI	80H 
  1509    47             C      	mov	b,a 
  150A    F1             C      	pop	psw 
  150B    4F             C      	mov	c,a 
  150C    E1             C      	POP	H 
  150D    C9             C      	RET 
                         C       
                         C      ; Get character from concole (returns in Acc) 
  150E                   C      GETCHR:: 
  150E    E5             C      	PUSH	H 
  150F    D5             C      	PUSH	D 
  1510    C5             C      	PUSH	B 
  1511    CD 1518        C      	CALL	GTC 
                         C      	;CALL	0F803h 
  1514    C1             C      	POP	B 
  1515    D1             C      	POP	D 
  1516    E1             C      	POP	H 
  1517    C9             C      	RET 
                         C       
  1518    2A 177C        C      GTC:	LHLD	PNT 
  151B    7E             C      	MOV	A,M 
  151C    FE FF          C      	CPI	0FFH 
  151E    CA 1528        C      	JZ	GTCH0 
  1521    23             C       	INX	H 
  1522    22 177C        C      	SHLD	PNT 
  1525    C3 1575        C      	JMP	??RUS 
                         C       
  1528    06 32          C      GTCH0:	MVI	B,50 
  152A    C5             C      RP3:	PUSH	B 
  152B    CD 1592        C      	CALL	GTVECT 
  152E    C1             C      	POP	B 
  152F    3A 1788        C      	LDA	NREP 
  1532    FE 01          C      	CPI	1 
  1534    C2 154C        C      	JNZ	RP1 
  1537    AF             C      	XRA	A 
  1538    32 1788        C      	STA	NREP 
  153B    05             C      	DCR	B 
	MACRO-80 3.44	09-Dec-81	PAGE	1-62


  153C    C2 152A        C      	JNZ	RP3 
  153F    3C             C      	INR	A 
  1540    32 1788        C      	STA	NREP 
  1543    21 177E        C      	LXI	H,ET1 
  1546    22 177C        C      	SHLD	PNT 
  1549    C3 1518        C      	JMP	GTC 
  154C    3A 1788        C      RP1:	LDA	NREP 
  154F    B7             C      	ORA	A 
  1550    C2 156A        C      	JNZ	RP01 
  1553    21 177E        C      	LXI	H,ET1 
  1556    23             C      RP02:	INX	H 
  1557    7E             C      	MOV	A,M 
  1558    FE FF          C      	CPI	0FFH 
  155A    C2 1556        C      	JNZ	RP02 
  155D    22 177C        C      	SHLD	PNT 
  1560    E5             C      	PUSH	H 
  1561    CD 1586        C      	CALL	MDEL 
  1564    E1             C      	POP	H 
  1565    2B             C      	DCX	H 
  1566    7E             C      	MOV	A,M 
  1567    C3 1575        C      	JMP	??RUS 
                         C       
  156A    CD 1586        C      RP01:	CALL	MDEL 
  156D    21 177E        C      	LXI	H,ET1 
  1570    7E             C      	MOV	A,M 
  1571    23             C      	INX	H 
  1572    22 177C        C      	SHLD	PNT 
  1575    FE FE          C      ??RUS:	CPI	0FEH 
  1577    C0             C      	RNZ 
                         C      	;LDA	PPI+2 
  1578    E5             C      	PUSH	H 
  1579    2A 0005        C      	LHLD	PPI_ADR 
  157C    23             C      	INX	H 
  157D    23             C      	INX	H 
  157E    7E             C      	MOV	A,M 
  157F    EE 08          C      	XRI	8 
                         C      	;STA	PPI+2 
  1581    77             C      	MOV	M,A 
  1582    E1             C      	POP	H 
  1583    C3 1518        C      	JMP	GTC 
                         C       
  1586    FB             C      MDEL:	EI 
  1587    21 03E8        C      	LXI	H,1000 
  158A    2B             C      RP2:	DCX	H 
  158B    7C             C      	MOV	A,H 
  158C    B5             C      	ORA	L 
  158D    C2 158A        C      	JNZ	RP2 
  1590    F3             C      	DI 
  1591    C9             C       	RET 
                         C       
                         C      ; (ET1) - Pressed keys vector (in order of press) 
                         C      ; (NREP) - Repeat number 
  1592    06 05          C      GTVECT:	MVI	B,5 
  1594    C5             C      GETC0:	PUSH	B 
  1595    3A 177B        C      	LDA	@RD 
  1598    B7             C      	ORA	A 
	MACRO-80 3.44	09-Dec-81	PAGE	1-63


  1599    3E 00          C      	MVI	A,0 
  159B    32 177B        C      	STA	@RD 
  159E    C2 15A4        C      	JNZ	$+6 
  15A1    CD 1640        C      	CALL	KBDSCN 
  15A4    C1             C      	POP	B 
  15A5    21 1789        C      	LXI	H,PRESS 
  15A8    7E             C      	MOV	A,M 
  15A9    FE FF          C      	CPI	0FFH 
  15AB    C2 15B8        C      	JNZ	GTV04 
  15AE    05             C      	DCR	B 
  15AF    C2 1594        C      	JNZ	GETC0 
  15B2    32 177E        C      	STA	ET1 
  15B5    C3 1592        C      	JMP	GTVECT 
                         C       
  15B8    21 1793        C      GTV04: 	LXI	H,ET2 
  15BB    11 177E        C      	LXI	D,ET1 
  15BE    E5             C      	PUSH	H 
  15BF    D5             C      	PUSH	D 
  15C0    1A             C      GTV08:	LDAX	D 
  15C1    77             C      	MOV	M,A 
  15C2    23             C      	INX	H 
  15C3    13             C      	INX	D 
  15C4    FE FF          C      	CPI	0FFH 
  15C6    C2 15C0        C      	JNZ	GTV08 
  15C9    D1             C      	POP	D 
  15CA    E1             C      	POP	H 
                         C       
  15CB    7E             C      GTV00:	MOV	A,M 
  15CC    FE FF          C      	CPI	0FFH 
  15CE    CA 15EC        C      	JZ	GTV06 
                         C       
  15D1    01 1789        C      	LXI	B,PRESS 
  15D4    0A             C      GTV07:	LDAX	B 
  15D5    FE FF          C      	CPI	0FFH 
  15D7    CA 15E8        C      	JZ	GTV01 
  15DA    BE             C      	CMP	M 
  15DB    03             C      	INX	B 
  15DC    C2 15D4        C      	JNZ	GTV07 
  15DF    36 FD          C      	MVI	M,0FDH 
  15E1    12             C      	STAX	D 
  15E2    13             C      	INX	D 
  15E3    0B             C      	DCX	B 
  15E4    3E FD          C      	MVI	A,0FDH 
  15E6    02             C      	STAX	B 
  15E7    03             C      	INX	B 
  15E8    23             C      GTV01:	INX	H 
  15E9    C3 15CB        C      	JMP	GTV00 
                         C       
  15EC    01 1789        C      GTV06:	LXI	B,PRESS 
  15EF    0B             C      	DCX	B 
  15F0    03             C      GTV10:	INX	B 
  15F1    0A             C      	LDAX	B 
  15F2    FE FD          C      	CPI	0FDH 
  15F4    CA 15F0        C      	JZ	GTV10 
  15F7    FE FF          C      	CPI	0FFH 
  15F9    CA 1616        C      	JZ	REP 
	MACRO-80 3.44	09-Dec-81	PAGE	1-64


  15FC    0B             C      	DCX	B 
  15FD    03             C      GTV11:	INX	B 
  15FE    0A             C      	LDAX	B 
  15FF    FE FD          C      	CPI	0FDH 
  1601    CA 15FD        C      	JZ	GTV11 
  1604    FE FF          C      	CPI	0FFH 
  1606    CA 160E        C      	JZ	GTV22 
  1609    12             C      	STAX	D 
  160A    13             C      	INX	D 
  160B    C3 15FD        C      	JMP	GTV11 
  160E    AF             C      GTV22:	XRA	A 
  160F    32 1788        C      	STA	NREP 
  1612    3E FF          C      GTV21:	MVI	A,0FFH 
  1614    12             C      	STAX	D 
  1615    C9             C      	RET 
                         C       
  1616    3A 1788        C      REP:	LDA	NREP 
  1619    B7             C      	ORA	A 
  161A    CA 1633        C      	JZ	GTV31 
  161D    21 1793        C      	LXI	H,ET2 
  1620    7E             C      GTV30:	MOV	A,M 
  1621    23             C      	INX	H 
  1622    FE FF          C      	CPI	0FFH 
  1624    CA 1633        C      	JZ	GTV31 
  1627    FE FD          C      	CPI	0FDH 
  1629    CA 1620        C      	JZ	GTV30 
  162C    AF             C      	XRA	A 
  162D    32 1788        C      	STA	NREP 
  1630    C3 1612        C      	JMP	GTV21 
                         C       
  1633    3A 1788        C      GTV31:	LDA	NREP 
  1636    3C             C      	INR	A 
  1637    CA 1612        C      	JZ	GTV21 
  163A    32 1788        C      	STA	NREP 
  163D    C3 1612        C      	JMP	GTV21 
                         C       
                         C      ; (PRESS) -  Pressed keys vector (in order of discover) 
  1640    01 0040        C      KBDSCN:	LXI	B,40H 
  1643    21 1789        C      	LXI	H,PRESS 
  1646    11 807F        C      	LXI	D,807FH 
                         C       
  1649    C5             C      	PUSH	B 
                         C      	;LDA	PPI+2 
                         C      	;MOV	B,A 
  164A    E5             C      	PUSH	H 
  164B    2A 0005        C      	LHLD	PPI_ADR 
  164E    23             C      	INX	H 
  164F    23             C      	INX	H 
  1650    46             C      	MOV	B,M 
  1651    E1             C      	POP	H 
  1652    3A 1778        C      	LDA	@RUS 
  1655    A0             C      	ANA	B 
  1656    C2 165C        C      	JNZ	$+6 
  1659    36 FE          C      	MVI	M,0FEH 
  165B    23             C      	INX	H 
  165C    C1             C      	POP	B 
	MACRO-80 3.44	09-Dec-81	PAGE	1-65


                         C       
  165D    CD 166B        C      NORM0:	CALL	?PRESS 
  1660    CC 1697        C      	CZ	FOUND 
  1663    04             C      	INR	B 
  1664    0D             C      	DCR	C 
  1665    C2 165D        C      	JNZ	NORM0 
  1668    36 FF          C      	MVI	M,0FFH 
  166A    C9             C      	RET 
                         C       
  166B    CD 168F        C      ?PRESS:	CALL	GETMSK 
  166E    E5             C      	PUSH	H 
  166F    2A 0005        C      	LHLD	PPI_ADR 
  1672    73             C      	MOV	M,E 
                         C      	;STA	PPI 
                         C      	;LDA	PPI+1 
  1673    23             C      	INX	H 
  1674    7E             C      	MOV	A,M 
  1675    E1             C      	POP	H 
  1676    A2             C      	ANA	D 
  1677    C0             C      	RNZ 
                         C       
  1678    E5             C      	PUSH	H 
  1679    21 00C8        C      	LXI	H,200 
  167C                   C      ?PRES0:	;LDA	PPI+1 
  167C    E5             C      	PUSH	H 
  167D    2A 0005        C      	LHLD	PPI_ADR 
  1680    23             C      	INX	H 
  1681    7E             C      	MOV	A,M 
  1682    E1             C      	POP	H 
  1683    A2             C      	ANA	D 
  1684    C2 168D        C      	JNZ	?PRES1 
  1687    2B             C      	DCX	H 
  1688    7C             C      	MOV	A,H 
  1689    B5             C      	ORA	L 
  168A    C2 167C        C      	JNZ	?PRES0 
  168D    E1             C      ?PRES1:	POP	H 
  168E    C9             C      	RET 
                         C       
                         C       
  168F    7A             C      GETMSK:	MOV	A,D 
  1690    07             C      	RLC 
  1691    57             C      	MOV	D,A 
  1692    D0             C      	RNC 
  1693    7B             C      	MOV	A,E 
  1694    07             C      	RLC 
  1695    5F             C      	MOV	E,A 
  1696    C9             C      	RET 
                         C       
  1697    E5             C      FOUND:	PUSH	H 
  1698    D5             C      	PUSH	D 
  1699    C5             C      	PUSH	B 
  169A    58             C      	MOV	E,B 
  169B    16 00          C      	MVI	D,0 
  169D    21 1738        C      	LXI	H,KEYBRD 
  16A0    19             C      	DAD	D 
  16A1    7E             C      	MOV	A,M 
	MACRO-80 3.44	09-Dec-81	PAGE	1-66


  16A2    5F             C      	MOV	E,A 
                         C       
  16A3    FE 21          C      	CPI	21H 
  16A5    D4 16AF        C      	CNC	MODCHR 
  16A8    7B             C      	MOV	A,E 
  16A9    C1             C      	POP	B 
  16AA    D1             C      	POP	D 
  16AB    E1             C      	POP	H 
  16AC    77             C      	MOV	M,A 
  16AD    23             C      	INX	H 
  16AE    C9             C      	RET 
                         C       
  16AF    5F             C      MODCHR:	MOV	E,A 
  16B0    FE 40          C      	CPI	40H 
  16B2    D2 16BA        C      	JNC	MOD4 
  16B5    FE 3C          C      	CPI	3CH 
  16B7    D2 16E6        C      	JNC	MOD3 
  16BA                   C      MOD4:	;LDA	PPI+2 
  16BA    E5             C      	PUSH	H 
  16BB    2A 0005        C      	LHLD	PPI_ADR 
  16BE    23             C      	INX	H 
  16BF    23             C      	INX	H 
  16C0    46             C      	MOV	B,M 
  16C1    E1             C      	POP	H 
                         C      	;MOV	B,A 
  16C2    3A 1779        C      	LDA	@CTRL 
  16C5    A0             C      	ANA	B 
  16C6    CA 16F6        C      	JZ	SCTRL 
                         C      	;LDA	PPI+2 
  16C9    E5             C      	PUSH	H 
  16CA    2A 0005        C      	LHLD	PPI_ADR 
  16CD    23             C      	INX	H 
  16CE    23             C      	INX	H 
  16CF    7E             C      	MOV	A,M 
  16D0    E1             C      	POP	H 
  16D1    E6 08          C      	ANI	8 
  16D3    C2 16FE        C      	JNZ	SHIFT0 
                         C      	;LDA	PPI+2 
                         C      	;MOV	B,A 
  16D6    E5             C      	PUSH	H 
  16D7    2A 0005        C      	LHLD	PPI_ADR 
  16DA    23             C      	INX	H 
  16DB    23             C      	INX	H 
  16DC    46             C      	MOV	B,M 
  16DD    E1             C      	POP	H 
                         C       
  16DE    3A 177A        C      	LDA	@SHFT 
  16E1    A0             C      	ANA	B 
  16E2    CA 1715        C      	JZ	@SHIFT 
  16E5    C9             C      	RET 
                         C       
  16E6                   C      MOD3:	;LDA	PPI+2 
                         C      	;MOV	B,A 
  16E6    E5             C      	PUSH	H 
  16E7    2A 0005        C      	LHLD	PPI_ADR 
  16EA    23             C      	INX	H 
	MACRO-80 3.44	09-Dec-81	PAGE	1-67


  16EB    23             C      	INX	H 
  16EC    46             C      	MOV	B,M 
  16ED    E1             C      	POP	H 
  16EE    3A 177A        C      	LDA	@SHFT 
  16F1    A0             C      	ANA	B 
  16F2    C2 1720        C      	JNZ	SH3 
  16F5    C9             C      	RET 
                         C       
  16F6    7B             C      SCTRL:	MOV	A,E 
  16F7    FE 40          C      	CPI	40H 
  16F9    D8             C      	RC 
  16FA    D6 40          C      	SUI	40H 
  16FC    5F             C      	MOV	E,A 
  16FD    C9             C      	RET 
                         C       
  16FE                   C      SHIFT0:	;LDA	PPI+2 
                         C      	;MOV	B,A 
  16FE    E5             C      	PUSH	H 
  16FF    2A 0005        C      	LHLD	PPI_ADR 
  1702    23             C      	INX	H 
  1703    23             C      	INX	H 
  1704    46             C      	MOV	B,M 
  1705    E1             C      	POP	H 
  1706    3A 177A        C      	LDA	@SHFT 
  1709    A0             C      	ANA	B 
  170A    CA 172B        C      	JZ	SH5 
  170D    7B             C      	MOV	A,E 
  170E    FE 40          C      	CPI	40H 
  1710    D8             C      	RC 
  1711    C6 20          C      	ADI	20H 
  1713    5F             C      	MOV	E,A 
  1714    C9             C      	RET 
                         C       
  1715                   C      @SHIFT:	;LDA	PPI+2 
  1715    E5             C      	PUSH	H 
  1716    2A 0005        C      	LHLD	PPI_ADR 
  1719    23             C      	INX	H 
  171A    23             C      	INX	H 
  171B    7E             C      	MOV	A,M 
  171C    E1             C      	POP	H 
  171D    E6 08          C      	ANI	8 
  171F    C0             C      	RNZ 
  1720    7B             C      SH3:	MOV	A,E 
  1721    FE 40          C      	CPI	40H 
  1723    DA 172B        C      	JC	SH5 
  1726    C6 20          C      	ADI	20H 
  1728    C3 1731        C      	JMP	SH1 
  172B    7B             C      SH5:	MOV	A,E 
  172C    FE 40          C      	CPI	40H 
  172E    DA 1733        C      	JC	SB 
  1731    5F             C      SH1:	MOV	E,A 
  1732    C9             C      	RET 
  1733    D6 10          C      SB:	SUI	10H 
  1735    C3 1731        C      	JMP	SH1 
                         C       
                         C       
	MACRO-80 3.44	09-Dec-81	PAGE	1-68


  1738    0C 1F 1B 00    C      KEYBRD:	DB	0CH,1FH,1BH,0,1,2,3,4 
  173C    01 02 03 04    C      
  1740    09 0A 0D       C      	DB	9,0AH,0DH 
  1743    7F             C      	DB	7FH; Here was 5FH 
  1744    08 19 18 1A    C      	DB	8,19H,18H,1AH 
  1748    30 31 32 33    C      	DB	'0123456789:;<=>?' 
  174C    34 35 36 37    C      
  1750    38 39 3A 3B    C      
  1754    3C 3D 3E 3F    C      
  1758    40 41 42 43    C      	DB	'@ABCDEFGHIJKLMNO' 
  175C    44 45 46 47    C      
  1760    48 49 4A 4B    C      
  1764    4C 4D 4E 4F    C      
  1768    50 51 52 53    C      	DB	'PQRSTUVWXYZ[\]^ ' 
  176C    54 55 56 57    C      
  1770    58 59 5A 5B    C      
  1774    5C 5D 5E 20    C      
                         C       
                         C       
  1778    80             C      @RUS:	DB	80H 
  1779    40             C      @CTRL:	DB	?Ctrl 
  177A    20             C      @SHFT:	DB	?Shift 
  177B    00             C      @RD:	DB	0 
                         C       
  177C    177E           C      PNT:	DW	ET1 
  177E    FF             C      ET1:	DB	0ffh 
  177F                   C      	ds	9 
                         C      	;DSEG 
  1788                   C      NREP:	DS	1 
  1789                   C      PRESS:	DS	10 
  1793                   C      ET2:	DS	10 
                         C      IFNDEF	noend 
                         C      	END 
                         C      ENDIF 
                         C       
                         C       
                         C      include	E0CMDT.ASM 
                         C      ;******************************************************** 
                         C      ;*  SC80 text screen editor       COMMAND table module  * 
                         C      ;*                        (c) TCHV,1989-93              * 
                         C      ;******************************************************** 
                         C       
                         C       
                         C      IFNDEF INFADR 
                         C      INCLUDE E0DISP.MAC 
                         C      PUBLIC	FNDCMD 
                         C      EXTRN INFADR 
                         C      ENDIF 
                         C       
  0008                   C      @Left		equ	8h 
  0018                   C      @Right		equ	18h 
  0019                   C      @Up		equ	19h 
  001A                   C      @Down		equ	1Ah 
  001F                   C      @Str		equ	31 
  0080                   C      Shift		equ	80h 
  0040                   C      Cntrl		equ	40h 
	MACRO-80 3.44	09-Dec-81	PAGE	1-69


                         C       
                         C       
                         C      CMD	MACRO	Adr1,Key1,Adr2,Key2 
                         C      ;extrn	Adr1 
                         C      	DW	Adr1,Key1 
                         C      	ifnb	<Adr2> 
                         C      ;extrn	Adr2 
                         C      	DW	Adr2,Key2 
                         C      	endif 
                         C      	ENDM 
                         C       
                         C      	;dseg 
                         C      ; *** Editor command table *** 
                         C      ; DW CMD_ADDR 
                         C      ; DB First Command sym, should be ANDed with 40h or ORed with 40h if Ctrl assumed pressed 
                         C      ; DB Second command sym or 0 
  179D                   C      CMDTBL:: 
                         C      	CMD	LFTM,	@Left,		RHTM,	@Right 
  179D    06D4 0008      C+     	DW	LFTM,@Left 
  17A1    06DB 0018      C+     	DW	RHTM,@Right 
                         C      	CMD	UPM,	@Up,		DWNM,	@Down 
  17A5    06E2 0019      C+     	DW	UPM,@Up 
  17A9    06EB 001A      C+     	DW	DWNM,@Down 
                         C      	CMD	SCRLUP,	Shift+@Up,	SCRLDN,	Shift+@Down 
  17AD    06F4 0099      C+     	DW	SCRLUP,Shift+@Up 
  17B1    06FD 009A      C+     	DW	SCRLDN,Shift+@Down 
                         C      	CMD	REPMOD,	2 
  17B5    07A0 0002      C+     	DW	REPMOD,2 
  17B9    0000           C      	DW	0 
                         C       
                         C      	CMD	INSCTRL,0 
  17BB    0827 0000      C+     	DW	INSCTRL,0 
                         C      	CMD	LDEL,	3Fh,		RDEL,	3 
  17BF    076F 003F      C+     	DW	LDEL,3Fh 
  17C3    077A 0003      C+     	DW	RDEL,3 
                         C      	CMD	TAB,	9,		BSC,	12 
  17C7    07B4 0009      C+     	DW	TAB,9 
  17CB    07AB 000C      C+     	DW	BSC,12 
                         C      	CMD	CR,	13,		REST,	27 
  17CF    07D1 000D      C+     	DW	CR,13 
  17D3    07C2 001B      C+     	DW	REST,27 
                         C      	CMD	DELLT,	Cntrl+1,	DELRT,	Cntrl+3 
  17D7    0DEC 0041      C+     	DW	DELLT,Cntrl+1 
  17DB    0E3B 0043      C+     	DW	DELRT,Cntrl+3 
                         C      	CMD	LEND,	Cntrl+@Left,	REND,	Cntrl+@Right 
  17DF    0DBC 0048      C+     	DW	LEND,Cntrl+@Left 
  17E3    0DC2 0058      C+     	DW	REND,Cntrl+@Right 
                         C      	CMD	INSSPC,	Cntrl+2,	BRKSTR,	Cntrl+13 
  17E7    0DE3 0042      C+     	DW	INSSPC,Cntrl+2 
  17EB    0DD1 004D      C+     	DW	BRKSTR,Cntrl+13 
  17EF    0000           C      	DW	0 
                         C       
                         C      	CMD	JoinStr,'J' 
  17F1    0E67 004A      C+     	DW	JoinStr,'J' 
  17F5    0000           C      	DW	0 
                         C       
	MACRO-80 3.44	09-Dec-81	PAGE	1-70


                         C      	CMD	CALC,	@Str+'C'*256;,	ASSM	@Str+'A'*256 
  17F7    125C 431F      C+     	DW	CALC,@Str+'C'*256 
                         C      	CMD	SEARCH,	@Str+'S'*256,	REPLACE,@Str+'R'*256 
  17FB    0CF8 531F      C+     	DW	SEARCH,@Str+'S'*256 
  17FF    0C12 521F      C+     	DW	REPLACE,@Str+'R'*256 
                         C      	CMD	NEW,	@Str+'N'*256;,	VERIFY,	@Str+'V'*256 
  1803    0ACD 4E1F      C+     	DW	NEW,@Str+'N'*256 
                         C      	CMD	BEGBUF,	@Str+@Up*256,	ENDBUF,	@Str+@Down*256 
  1807    0E7F 191F      C+     	DW	BEGBUF,@Str+@Up*256 
  180B    0E97 1A1F      C+     	DW	ENDBUF,@Str+@Down*256 
                         C      	CMD	EXIT,	@Str+'E'*256 
  180F    13AB 451F      C+     	DW	EXIT,@Str+'E'*256 
                         C      	CMD	RDFIL,	@Str+('R'-Cntrl)*256 
  1813    148E 121F      C+     	DW	RDFIL,@Str+('R'-Cntrl)*256 
                         C      	CMD	WRFIL,	@Str+('W'-Cntrl)*256 
  1817    14B8 171F      C+     	DW	WRFIL,@Str+('W'-Cntrl)*256 
                         C      	CMD	PAGEUP,	Cntrl+@Up,	PAGEDN,	Cntrl+@Down 
  181B    0EB3 0059      C+     	DW	PAGEUP,Cntrl+@Up 
  181F    0EE1 005A      C+     	DW	PAGEDN,Cntrl+@Down 
                         C       
                         C      	CMD	DELLIN,	'D', 	CONT_SRREP, 	'L' ; Continue SEARCH/REPLACE 
  1823    0F03 0044      C+     	DW	DELLIN,'D' 
  1827    0BE5 004C      C+     	DW	CONT_SRREP,'L' 
                         C      	CMD	SWPWIN,	'W', WINUP,'U' 
  182B    0943 0057      C+     	DW	SWPWIN,'W' 
  182F    0972 0055      C+     	DW	WINUP,'U' 
                         C      	CMD	WINDN,	'K' 
  1833    09EE 004B      C+     	DW	WINDN,'K' 
                         C       
                         C      	;*****	Block	commands ***** 
                         C      	CMD	DISBEG,	'Q'+@Left*256,	DISEND,	'Q'+@Right*256 
  1837    0F4B 0851      C+     	DW	DISBEG,'Q'+@Left*256 
  183B    0F51 1851      C+     	DW	DISEND,'Q'+@Right*256 
                         C      	CMD	MRBEG,	'Q'+@Up*256,	MREND,	'Q'+@Down*256 
  183F    0F66 1951      C+     	DW	MRBEG,'Q'+@Up*256 
  1843    0F6D 1A51      C+     	DW	MREND,'Q'+@Down*256 
                         C      	CMD	RDBL,	'Q'+('R'-Cntrl)*256 
  1847    149B 1251      C+     	DW	RDBL,'Q'+('R'-Cntrl)*256 
  184B    0000           C      	DW	0 
                         C      	CMD	DELBL,	'Q'+('D'-Cntrl)*256 
  184D    0F74 0451      C+     	DW	DELBL,'Q'+('D'-Cntrl)*256 
                         C      	CMD	WRBL,	'Q'+('W'-Cntrl)*256 
  1851    14CB 1751      C+     	DW	WRBL,'Q'+('W'-Cntrl)*256 
                         C      	CMD	COPYBL,	'Q'+('C'-Cntrl)*256 
  1855    0FF8 0351      C+     	DW	COPYBL,'Q'+('C'-Cntrl)*256 
                         C      	CMD	JMPBL,	'Q'+('J'-Cntrl)*256 
  1859    1047 0A51      C+     	DW	JMPBL,'Q'+('J'-Cntrl)*256 
  185D    0000           C      	DW	0 
                         C       
  185F                   C      	cseg 
                         C       
                         C      ; **************  Find disk command **************** 
                         C      ; Executes command or returns if command not found 
                         C      ; c - first char of command sequence ;  HL - pointer to command table 
  185F    23             C      FNDCMD:	INX	H 
  1860    34             C      	inr	m	; Test High byte of command adress 
	MACRO-80 3.44	09-Dec-81	PAGE	1-71


  1861    35             C      	dcr	m 
  1862    23             C      	INX	H 
  1863    C8             C      	rz	; Return if command not found 
  1864    79             C      	mov	a,c 
  1865    BE             C      	CMP	M 
  1866    CA 1871        C      	JZ	FirstSym	; First symbol is ok 
  1869    23             C      	INX	H 
  186A                   C      ContCmdSearch: 
  186A    23             C      	INX	H 
  186B    C2 185F        C      	JNZ	FNDCMD 
  186E    13             C      	INX	D 
  186F    13             C      	INX	D 
  1870    C9             C      	RET 
                         C       
  1871                   C      FirstSym: 
  1871    23             C      	INX	H 
  1872    34             C      	INR	M 
  1873    35             C      	DCR	M	; is second symbol required 
  1874    CA 1895        C      	JZ	CmdFound 
                         C       
  1877    E5             C      	push	h 
  1878    4F             C      	MOV	C,A 
                         C      	;lxi	h,INFSTR+1 
  1879    CD 122B        C      	CALL	GETINFADR 
  187C    23             C      	INX	H 
                         C      	SetScrAddr 
  187D    3E 5E          C      	MVI	A,'^' 
                         C      	WriteNextSym 
  187F    77             C+     		mov	m,a 
  1880    23             C+     		inx	h 
                         C       
  1881    79             C      	mov	a,c 
  1882    E6 3F          C      	ANI	3FH 
  1884    C6 40          C      	ADI	40H 
                         C      	WriteNextSym 
  1886    77             C+     		mov	m,a 
  1887    23             C+     		inx	h 
  1888    E1             C      	POP	H 
                         C       
  1889    78             C      	MOV	A,B	; Read next symbol if needed 
  188A    B7             C      	ORA	A 
  188B    CC 150E        C      	CZ	GETCHR 
  188E    E6 DF          C      	ani	11011111b	; toupper(Acc) 
  1890    47             C      	MOV	B,A 
  1891    BE             C      	CMP	M 
  1892    C2 186A        C      	JNZ	ContCmdSearch 
                         C       
  1895                   C      CmdFound: 
  1895    D1             C      	pop	d	; Drop	return address 
  1896    2B             C      	dcx	h 
  1897    2B             C      	dcx	h 
  1898    56             C      	mov	d,m 
  1899    2B             C      	dcx	h 
  189A    5E             C      	mov	e,m 
  189B    EB             C      	XCHG 
  189C    E9             C      	PCHL 
	MACRO-80 3.44	09-Dec-81	PAGE	1-72


                         C       
                         C      	END 
	MACRO-80 3.44	09-Dec-81	PAGE	S


Macros:
@IN             @OUT            CHECK_BREAK     CMD             GETSYM          
INIT_BRK_CHECK  SETSCRADDR      WRITENEXTSYM    

Symbols:
0D4F 	..0000          0D66 	..0001          136D 	?01             
1375 	?02             1381 	?21             1393 	?22             
139A 	?23             1575 	??RUS           13A0 	?ABSHL          
0040 	?CTRL           137A 	?DVNHD          1E2D 	?END            
1321 	?FBBC0          131C 	?FBBCD          1336 	?FBCB0          
1330 	?FBCDB          1366 	?MULHD          13A3 	?NEGHL          
13A4 	?NOTHL          0889 	?OUT            167C 	?PRES0          
168D 	?PRES1          166B 	?PRESS          0020 	?SHIFT          
1E3B 	?STRINGBUFACTIVE 1E3C 	?WIN1           13FB 	_BLANKEOS       
1424 	_CONTSKIPPING   13BD 	_DISPNXTCHR     13E5 	_DISPTAB        
13E9 	_DSPT           13D5 	_EOS            1408 	_SKIPSYMS       
13DA 	_SKIPTOEOL      141A 	_SKTABLP        029D 	@10             
029D 	@101            028C 	@11             0297 	@110            
02A9 	@12             0279 	@220            027E 	@221            
029B 	@9              00A9 	@@000           0001 	@BACKSP_KEY     
0D55 	@CONT           1779 	@CTRL           001A 	@DOWN           
0003 	@EXIT_KEY       0000 	@EXTEND_KEY     0008 	@LEFT           
0D24 	@NOUPCASE       124A 	@PRNT           0B0B 	@PUT_STR        
177B 	@RD             0018 	@RIGHT          148CI 	@RK_END         
1778 	@RUS            177A 	@SHFT           1715 	@SHIFT          
0D32 	@SRHLOOP        0D32 	@SRHLP          001F 	@STR            
0019 	@UP             0D19 	@UPCASE_LP      0D92 	ABSRH           
072F 	ANDR            0E7FI 	BEGBUF          1E14 	BEGCOR          
1E0CI 	BLBEG           1E0EI 	BLEND           112F 	BLKSIZ          
120A 	BPR             121B 	BPR01           1212 	BPR1            
0DD1I 	BRKSTR          07ABI 	BSC             0A7A 	BSCR            
092B 	CAD             092F 	CAD1            12D5 	CADD            
0937 	CADR1           093B 	CADR11          125CI 	CALC            
1274 	CALC0           034D 	CALCNEXTTABPOS  1428 	CALCTAB         
0A98 	CB0             0A89 	CB00            0AB2 	CB1             
1004 	CBL             1014 	CBL1            031D 	CC0             
0336 	CC1             0343 	CC2             033E 	CC3             
06CEI 	CDEHL           1039 	CHBL            0196 	CHECKMEM        
01A4 	CHKM0           067B 	CHKMEM          0917 	CHKPNT          
0BB5 	CLR0            0B9C 	CLR1            0BA6I 	CLRSTR          
09DD 	CLRW1           0A69 	CLRWD1          0147 	CLS             
0151 	CLSLOOP         1895 	CMDFOUND        179DI 	CMDTBL          
0040 	CNTRL           01FA 	COMCUR          01F5 	COMP0           
01E5 	COMP1           020B 	COMP2           021C 	COMP3           
061E 	COMPADR         01DF 	COMPST          12AE 	COMPUTE         
186A 	CONTCMDSEARCH   0CEDI 	CONT_SRH        0BE5 	CONT_SRREP      
0FF8I 	COPYBL          0902 	COR             06AF 	CORPNT          
0901 	CORR            08D8 	CORRECT         134E 	CORR_A          
07D1I 	CR              07E0 	CR0             06C8 	CRPNT0          
06CC 	CRPNT1          06C6 	CRPNT2          12DA 	CSUB            
0312 	CURCM           035B 	CURM            0399 	CURM1           
0364I 	CURSM           00ED 	CURSOR_BLOCK    00DD 	CURSOR_LINE     
1E0A 	CURSTR          1E2AI 	CURX            1E38 	CURX0           
1E2B 	CURY            1E39 	CURY0           060F 	D0              
024B 	D01             060D 	D1              11C0 	DA1             
11C2 	DA2             11AC 	DAD0            11A1 	DAD1            
	MACRO-80 3.44	09-Dec-81	PAGE	S-1


0F83 	DBL             01D7 	DCRCUR          02AB 	DELAY0          
0F74I 	DELBL           0768 	DELCOR          001B 	DELIMSYM        
0F03I 	DELLIN          0DECI 	DELLT           0E3BI 	DELRT           
11CB 	DI3             0852 	DIS00           0877 	DIS01           
1200 	DISAD0          11CF 	DISAD1          117EI 	DISADR          
082E 	DISALL          0F4BI 	DISBEG          01B4 	DISCUR          
0F51I 	DISEND          0221 	DISPLY          1E2C 	DISPOS          
1E3A 	DISPS0          0009I 	DISP_ADR        13B1I 	DISSTR          
0F22 	DLCOR           000BI 	DMA_ADR         0608 	DNSHT           
0EE6 	DR3             0E97 	DREND           0176 	DRLIN           
11F1 	DS0             11FB 	DS1             11EF 	DS5             
11D9 	DS6             11E9 	DSAD0           0231 	DSPL0           
0239 	DSPL1           117C 	DSTADR          06EBI 	DWNM            
0B23 	EDIT_LINE       0E97I 	ENDBUF          1E15 	ENDCOR          
12D7 	ERR             177E 	ET1             1793 	ET2             
13ABI 	EXIT            0B86 	EXIT_INP_STR    1E7DI 	FILNAM          
0892 	FILSP           1871 	FIRSTSYM        185F 	FNDCMD          
1697 	FOUND           12FD 	GET1            12E9 	GET2            
130B 	GET3            130D 	GET4            1319 	GET5            
02D8 	GETC            1594 	GETC0           14E5I 	GETCHC          
150EI 	GETCHR          122B 	GETINFADR       F830 	GETMAXMEM       
168F 	GETMSK          12E0 	GETVL1          0B3C 	GET_KEY         
113A 	GLBSIZ          1160 	GREXD           1168 	GREXD0          
1169 	GREXD1          1144 	GREXU           114C 	GREXU0          
114D 	GREXU1          1518 	GTC             02E5 	GTC0            
02FB 	GTC1            0309 	GTC2            030D 	GTC3            
1528 	GTCH0           15CB 	GTV00           15E8 	GTV01           
15B8 	GTV04           15EC 	GTV06           15D4 	GTV07           
15C0 	GTV08           15F0 	GTV10           15FD 	GTV11           
1612 	GTV21           160E 	GTV22           1620 	GTV30           
1633 	GTV31           1592 	GTVECT          052E 	I00             
0545 	I01             055E 	I02             0559 	I03             
05DC 	I04             05E8 	I06             0593 	I08             
05A3 	I09             0B89 	IN4             0FEA 	INBLD           
0FB9 	INBLK           1E34 	INFAD0          1E26I 	INFADR          
0353 	INFCRM          1235I 	INFPR           0750 	INFSTR_OFFS     
015C 	INIT            0BCD 	INPSR           0B20I 	INPSTR          
0B07 	INPUT_AND_SHOW  01CF 	INRCUR          0910 	INSCOR          
0827I 	INSCTRL         0F26 	INSERT          05AB 	INSR1           
0586 	INSRED          0DE3I 	INSSPC          08B0 	INSSYM          
0B6F 	INS_SYM         0F8F 	INV_H           0FC4 	JBLCD           
0F96 	JBLCU           10F0 	JBLD            107F 	JBLDN           
1070 	JBLEX           10BC 	JBLU            1059 	JBLUP           
1047I 	JMPBL           0E67I 	JOINSTR         1640 	KBDSCN          
1738 	KEYBRD          0010 	KRAJ            0E37 	LDC0            
0E19 	LDCOR           076FI 	LDEL            0386 	LEFT            
0DBCI 	LEND            06D4I 	LFTM            0B92 	LINE            
001C 	LINESYM         0017 	LOGICHEIGHT     0040 	LOGICWIDTH      
148B 	LPOS            006D 	M00             006A 	M01             
0712 	M03             0F62 	MAR0            0F57I 	MARK            
007F 	MAXLEN          013DI 	MAXRAM          000F 	MAXSTRLEN       
1586 	MDEL            16E6 	MOD3            16BA 	MOD4            
16AF 	MODCHR          1E1B 	MODE            0376 	MOVCUR          
0B39 	MOVE_CURS       0F66I 	MRBEG           0F6DI 	MREND           
1E18I 	NAMMES          0ACDI 	NEW             0B00 	NEW1            
1E1A 	NEWMES          0489 	NEXTST          1E00I 	NIVGR           
	MACRO-80 3.44	09-Dec-81	PAGE	S-2


1359 	NOCR1           1363 	NOCR2           0001 	NOEND           
165D 	NORM0           0D78 	NOTFOUND        0B4A 	NO_EXTEND       
1788 	NREP            1E08 	NUMSTR          0496 	NXTS0           
1E10 	OLDBLB          1E12 	OLDBLE          1E19 	OLDMES          
0133I 	OUT1            0136 	OUT3            0F30 	OVRW            
0EE1I 	PAGEDN          0EB3I 	PAGEUP          177C 	PNT             
0007 	PPI2_ADR        0005I 	PPI_ADR         0817 	PRC00           
07FA 	PRCH0           082B 	PRCHR           1789 	PRESS           
0515 	PREVS0          0501 	PREVS1          0510 	PREVS2          
04F8 	PREVST          1244I 	PRINT           1249 	PRINT0          
1255 	PRINT1          1430 	PRSP            149BI 	RDBL            
0E56 	RDCOR           077AI 	RDEL            148EI 	RDFIL           
0718I 	RED             08A1 	RED2            0DC2I 	REND            
1616 	REP             0C72 	REP0            0CAC 	REP1            
0C56 	REP2            0C68 	REP3            0CBE 	REP4            
0C12I 	REPLACE         07A0I 	REPMOD          0BF5 	REPREP          
07C2I 	REST            06DBI 	RHTM            0391 	RIGHT           
0001 	RK60K           04EE 	RLD0            04B7 	RLDN            
03D3 	RLUP            1E1C 	RMODE           04CA 	ROLLDN          
03E0 	ROLLUP          0CD7 	RP0             156A 	RP01            
1556 	RP02            154C 	RP1             158A 	RP2             
152A 	RP3             1E17 	RPMES           0BEF 	RPREP0          
0C07 	RPREP1          0F3D 	SAVMOD          1733 	SB              
042B 	SCD0            0429 	SCD1            1E2E 	SCRAD0          
1E20 	SCRADR          1E24 	SCRBEG          1E32 	SCRBG0          
040E 	SCRDN           1E06 	SCREND          0019 	SCRHEIGHT       
06FDI 	SCRLDN          06F4I 	SCRLUP          00F2 	SCROFFSET       
0924 	SCRSIZE         044C 	SCRUP           004E 	SCRWIDTH        
0008 	SCRXOFFSET      0003 	SCRYOFFSET      16F6 	SCTRL           
0468 	SCU0            0466 	SCU1            0CF8I 	SEARCH          
0D11 	SEARCHSTR       0706 	SETC            1470I 	SETCURSOR       
0095 	SETINF          0519 	SETRST          1432I 	SETSCR          
10A5 	SETST0          1731 	SH1             1720 	SH3             
172B 	SH5             0080 	SHIFT           16FE 	SHIFT0          
0020 	SPACE           1E16 	SRMES           10AD 	SST00           
10B7 	SST01           0015I 	START           0030 	STKSIZE         
0EB8 	STR2            0EDE 	STR3            1E30 	STRAD0          
1E22 	STRADR          1E7D 	STRRED          1E6F 	STRREP          
1E61 	STRSR           095C 	SWPW0           0943I 	SWPWIN          
094C 	SWPWN           1E42 	SYM             07B4I 	TAB             
1E3D 	TABSRH          0008 	TABSTEP         2000 	TXTBUFF         
05F6 	U0              05F4 	U1              06E2I 	UPM             
05F1 	UPSHT           1E04 	VDADR           0003I 	VRAM_ADR        
1E02I 	WERHGR          0F37 	WIDCUR          09CB 	WIN01           
0A26 	WIND0           0A57 	WIND01          0A36 	WIND1           
09EEI 	WINDN           099A 	WINU0           09AA 	WINU1           
0972I 	WINUP           02B2 	WLEWO           0409 	WN20            
03B1 	WNIZ            02CA 	WP1             02BD 	WPRAWO          
14CBI 	WRBL            14B8I 	WRFIL           1E00 	WRK             
0130 	WRMSRT          14DF 	WRSEG           049B 	WWERH           
1E29 	YBEG            1E37 	YBEG0           0014 	YMAX            
0002 	YMIN            1E28 	YSIZE           1E36 	YSIZE0          



No Fatal error(s)



09EEI 	WINDN           099A 	WINU0           09AA 	WINU1           
0972I 	WINUP         